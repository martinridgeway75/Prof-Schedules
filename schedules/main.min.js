window.addEventListener("load",(function(){!function(){"use strict";var e={notes:"App assumes that there are either MonToFri or MonToSat schedules.\nApp assumes that courses are: 2x1 hour blocks, 2x90 minute blocks, 2 hour blocks, 3 hour blocks or 1 hour clinics.\nApp assumes all courses start on the hour.",uriTypes:{csv:"data:text/csv;charset=utf-8,%EF%BB%BF",json:"data:application/json;charset=utf-8",txt:"data:text/plain;charset=utf-8"},maxHrsPerDay:4,maxHours:12,uiTimeInputStartHr:9,uiScheduleNumOfHrsPerDay:9,courseNameNumLength:4,csvStr:{courseCat:"교과목명",courseNum:"수강 번호",courseTime:"시간",courseRm:"강의실",courseTchr:"강사명",oldNum:"수강 번호1",newNum:"수강 번호2"},alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],monToSatKr:["월","화","수","목","금","토"],monToSatEn:["M","T","W","Th","F","S"],pdfBlankHr:"7:50-8:40",pdfCourseColors:["","blue","crimson","green","purple","darkorange"],scheduleRowPixelHeight:18},t={},n={},a={},r={courseCat:e.csvStr.courseCat,courseNum:e.csvStr.courseNum,courseTime:e.csvStr.courseTime,courseRm:e.csvStr.courseRm,courseTchr:e.csvStr.courseTchr,oldNum:e.csvStr.oldNum,newNum:e.csvStr.newNum};function s(e){return document.getElementById(e)}function i(){t={catData:[],indexData:{courses:[],schedules:[],klinics:[],depts:[]},settings:{deptGrps:[],deptGrpsSetBy:"day",maxHours:e.maxHours,maxHrsPerDay:e.maxHrsPerDay,maxSeqHrs:3,overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},teachers:[],tempCparam:"",tempKlinic:{kbtn:"",isHeld:!1},lastSearchItem:""}}function o(e){return null===e||("object"!=typeof e||0===Object.keys(e).length)}function c(e){for(;e.hasChildNodes();){for(;e.lastChild.hasChildNodes();)e.lastChild.removeChild(e.lastChild.lastChild);e.removeChild(e.lastChild)}}function d(e){var t=[],n=e.length,a,r;for(a=0;a<n;a++){for(r=a+1;r<n;r++)e[a]===e[r]&&(r=++a);t.push(e[a])}return t}function l(e,t){var n=[],a=e.length,r,s;for(r=0;r<a;r++){for(s=r+1;s<a;s++)e[r][t].toLowerCase()===e[s][t].toLowerCase()&&(s=++r);n.push(e[r])}return n}function u(e,t){var n=[],a=e.length,r,s;for(r=0;r<a;r++){for(s=r+1;s<a;s++)e[r][t]===e[s][t]&&(s=++r);n.push(e[r])}return n}function p(e,t){for(var n in t)if(t[n].name===e)return n;return!1}function h(e){return{shortcode:e,description:""}}function m(){var e=[],a=[],r=t.indexData.courses.length,s,i;for(i=0;i<r;i++)s=t.indexData.courses[i],e.push(n[s].dept);for(e.sort(),e=d(e),i=0;i<e.length;i++)a.push(h(e[i]));return a}function f(t){return e.csvStr[t]}function g(e){var t=F(S(s(e).value)),n=x(e);void 0!==n&&t.length?r[n]=t:r[n]=f(n),s(e).placeholder=r[n],s(e).value=r[n]}function v(e){var n=[],a=t.settings.deptGrps.length,r,s;for(s=0;s<a;s++)-1!==(r=t.settings.deptGrps[s]).indexOf(e)&&n.push(r);return n}function y(e){var a=t.indexData.courses.length,r,s,i;for(i=0;i<a;i++)if(s=t.indexData.courses[i],n[s].name===e){r=s;break}return r}function x(e){var t;return{strHdr1:"courseCat",strHdr2:"courseRm",strHdr3:"courseTime",strHdr4:"courseNum",strHdr5:"oldNum",strHdr6:"newNum"}[e]}function w(){var n=Number(s("hrsPerSchedule").value),a=Number(s("hrsPerDay").value);n>=1&&n<=5*e.uiScheduleNumOfHrsPerDay&&(t.settings.maxHours=n),a>=1&&a<=e.uiScheduleNumOfHrsPerDay&&(t.settings.maxHrsPerDay=a)}function b(){t.settings.maxSeqHrs=2}function D(){t.settings.maxSeqHrs=3}function C(){t.settings.deptGrpsSetBy="day"}function N(){t.settings.deptGrpsSetBy="week"}function k(){t.settings.overrides.multiCats=!0}function E(){t.settings.overrides.multiCats=!1}function S(e){return e.replace(/[,=<>$/'"&\t]/g,"")}function L(e){return e.replace(/[,=<>$/'"&\t\s]/g,"")}function I(e){return e.replace(/[^\u3130-\u318F\uAC00-\uD7AF]/gim,"")}function O(e){return e.replace(/[^a-zA-Z\-\u3130-\u318F\uAC00-\uD7AF\s]/gim,"")}function P(e){return e.replace(/[\s\t]+$/,"")}function H(e){return e.replace(/[\u3130-\u318F\uAC00-\uD7AF]/g,"")}function T(e){return e.replace(/\s/g,"")}function A(e){return e.replace(/[^a-zA-Z0-9\-]/gim,"")}function R(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");return e.replace(n,"")}function F(e){return e.replace(/\s+/g," ")}function G(e){return e.replace(/[^0-9]/g,"")}function B(e){return e.replace(/\s/g,"_")}function K(e,t){var n,a="";return new RegExp(t,"g").test(e)||(a="#d62c1a"),a}function q(t){var n=new Array(e.uiScheduleNumOfHrsPerDay).fill(t);return JSON.parse(JSON.stringify(new Array(6).fill(n)))}function _(){kt(),Ft()}function J(){Bs(),i(),Ye(!1),_()}function M(e,t,r){var s=n[a[e].cRef[r]],i=n[t];return!(s.dayhr[0].identical(i.dayhr[0])||s.dayhr[1].identical(i.dayhr[1])||s.dayhr[1].identical(i.dayhr[0])||s.dayhr[0].identical(i.dayhr[1]))}function j(e,t,r){var s=n[a[e].cRef[r]],i=n[t],o=[];if("threehour"===i.duration){if(o.push(i.dayhr[0][0]),o.push(i.dayhr[0][1]+1),s.dayhr[0].identical(o)||s.dayhr[1].identical(o))return!1}else if(o.push(s.dayhr[0][0]),o.push(s.dayhr[0][1]+1),"threehour"===s.duration&&(i.dayhr[0].identical(o)||i.dayhr[1].identical(o)))return!1;return!0}function W(e,t,r){var s=n[a[e].cRef[r]],i=n[t],o=[[i.dayhr[0][0],i.dayhr[0][1]+1],[i.dayhr[1][0],i.dayhr[1][1]+1]],c=[[s.dayhr[0][0],s.dayhr[0][1]+1],[s.dayhr[1][0],s.dayhr[1][1]+1]],d;for(d=0;d<2;d++){if(o[d].identical(s.dayhr[0]))return!0===i.allowFollow[d]&&!1===s.allowFollow[0];if(o[d].identical(s.dayhr[1]))return!0===i.allowFollow[d]&&!1===s.allowFollow[1];if(c[d].identical(i.dayhr[0]))return!0===s.allowFollow[d]&&!1===i.allowFollow[0];if(c[d].identical(i.dayhr[1]))return!0===s.allowFollow[d]&&!1===i.allowFollow[1]}return!0}function $(e,t,r){var s=n[a[e].cRef[r]],i=n[t],o,c;return i.hasOwnProperty("allowFollow")?s.hasOwnProperty("allowFollow")?W(e,t,r):!((c=[[i.dayhr[0][0],i.dayhr[0][1]+1],[i.dayhr[1][0],i.dayhr[1][1]+1]])[0].identical(s.dayhr[0])||c[1].identical(s.dayhr[1])||c[1].identical(s.dayhr[0])||c[0].identical(s.dayhr[1])):!s.hasOwnProperty("allowFollow")||(o=[[s.dayhr[0][0],s.dayhr[0][1]+1],[s.dayhr[1][0],s.dayhr[1][1]+1]],!(i.dayhr[0].identical(o[0])||i.dayhr[1].identical(o[1])||i.dayhr[1].identical(o[0])||i.dayhr[0].identical(o[1])))}function V(e){return""===n[e].assgn}function z(e,t){return n[t].dayhr[0][0]!==a[e].dayOff&&n[t].dayhr[1][0]!==a[e].dayOff}function U(e){var t=0,r=a[e].cRef.length,s,i;for(i=0;i<r;i++)"CLINIC"!==(s=n[a[e].cRef[i]]).cat&&("ninety"===s.duration||"threehour"===s.duration?t+=1.5:t+=1);return 2*t}function Y(e,a){var r=Number(t.settings.maxHours),s=2,i;return!0===t.settings.overrides.maxHours||(void 0!==typeof a&&"CLINIC"===n[a].cat||("ninety"!==n[a].duration&&"threehour"!==n[a].duration||(s=3),(i=U(e))+s<=r))}function Z(e,t){return-1===a[e].cRef.indexOf(t)}function X(e){return e>Number(t.settings.maxHrsPerDay)}function Q(e,r){var s,i,o,c,d,l,u,p;if(!0===t.settings.overrides.maxHrsPerDay)return!0;if("CLINIC"===n[r].cat)return!0;for(s=[0,0,0,0,0,0],o=a[e].cRef,c=n[r].dayhr[0][0],d=n[r].dayhr[1][0],p=0;p<o.length;p++)"CLINIC"!==(i=n[o[p]]).cat&&(l=i.dayhr[0][0],u=i.dayhr[1][0],c!==l&&c!==u&&d!==l&&d!==u||(s[l]+=1,s[u]+=1,"threehour"===i.duration&&(s[l]+=1)));return s[c]+=1,s[d]+=1,"threehour"===i.duration&&(s[c]+=1),!s.some(X)}function ee(e,n,a){var r=!0,s=e.length,i,o,c;if(2===t.settings.maxSeqHrs)if(a){for(o=0;o<s;o++)for(i=e[o],c=0;c<i.length-2;c++)if(1===i[c]&&i[c]===i[c+1]&&i[c+1]===i[c+2]&&i[c+2]===i[c+3]){r=!1;break}}else for(o=0;o<s;o++)for(i=e[o],c=0;c<i.length-1;c++)if(1===i[c]&&i[c]===i[c+1]&&i[c+1]===i[c+2]){r=!1;break}if(3===t.settings.maxSeqHrs)if(n){for(o=0;o<s;o++)for(i=e[o],c=0;c<i.length-3;c++)if(1===i[c]&&i[c]===i[c+1]&&i[c+1]===i[c+2]&&i[c+2]===i[c+3]&&i[c+3]===i[c+4]){r=!1;break}}else for(o=0;o<s;o++)for(i=e[o],c=0;c<i.length-2;c++)if(1===i[c]&&i[c]===i[c+1]&&i[c+1]===i[c+2]&&i[c+2]===i[c+3]){r=!1;break}return r}function te(e,r){var s=q(0),i=!1,o=!1,c,d,l,u,p,h,m,f,g,v;if(!0===t.settings.overrides.maxSeqHrs)return!0;if("CLINIC"===n[r].cat)return!0;for(d=n[r].dayhr[0][0],l=n[r].dayhr[1][0],u=n[r].dayhr[0][1],p=n[r].dayhr[1][1],v=0;v<a[e].cRef.length;v++)"CLINIC"!==(c=n[a[e].cRef[v]]).cat&&(h=c.dayhr[0][0],m=c.dayhr[1][0],f=c.dayhr[0][1],g=c.dayhr[1][1],d!==h&&d!==m&&l!==h&&l!==m||(s[h][f]+=1,s[m][g]+=1,"threehour"===c.duration&&(s[h][f+1]+=1)));return s[d][u]+=1,s[l][p]+=1,"twohour"===c.duration&&(i=!0),"threehour"===c.duration&&(s[d][u+1]+=1,i=!0,o=!0),ee(s,i,o)}function ne(e,t){var r=n[t];return!!a[e].hasOwnProperty("isSat")||5!==r.dayhr[0][0]&&5!==r.dayhr[1][0]&&!a[e].hasOwnProperty("isSat")}function ae(e,r){var s,i,o,c,l,u,p,h,m,f,g;if(!t.settings.deptGrps.length)return!0;if(!0===t.settings.overrides.deptGrps)return!0;if("CLINIC"===n[r].cat)return!0;for(s=v(n[r].dept),i=[],c=a[e].cRef.length,f=0;f<c;f++)"CLINIC"!==(o=n[a[e].cRef[f]]).cat&&("week"===t.settings.deptGrpsSetBy&&i.push(o.dept),"day"===t.settings.deptGrpsSetBy&&(u=o.dayhr[0][0],p=o.dayhr[1][0],h=n[r].dayhr[0][0],m=n[r].dayhr[1][0],u!==h&&u!==m&&p!==h&&p!==m||i.push(o.dept)));for(i.push(n[r].dept),d(i),f=0;f<s.length;f++){for(l=0,g=0;g<i.length;g++)s[f].includes(i[g])&&l++;if(l===i.length)return!0}return!1}function re(e,t){a[e].cRef.push(t),n[t].assgn=e}function se(e,t){n[t].assgn="",a[e].cRef.splice(a[e].cRef.indexOf(t),1)}function ie(e,t){var n,r,s;if(a[e].cRef.length){if(!1!==Z(e,t)&&!1!==V(t)&&!1!==Y(e,t)&&!1!==z(e,t)&&!1!==Q(e,t)&&!1!==te(e,t)&&!1!==ne(e,t)){for(n=0,r=a[e].cRef.length,s=0;s<r&&(M(e,t,s)&&$(e,t,s)&&j(e,t,s));s++)n++;n===r&&ae(e,t)&&re(e,t)}}else V(t)&&z(e,t)&&ne(e,t)&&re(e,t)}function oe(e,t){if(!a[e].cRef.length)throw new Error("Internal error: Attempted to remove an assignment that was never made: s"+e+", c"+t);n[t].assgn===e&&-1!==a[e].cRef.indexOf(t)&&se(e,t)}function ce(e,t){var n=a[e].cRef,r,s;if(a[e].dayOff=Number(t),!n.length)return[];for(r=[],s=0;s<n.length;s++)z(e,n[s])||r.push(n[s]);for(s=0;s<r.length;s++)oe(e,r[s]);return r}function de(e,r){var s=a[e].cRef,i=!1,o,c;if(!0===t.settings.overrides.multiCats)return!0;if("CLINIC"===n[r].cat)return!0;if(!s.length)return!0;for(o=0,c=0;c<s.length;c++)if("CLINIC"!==n[s[c]].cat){if(n[s[c]].cat===n[r].cat){i=!0;break}}else o++;return o===s.length&&(i=!0),i}function le(e){var n="s1",r=t.indexData.schedules.length,s;return(r||r>0)&&(n="s"+(s=Number(t.indexData.schedules[r-1].substring(1))+1)),a[n]={},a[n].cRef=[],a[n].dayOff=6,a[n].display="","Sat"===e&&(a[n].isSat="yes"),t.indexData.schedules.push(n),Ps(!1),n}function ue(e){var n;if(a[e].cRef.length)for(n=a[e].cRef.length-1;n>=0;n--)oe(e,a[e].cRef[n]);t.indexData.schedules.splice(t.indexData.schedules.indexOf(e),1),delete a[e],Ps(!0)}function pe(e,t){var n=["Please enter an appropriate name.",'"CLINIC" is a reserved category name!',"The name: "+t+" already exists.\nPlease choose a unique name."];window.mscAlert({title:"",subtitle:n[e]})}function he(e,n){var a,r;if(!0===e){if(""===(n=F(S(n))))return void pe(0);if("clinic"===n.toLowerCase())return void pe(1);if(t.catData.length)for(r=0;r<t.catData.length;r++)if(t.catData[r][0]===n)return void pe(2,n)}a=[n,0,q(0)],t.catData.push(a),_a(t.catData.length),!0===e&&(window.mscAlert({title:"",subtitle:n+" has been added to the list of categories."}),s("definenewcat").value="",Tr()),Ja()}function me(e){var t={},n="",a=s("newhrsone").selectedIndex,r=s("newcourseroomB").value;return t.newName=s("newcoursename").value,t.newRm={},t.newRm.a=s("newcourseroom").value,t.newCat=s("newcoursecat").options[s("newcoursecat").selectedIndex].value,t.newDept=s("newcoursedept").options[s("newcoursedept").selectedIndex].value,n+=""+s("newdayone").options[s("newdayone").selectedIndex].value+s("newhrsone").options[a].value,"twohour"!==e&&"threehour"!==e&&(n+=","+s("newdaytwo").options[s("newdaytwo").selectedIndex].value+s("newhrstwo").options[s("newhrstwo").selectedIndex].value),"twohour"===e&&(n+="-"+(a+10)+":50"),"threehour"===e&&(n+="-"+(a+11)+":50"),t.newTimes=n,t.newName=G(t.newName),t.newRm.a=A(t.newRm.a),""!==(r=A(r))&&r!==t.newRm.a&&(t.newRm.b=r),t}function fe(e){var t=[],n=[[0,0],[0,0]],a=s("newhrsone").selectedIndex,r=s("newhrstwo").selectedIndex,i=s("newdayone").selectedIndex,o=s("newdaytwo").selectedIndex;return n[0][0]=i,"ninety"===e?(n[1][0]=o,a%2==1?(n[0][1]=(a-1)/2,t.push(Boolean(!1))):(n[0][1]=a/2,t.push(Boolean(!0))),r%2==1?(n[1][1]=(r-1)/2,t.push(Boolean(!1))):(n[1][1]=r/2,t.push(Boolean(!0)))):(n[0][1]=a,"twohour"===e?(n[1][0]=i,n[1][1]=a+1):"threehour"===e?(n[1][0]=i,n[1][1]=a+2):(n[1][0]=o,n[1][1]=r)),[n,t]}function ge(){return s("durationninety").checked?"ninety":s("durationtwo").checked?"twohour":s("durationthree").checked?"threehour":"onehour"}function ve(){t.newDepts=[],t.newKlinicDefs=[],t.newCourses=[],t.overwriteCourses=[],delete t.newDepts,delete t.newKlinicDefs,delete t.newCourses,delete t.overwriteCourses}function ye(){var e,a;for(jn(),e=t.newCourses.length-1;e>=0;e--)for(a=0;a<t.indexData.courses.length;a++)if(t.newCourses[e].name===n[t.indexData.courses[a]].name){t.overwriteCourses.push(t.newCourses[e]),t.newCourses.splice(e,1);break}t.overwriteCourses.length?window.mscConfirm({title:"Overwrite courses?",subtitle:'Some of the courses you are attempting to upload have names (IDs) that currently exist. Choose: "Ok" to overwrite the existing courses, or cancel this action.',onOk:function(){ba(!0)},onCancel:function(){ve()}}):ba(!1)}function xe(e){var a,r;for(V(e)||Fe(n[e].assgn,e),t.indexData.courses.splice(t.indexData.courses.indexOf(e),1),c(a=s("contain"+e)),a.parentNode.removeChild(a),r=0;r<t.catData.length;r++)if(t.catData[r][0]===n[e].cat){t.catData[r][1]-=1,t.catData[r][2][n[e].dayhr[0][0]][n[e].dayhr[0][1]]-=1,"CLINIC"!==n[e].cat&&(t.catData[r][2][n[e].dayhr[1][0]][n[e].dayhr[1][1]]-=1),"threehour"===n[e].duration&&(t.catData[r][2][n[e].dayhr[0][0]][n[e].dayhr[0][1]+1]-=1);break}delete n[e]}function we(e,a){var r=t.indexData.courses.length,s,i,o,c,d;for(c=0;c<r;c++)(o=n[t.indexData.courses[c]]).cat===a&&(o.cat=e);for(c=0;c<t.catData.length;c++)t.catData[c][0]===e?s=c:t.catData[c][0]===a&&(i=c);if(null==s)throw new Error("Internal error: Attempting to read a category that doesn't exist!");if(null==i)throw new Error("Internal error: Attempting to read a category that doesn't exist!");for(t.catData[s][1]+=t.catData[i][1],c=0;c<t.catData[s][2].length;c++)for(d=0;d<t.catData[s][2][c].length;d++)t.catData[s][2][c][d]+=t.catData[i][2][c][d];for(t.catData[i][0]="$deleted"+[i+1],Ar(),Ce(e),c=0;c<t.catData.length;c++)sr("catedt"+[c+1]);cr("catref"+(s+1))}function be(e){var t=["Please choose an appropriate name!",'"CLINIC" is a reserved category name!'];window.mscAlert({title:"",subtitle:t[e]})}function De(e){var a=Number(e)-1,r=F(S(s("catchg"+e).value)),i=t.indexData.courses.length,o,d,l,u,p,h,m;if(""!==r){if(null!=t.catData[a]&&!Number.isNaN(Number(a)))if(t.catData[a][0]!==r){for(m=0;m<t.catData.length;m++)if(t.catData[m][0]===r&&a!==m)return"clinic"===r.toLowerCase()?void be(1):void window.mscConfirm({title:"Merge!",subtitle:'This action will move courses from: "'+t.catData[a][0]+'" and place them under: "'+t.catData[m][0]+'".\nThe category "'+t.catData[a][0]+'" will be deleted.\nThis action cannot be undone. Proceed?',onOk:function(){we(t.catData[m][0],t.catData[a][0])},onCancel:function(){}});for(m=0;m<i;m++)(h=n[t.indexData.courses[m]]).cat===t.catData[a][0]&&(h.cat=""+r);t.catData[a][0]=""+r,c(s("catref"+e)),o=document.createDocumentFragment(),d=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),p=document.createTextNode(t.catData[a][0]),d.id="catedt"+e,d.className="catedt btn-xs btn-warning pull-left nodisplay",d.textContent="Edit",l.id="bldr"+e,l.className="autobuilder pull-right icon-flash nodisplay",u.id="recycle"+e,u.className="pull-right recycler icon-recycle",o.appendChild(d),o.appendChild(p),o.appendChild(l),o.appendChild(u),s("catref"+e).appendChild(o),Number(t.catData[a][1])>6&&sr("bldr"+e),s("catchg"+e).value=r,Rr(e),Ce(r)}else Rr(e)}else be(0)}function Ce(e){var a=t.indexData.courses.length,r,s;for(s=0;s<a;s++)(r=n[t.indexData.courses[s]]).cat===e&&""!==r.assgn&&ts(r.assgn)}function Ne(e){var n=Number(e)-1;window.mscConfirm({title:"Warning",subtitle:"This action will also delete all courses under the category:\n"+t.catData[n][0]+".\nThis action cannot be undone. Proceed?",onOk:function(){ke(n)},onCancel:function(){}})}function ke(e){var a=t.catData[e][0],r;if(null!=t.catData[e]&&!Number.isNaN(Number(e))){for(r=t.indexData.courses.length-1;r>=0&&t.catData[e][1]>0;r--)n[t.indexData.courses[r]].cat===a&&xe(t.indexData.courses[r]);"CLINIC"===a&&(t.indexData.klinics=[]),t.catData[e][0]="$deleted"+[e+1],Ka(e+1)}}function Ee(e){window.mscConfirm({title:"Delete course?",subtitle:"Are you sure you want to delete this course?\nThis action cannot be undone!",onOk:function(){xe(e)},onCancel:function(){}})}function Se(){var e=t.indexData.schedules.length,a;if(e)for(a=0;a<e;a++)Me("reset"+t.indexData.schedules[a]);c(s("references")),n={},t.catData=[],t.indexData.courses=[]}function Le(){window.mscConfirm({title:"Purge?",subtitle:"This action will remove all courses and categories.\nSettings, teachers, departments, groups and clinic definitions will all remain intact.\nThis action cannot be undone! Proceed?",onOk:function(){Se()},onCancel:function(){}})}function Ie(e){""!==n[e].assgn&&Fe(n[e].assgn,e)}function Oe(e){var t="s"+e[0],n;0!==e[1]&&(n="c"+e[1],-1!==a[t].cRef.indexOf(n)&&Fe(t,n))}function Pe(e){var t=e.substring(4),n=Number(e.substring(3,4));n===a[t].dayOff&&(s("off"+n+t).style.color="",a[t].dayOff=6)}function He(e){var t=Xr(e),a,r=ce(t,Number(e.substring(3,4))),s;if(r.length)for(s=r.length-1;s>=0;s--)as(t,r[s],"off"),"CLINIC"===n[r[s]].cat&&xe(r[s]);ts(t),We(t)}function Te(e,n,a){var r,s,i,o;for(es(),r="nada",o=s=t.indexData.courses.indexOf(a);o<t.indexData.courses.length;o++)if(t.indexData.courses[o]!==a&&V(t.indexData.courses[o])&&!0===(i=Ae(t.indexData.courses[o],n))&&!0===de(e,t.indexData.courses[o])){if(Fe(e,a),ie(e,t.indexData.courses[o]),Z(e,t.indexData.courses[o])){ie(e,a),as(e,a,"on");continue}return r=t.indexData.courses[o]}return r}function Ae(e,t){var a=!1,r=n[e],s;return"threehour"===r.duration&&(s=[r.dayhr[0][0],r.dayhr[0][1]+1]).identical(t)&&(a=!0),(r.dayhr[0].identical(t)||r.dayhr[1].identical(t))&&(a=!0),a}function Re(e,n){var a,r,s,i,o;for(es(),a="nada",r=t.indexData.courses.length,o=0;o<r;o++)if(V(s=t.indexData.courses[o])&&!0===(i=Ae(s,n))&&!0===de(e,s)&&(ie(e,s),!Z(e,s)))return a=s;return a}function Fe(e,t){oe(e,t),as(e,t,"off"),ts(e),We(e)}function Ge(e,t){return!!V(t)&&(!0===de(e,t)&&(ie(e,t),!Z(e,t)))}function Be(e,a){var r="s"+e,s=Ge(r,a);!0===s&&(as(r,a,"on"),ts(r),We(r)),!1===s&&"CLINIC"===n[a].cat&&xe(a),t.tempCparam=""}function Ke(e){var t="",r=[],s=a[e].cRef,i,o,c;if(!s.length)return"";for(c=0;c<s.length;c++)"CLINIC"!==(i=n[s[c]]).cat&&r.push(i.cat);if(!r.length)return"";for(r.sort(),t+=(o=d(r))[0],c=1;c<o.length;c++)t+=", "+o[c];return t}function qe(e){var t=a[e].cRef.slice(),n=s(""+e),r;for(c(n),n.parentElement.removeChild(n),ue(e),r=0;r<t.length;r++)os(t[r])}function _e(e){var t=e.substring(3);window.mscConfirm({title:"Delete schedule?",subtitle:"Are you sure you want to delete this schedule?\nThis action cannot be undone!",onOk:function(){qe(t)},onCancel:function(){}})}function Je(e){var t=le(e);qa(t,e),We(t)}function Me(e){var t=e.substring(5),r,i;if(a[t].cRef.length)for(i=a[t].cRef.length-1;i>=0;i--)"CLINIC"===n[a[t].cRef[i]].cat?xe(a[t].cRef[i]):Fe(t,a[t].cRef[i]);for(a[t].dayOff=6,i=0;i<5;i++)s(r="off"+i+t).style.color="";a[t].hasOwnProperty("isSat")&&(s(r="off5"+t).style.color=""),a[t].hasOwnProperty("tchr")&&""!==a[t].tchr&&En(t)}function je(e){var r=Number(e.substring(7))-1,i=t.catData[r][0],o,c,l;if(!0===_t(i)){for(o=[],s(c="courselist"+e.substring(7)).setAttribute("class","hide"),l=t.indexData.courses.length-1;l>=0;l--)n[t.indexData.courses[l]].cat===i&&""!==n[t.indexData.courses[l]].assgn&&(o.push(n[t.indexData.courses[l]].assgn),"CLINIC"===i?xe(t.indexData.courses[l]):Fe(n[t.indexData.courses[l]].assgn,t.indexData.courses[l]));if(o.length)for(o=d(o),l=0;l<o.length;l++)0===a[o[l]].cRef.length&&Me(c="reset"+o[l])}}function We(e){var n=s(""+e);if(!a[e].cRef.length)return n.style.borderColor="#3498db",n.style.color="#3498db",void(n.firstChild.style.fontWeight="700");U(e)<t.settings.maxHours-1?(n.style.borderColor="#3498db",n.style.color="#3498db",n.firstChild.style.fontWeight="700"):(n.style.borderColor="",n.style.color="",n.firstChild.style.fontWeight="700")}function $e(e){var t=n[e],a,r;if("CLINIC"!==t.cat){for(a=s("edrdept-"+e),r=0;r<a.options.length;r++)if(t.dept===a.options[r].value){a.selectedIndex=r;break}s("edrday1-"+e).selectedIndex=t.dayhr[0][0],s("edrday2-"+e).selectedIndex=t.dayhr[1][0],"ninety"===t.duration?(!1===t.allowFollow[0]?s("edrstart1-"+e).options.length>2*t.dayhr[0][1]+1?s("edrstart1-"+e).selectedIndex=2*t.dayhr[0][1]+1:s("edrstart1-"+e).selectedIndex=s("edrstart1-"+e).options.length-1:s("edrstart1-"+e).selectedIndex=2*t.dayhr[0][1],!1===t.allowFollow[1]?s("edrstart2-"+e).options.length>2*t.dayhr[1][1]+1?s("edrstart2-"+e).selectedIndex=2*t.dayhr[1][1]+1:s("edrstart2-"+e).selectedIndex=s("edrstart2-"+e).options.length-1:s("edrstart2-"+e).selectedIndex=2*t.dayhr[1][1]):(s("edrstart1-"+e).selectedIndex=t.dayhr[0][1],s("edrstart2-"+e).selectedIndex=t.dayhr[1][1]),us(e)}}function Ve(e){var t=n[e],a;return"twohour"!==t.duration&&"threehour"!==t.duration&&((a=[[],[]])[0].push(s("edrday1-"+e).selectedIndex),a[1].push(s("edrday2-"+e).selectedIndex),"ninety"===t.duration?(a[0].push(Math.floor(s("edrstart1-"+e).selectedIndex)/2),a[1].push(Math.floor(s("edrstart2-"+e).selectedIndex)/2)):(a[0].push(s("edrstart1-"+e).selectedIndex),a[1].push(s("edrstart2-"+e).selectedIndex)),!!a[0].identical(a[1]))}function ze(e,t){"CLINIC"!==n[t].cat&&""!==e&&(ie(e,t),Z(e,t)||(as(e,t,"on"),ts(e),We(e,t)))}function Ue(){ms(),Ze(),cs(),yt("stats-grid","g_d"),yt("klinics-grid","gk_d")}function Ye(e){var r,i,o;for(rr("parsing"),Ue(),o=0;o<t.indexData.schedules.length;o++)r=t.indexData.schedules[o],(i=a[r]).hasOwnProperty("isSat")?qa(r,"Sat"):qa(r,"MtoF");if(!0===e){for(o=0;o<t.indexData.courses.length;o++)r=t.indexData.courses[o],""!==(i=n[r]).assgn&&as(i.assgn,r,"init");for(o=0;o<t.indexData.schedules.length;o++)r=t.indexData.schedules[o],i=a[r],ts(r),6!==i.dayOff&&(s("off"+i.dayOff+r).style.color="#2c3e50"),i.hasOwnProperty("tchr")&&""!==i.tchr&&(s("tchrset"+r).textContent=i.tchr);As(),Ts()}for(o=0;o<t.indexData.schedules.length;o++)We(t.indexData.schedules[o]);Va()}function Ze(){Ja(),Ma(),Ba("onehour")}function Xe(){var e,n;if(t.settings.deptGrps.length){for(e=[],n=0;n<t.indexData.depts.length;n++)e.push(t.indexData.depts[n].shortcode);for(n=t.settings.deptGrps.length-1;n>=0;n--)o(t.settings.deptGrps[n])?t.settings.deptGrps.splice(n,1):e.identical(t.settings.deptGrps[n].sort())&&t.settings.deptGrps.splice(n,1)}t.settings.deptGrps.length?t.settings.overrides.deptGrps=!1:t.settings.overrides.deptGrps=!0,s("newgroupid").dataset.grpindex=t.settings.deptGrps.length}function Qe(){Wa(),za(),rr("displayOverrides"),rr("left"),rr("right"),Gt()}function et(e){var t,n;for(n=e.length-1;n>=0;n--)null!=(t=y(e[n][0]))&&(e[n][0]=t);for(n=0;n<e.length;n++)try{s("newName-"+e[n][0]).value=e[n][1]}catch(e){continue}}function tt(e){var a=t.indexData.courses.length,r,i,o;for(o=0;o<a;o++)if(r=t.indexData.courses[o],e===n[r].name&&""===s(i="newName-"+r).value)return!1;return!0}function nt(e,t){var n=["The new name for course: "+t+" must be a four digit number.","The course name: "+t+"\nbelongs to another existing course!\nNew course names cannot be duplicates of existing course names.","Please check that each course has a new unique name.\nSome new course names are being duplicated."];window.mscAlert({title:"",subtitle:n[e]})}function at(){var a=!1,r=[],i=t.indexData.courses.length,o,c,l,u,p;for(p=0;p<i;p++)if(o=t.indexData.courses[p],"CLINIC"!==n[o].cat)if(""===(c=s("newName-"+o).value))a=!0;else{if(""!==c&&(c.length!==e.courseNameNumLength||Number(c)<1||Number.isNaN(Number(c))))return void nt(0,n[o].name);if(!0!==(l=tt(c)))return void nt(1,c);r.push(c)}r.sort(),u=d(r),r.length===u.length?!0===a?window.mscConfirm({title:"",subtitle:"Some fields have been left blank.\nCourses with blank fields will not be renamed.\nContinue?",cancelText:"Cancel",onOk:function(){rt()},onCancel:function(){}}):rt():nt(2)}function rt(){var e=t.indexData.courses.length,a,r,i,o;for(o=0;o<e;o++)r=t.indexData.courses[o],"CLINIC"!==(a=n[r]).cat&&""!==(i=s("newName-"+r).value)&&(a.name=i,""!==a.assgn&&(as(a.assgn,r,"off"),as(a.assgn,r,"on")),tr(r));Ds()}function st(e,n){return[e=Math.ceil((Math.ceil(e)-Math.ceil(n))/(Number(t.settings.maxHours)/2))+1,n=Math.ceil(n/(Number(t.settings.maxHours)/2))+1]}function it(){var e=0,n=0,r=t.indexData.schedules.length,s,i;for(i=0;i<r;i++)s=t.indexData.schedules[i],a[s].hasOwnProperty("isSat")?n++:e++;return[e,n]}function ot(e){var n=0,a=0,r=[],s,i,o;for(o=0;o<t.catData.length;o++)n+=t.catData[o][1],a+=t.catData[o][2][5].reduce((function(e,t){return e+t}),0);if(r=st(n,a),!0!==e){if(s=r[0]-1-it[0],i=r[1]-1-it[0],s>0)for(o=0;o<s;o++)le("MtoF");if(i>0)for(o=0;o<i;o++)le("Sat")}else{if(r[0]>0)for(o=0;o<r[0];o++)le("MtoF");if(r[1]>0)for(o=0;o<r[1];o++)le("Sat")}}function ct(){var t=65+e.scheduleRowPixelHeight*(e.uiScheduleNumOfHrsPerDay+1),n=65+e.scheduleRowPixelHeight*(e.uiScheduleNumOfHrsPerDay+1)+25,a="#schedule-instances>div{min-height:"+t+"px;height:"+t+"px;max-height:"+t+"px;} #schedule-instances>div.show-teacher{min-height:"+n+"px;height:"+n+"px;max-height:"+n+"px;}",r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=a:r.appendChild(document.createTextNode(a)),document.getElementsByTagName("head")[0].appendChild(r)}function dt(){s("hrsPerSchedule").value=""+e.maxHours,s("hrsPerSchedule").max=""+5*e.uiScheduleNumOfHrsPerDay,s("hrsPerDay").value=""+e.maxHrsPerDay,s("hrsPerDay").max=""+e.uiScheduleNumOfHrsPerDay}function lt(){ct(),dt(),Ct(),Nt()}function ut(e){var t;return e.map((function(t,n){return n%3==0?e.slice(n,n+3):null})).filter((function(e){return e}))}function pt(n,a,r){t.catData=ut(n),t.indexData={},t.indexData.courses=a,t.indexData.schedules=[],t.indexData.depts=m(),!0===Array.isArray(r)?t.indexData.klinics=r:t.indexData.klinics=[],t.teachers=[],t.tempCparam="",t.tempKlinic={kbtn:"",isHeld:!1},t.lastSearchItem="",t.settings={maxHours:e.maxHours,maxHrsPerDay:e.maxHrsPerDay,maxSeqHrs:3,deptGrps:[[]],deptGrpsSetBy:"day",overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},t.settings.deptGrps=[]}function ht(){var e=[],r=[],s=Ea(),i,o;if(!1!==s){try{Object.keys(n).forEach((function(t){r.push(""+t),i=n[t],-1===e.indexOf(i.cat)?(e.push(i.cat),e.push(1),o=q(0),e.push(o),e[e.indexOf(i.cat)+2][i.dayhr[0][0]][i.dayhr[0][1]]+=1,"CLINIC"!==i.cat&&(e[e.indexOf(i.cat)+2][i.dayhr[1][0]][i.dayhr[1][1]]+=1),"threehour"===i.duration&&(e[e.indexOf(i.cat)+2][i.dayhr[0][0]][i.dayhr[0][1]+1]+=1)):(e[e.indexOf(i.cat)+1]+=1,e[e.indexOf(i.cat)+2][i.dayhr[0][0]][i.dayhr[0][1]]+=1,"CLINIC"!==i.cat&&(e[e.indexOf(i.cat)+2][i.dayhr[1][0]][i.dayhr[1][1]]+=1),"threehour"===i.duration&&(e[e.indexOf(i.cat)+2][i.dayhr[0][0]][i.dayhr[0][1]+1]+=1))})),pt(e,r,s),ot(!0),Ye(!1)}catch(e){return t={},n={},a={},Ra(),void window.mscAlert({title:"Error",subtitle:"The .csv file you have supplied contains unexpected formatting and/or data."})}_()}}function mt(){var e=t.catData.length,a=q(0),r=q(0),s=q(0),i,o,c,d,l;for(c=0;c<e;c++)if("CLINIC"!==(o=t.catData[c])[0]&&"$deleted"!==o[0].substring(0,8)){for(d=0;d<o[2].length;d++)for(l=0;l<o[2][d].length;l++)a[d][l]+=o[2][d][l];for(d=0;d<t.indexData.courses.length;d++)(i=n[t.indexData.courses[d]]).cat===o[0]&&""===i.assgn&&(s[i.dayhr[0][0]][i.dayhr[0][1]]+=1,s[i.dayhr[1][0]][i.dayhr[1][1]]+=1,"threehour"===i.duration&&(s[i.dayhr[1][0]][i.dayhr[1][1]+1]+=1))}for(c=0;c<r.length;c++)for(d=0;d<r[c].length;d++)r[c][d]=a[c][d]-s[c][d];return[r,s]}function ft(){var e=t.catData.length,n=q(0),a,r,s,i;for(r=0;r<e;r++)if("CLINIC"===(a=t.catData[r])[0])for(s=0;s<a[2].length;s++)for(i=0;i<a[2][s].length;i++)n[s][i]+=a[2][s][i];return n}function gt(){var e=mt(),t=ft(),n,a,r;for(a=0;a<e[0].length;a++)for(r=0;r<e[0][a].length;r++)s(n="g_d"+a+"t"+r).textContent=e[0][a][r],e[1][a][r]>0&&(s(n).textContent+=" ("+e[1][a][r]+")");for(a=0;a<t.length;a++)for(r=0;r<t[a].length;r++)s(n="gk_d"+a+"t"+r).textContent=t[a][r]}function vt(){var t=[],n=e.uiScheduleNumOfHrsPerDay,a,r;for(r=0;r<n;r++)a=e.uiTimeInputStartHr+r,t.push(a+":00");return t}function yt(t,n){var a=vt(),r=e.monToSatKr,i=s(t),o=document.createDocumentFragment(),d=document.createElement("TABLE"),l=document.createElement("THEAD"),u=document.createElement("TBODY"),p=document.createElement("TR"),h=document.createElement("TD"),m,f,n,g,v;for(c(i),d.className="table table-bordered table-condensed",p.className="unbordered",p.appendChild(h),g=0;g<r.length;g++)(f=document.createElement("TD")).textContent=r[g],p.appendChild(f);for(u.appendChild(p),g=0;g<a.length;g++){for(m=document.createElement("TR"),v=0;v<=r.length;v++)f=document.createElement("TD"),0===v?(f.className="unbordered text-right",f.textContent=a[g]+"  "):f.id=""+n+(v-1)+"t"+g,m.appendChild(f);u.appendChild(m)}d.appendChild(l),d.appendChild(u),o.appendChild(d),i.appendChild(o)}function xt(e){var a=0,r=0,s="",i,o=t.indexData.courses.length,c;for(c=0;c<o;c++)e===(i=n[t.indexData.courses[c]]).cat&&(""!==i.assgn&&a++,r++);return s+=r-a>0?e+": "+a+" ("+(r-a)+")\n":e+": "+a+"\n"}function wt(){var e=[],a="",r=t.indexData.courses.length,s=t.indexData.klinics.length,i,o,c,d;for(d=0;d<s;d++)(o={}).name=t.indexData.klinics[d].name,o.count=0,e.push(o);for(d=0;d<r;d++)"CLINIC"===(i=n[t.indexData.courses[d]]).cat&&-1!==(c=e.map((function(e){return e.name})).indexOf(i.name))&&(e[c].count+=1);for(d=0;d<e.length;d++)a+=e[d].name+": "+e[d].count+"\n";return a}function bt(){var e="",n=t.catData.length,a;for(a=0;a<n;a++)"$deleted"!==t.catData[a][0].substring(0,8)&&"CLINIC"!==t.catData[a][0]&&(e+=xt(t.catData[a][0]));s("coursesByCat").textContent=e,s("coursesByDef").textContent=wt()||""}function Dt(){gt(),bt(),vr()}function Ct(){s("updateHdrsA").addEventListener("click",lr,{capture:!1,passive:!0}),s("updateHdrsB").addEventListener("click",ur,{capture:!1,passive:!0})}function Nt(){s("csv-file").addEventListener("change",Xt,{capture:!1,passive:!0}),s("json-file").addEventListener("change",dn,{capture:!1,passive:!0}),s("configStartHr").addEventListener("change",Gs,{capture:!1,passive:!0}),s("savedsession").addEventListener("click",ia,{capture:!1,passive:!0}),s("newsession").addEventListener("click",J,{capture:!1,passive:!0}),s("helpfileA").addEventListener("click",hr,{capture:!1,passive:!0}),s("helpfile1").addEventListener("click",mr,{capture:!1,passive:!0})}function kt(){s("csv-file").removeEventListener("change",Xt,{capture:!1,passive:!0}),s("json-file").removeEventListener("change",dn,{capture:!1,passive:!0}),s("configStartHr").removeEventListener("change",Gs,{capture:!1,passive:!0}),s("savedsession").removeEventListener("click",ia,{capture:!1,passive:!0}),s("newsession").removeEventListener("click",J,{capture:!1,passive:!0}),s("helpfileA").removeEventListener("click",hr,{capture:!1,passive:!0}),s("helpfile1").removeEventListener("click",mr,{capture:!1,passive:!0})}function Et(){s("deptEDIT").addEventListener("click",gs,{capture:!1,passive:!0}),s("deptEDIT-file").addEventListener("change",tn,{capture:!1,passive:!0}),s("csv-freshfile").addEventListener("change",Qt,{capture:!1,passive:!0}),s("deptopenL").addEventListener("click",Rs,{capture:!1,passive:!0}),s("save-deptEDIT").addEventListener("click",_n,{capture:!1,passive:!0}),s("deptEDITadd").addEventListener("click",Bn,{capture:!1,passive:!0}),s("exit-deptEDIT").addEventListener("click",Fs,{capture:!1,passive:!0}),s("newcourseform").addEventListener("click",zr,{capture:!1,passive:!0}),s("newcoursename").addEventListener("input",Es,{capture:!1,passive:!0}),s("newcourseroom").addEventListener("input",Ss,{capture:!1,passive:!0}),s("durationone").addEventListener("click",Lr,{capture:!1,passive:!0}),s("durationninety").addEventListener("click",Ir,{capture:!1,passive:!0}),s("durationtwo").addEventListener("click",Or,{capture:!1,passive:!0}),s("durationthree").addEventListener("click",Pr,{capture:!1,passive:!0})}function St(){s("deptEDIT").removeEventListener("click",gs,{capture:!1,passive:!0}),s("deptEDIT-file").removeEventListener("change",tn,{capture:!1,passive:!0}),s("csv-freshfile").removeEventListener("change",Qt,{capture:!1,passive:!0}),s("deptopenL").removeEventListener("click",Rs,{capture:!1,passive:!0}),s("save-deptEDIT").removeEventListener("click",_n,{capture:!1,passive:!0}),s("deptEDITadd").removeEventListener("click",Bn,{capture:!1,passive:!0}),s("exit-deptEDIT").removeEventListener("click",Fs,{capture:!1,passive:!0}),s("newcourseform").removeEventListener("click",zr,{capture:!1,passive:!0}),s("newcoursename").removeEventListener("input",Es,{capture:!1,passive:!0}),s("newcourseroom").removeEventListener("input",Ss,{capture:!1,passive:!0}),s("durationone").removeEventListener("click",Lr,{capture:!1,passive:!0}),s("durationninety").removeEventListener("click",Ir,{capture:!1,passive:!0}),s("durationtwo").removeEventListener("click",Or,{capture:!1,passive:!0}),s("durationthree").removeEventListener("click",Pr,{capture:!1,passive:!0})}function Lt(){s("exit-tchrs").addEventListener("click",An,{capture:!1,passive:!0}),s("save-tchrs").addEventListener("click",Fn,{capture:!1,passive:!0}),s("alltchrs").addEventListener("click",rs,{capture:!1,passive:!0}),s("tchrs-file").addEventListener("change",en,{capture:!1,passive:!0}),s("tchradd").addEventListener("click",Rn,{capture:!1,passive:!0})}function It(){s("exit-tchrs").removeEventListener("click",An,{capture:!1,passive:!0}),s("save-tchrs").removeEventListener("click",Fn,{capture:!1,passive:!0}),s("alltchrs").removeEventListener("click",rs,{capture:!1,passive:!0}),s("tchrs-file").removeEventListener("change",en,{capture:!1,passive:!0}),s("tchradd").removeEventListener("click",Rn,{capture:!1,passive:!0})}function Ot(){s("exitklinicchanges").addEventListener("click",Yn,{capture:!1,passive:!0}),s("saveklinicchanges").addEventListener("click",Na,{capture:!1,passive:!0}),s("klinic-section").addEventListener("click",ra,{capture:!1,passive:!0}),s("klinicadd").addEventListener("click",$a,{capture:!1,passive:!0})}function Pt(){s("exitklinicchanges").removeEventListener("click",Yn,{capture:!1,passive:!0}),s("saveklinicchanges").removeEventListener("click",Na,{capture:!1,passive:!0}),s("klinic-section").removeEventListener("click",ra,{capture:!1,passive:!0}),s("klinicadd").removeEventListener("click",$a,{capture:!1,passive:!0})}function Ht(){s("exit-stats").addEventListener("click",yr,{capture:!1,passive:!0})}function Tt(){s("exit-stats").removeEventListener("click",yr,{capture:!1,passive:!0})}function At(){s("showteachers").removeEventListener("click",Pn,{capture:!1,passive:!0}),s("showteachers").addEventListener("click",On,{capture:!1,passive:!0}),s("showteachers").textContent="Show"}function Rt(){s("showteachers").removeEventListener("click",On,{capture:!1,passive:!0}),s("showteachers").addEventListener("click",Pn,{capture:!1,passive:!0}),s("showteachers").textContent="Hide"}function Ft(){s("leftsidesettings").addEventListener("click",$r,{capture:!1,passive:!0}),s("uploadnewCNames").addEventListener("change",ln,{capture:!1,passive:!0}),s("rightsidesettings").addEventListener("click",Vr,{capture:!1,passive:!0}),s("schedule-instances").addEventListener("click",jr,{capture:!1,passive:!0}),s("references").addEventListener("click",_r,{capture:!1,passive:!0}),s("searchcourses").addEventListener("input",Ls,{capture:!1,passive:!0}),s("showteachers").addEventListener("click",On,{capture:!1,passive:!0}),s("deptGrpsDaily").addEventListener("click",C,{capture:!1,passive:!0}),s("deptGrpsWeekly").addEventListener("click",N,{capture:!1,passive:!0}),s("mlticatsyes").addEventListener("click",k,{capture:!1,passive:!0}),s("mlticatsno").addEventListener("click",E,{capture:!1,passive:!0}),s("startedr").addEventListener("click",Kt,{capture:!1,passive:!0}),s("helpfileB").addEventListener("click",fr,{capture:!1,passive:!0}),s("helpfile1").addEventListener("click",gr,{capture:!1,passive:!0}),s("view-stats").addEventListener("click",Dt,{capture:!1,passive:!0}),s("klinicHold").addEventListener("click",Qn,{capture:!1,passive:!0})}function Gt(){s("deptEDIT").addEventListener("click",gs,{capture:!1,passive:!0}),s("deptEDIT-file").addEventListener("change",tn,{capture:!1,passive:!0}),s("deptopenR").addEventListener("click",Rs,{capture:!1,passive:!0}),s("save-deptEDIT").addEventListener("click",_n,{capture:!1,passive:!0}),s("deptEDITadd").addEventListener("click",Bn,{capture:!1,passive:!0}),s("exit-deptEDIT").addEventListener("click",Fs,{capture:!1,passive:!0}),s("jsonSettings-file").addEventListener("change",an,{capture:!1,passive:!0}),s("alldepartments").addEventListener("click",ys,{capture:!1,passive:!0}),s("newgroupid").addEventListener("click",vs,{capture:!1,passive:!0}),s("allgroups").addEventListener("click",Vn,{capture:!1,passive:!0}),s("seqHrsTwo").addEventListener("click",b,{capture:!1,passive:!0}),s("seqHrsThree").addEventListener("click",D,{capture:!1,passive:!0}),s("hrsPerSchedule").addEventListener("input",Ns,{capture:!1,passive:!0}),s("hrsPerDay").addEventListener("input",ks,{capture:!1,passive:!0}),s("save-settings").addEventListener("click",pr,{capture:!1,passive:!0}),sr("setting-section")}function Bt(){s("deptEDIT").removeEventListener("click",gs,{capture:!1,passive:!0}),s("deptEDIT-file").removeEventListener("change",tn,{capture:!1,passive:!0}),s("deptopenR").removeEventListener("click",Rs,{capture:!1,passive:!0}),s("save-deptEDIT").removeEventListener("click",_n,{capture:!1,passive:!0}),s("deptEDITadd").removeEventListener("click",Bn,{capture:!1,passive:!0}),s("exit-deptEDIT").removeEventListener("click",Fs,{capture:!1,passive:!0}),s("jsonSettings-file").removeEventListener("change",an,{capture:!1,passive:!0}),s("alldepartments").removeEventListener("click",ys,{capture:!1,passive:!0}),s("newgroupid").removeEventListener("click",vs,{capture:!1,passive:!0}),s("allgroups").removeEventListener("click",Vn,{capture:!1,passive:!0}),s("seqHrsTwo").removeEventListener("click",b,{capture:!1,passive:!0}),s("seqHrsThree").removeEventListener("click",D,{capture:!1,passive:!0}),s("hrsPerSchedule").removeEventListener("input",Ns,{capture:!1,passive:!0}),s("hrsPerDay").removeEventListener("input",ks,{capture:!1,passive:!0}),s("save-settings").removeEventListener("click",pr,{capture:!1,passive:!0})}function Kt(){xs(),s("startedr").removeEventListener("click",Kt,{capture:!1,passive:!0}),s("startedr").addEventListener("click",qt,{capture:!1,passive:!0}),s("startedr").textContent="Close",sr("addnewcourse"),sr("renamer"),sr("purger"),sr("openklinics"),rr("klinicscontainer"),rr("klinicHolder")}function qt(){ws(),s("startedr").removeEventListener("click",qt,{capture:!1,passive:!0}),s("startedr").addEventListener("click",Kt,{capture:!1,passive:!0}),s("startedr").textContent="",rr("renamer"),rr("newCNames"),rr("addnewcourse"),rr("purger"),rr("openklinics"),Va(),_t("CLINIC")&&sr("klinicscontainer")}function _t(e){var n=!1,a;for(a=0;a<t.catData.length;a++)if(t.catData[a][0]===e){n=!0;break}return n}function Jt(){var e=[],n=t.indexData.schedules.length,r,s;for(s=0;s<n;s++)(r=a[t.indexData.schedules[s]]).cRef.length||6!==r.dayOff||e.push(t.indexData.schedules[s]);return e}function Mt(e){var a={},r=t.indexData.courses.length,s,i;for(i=0;i<r;i++)(s=n[t.indexData.courses[i]]).cat===e&&""===s.assgn&&(a[t.indexData.courses[i]]=s);return a}function jt(n){var a={},r=[],s,i,o,c,d;try{a=new Worker("autoBldr_14.min.js")}catch(e){return}i=Jt(),o=Mt(n),c=t.settings,d=""+e.uiScheduleNumOfHrsPerDay,r.push(i,o,c,d),s=JSON.stringify(r),a.onmessage=function(e){Vt(e)},a.postMessage(s)}function Wt(e){var n=Number(e.substring(4))-1,a=t.catData[n][0],r;!0===$t(a)&&jt(a)}function $t(e){var a=0,r=Jt(),s=!0,i=t.indexData.courses.length,o,c;for(!1===_t(e)&&(s=!1),"CLINIC"===e&&(s=!1),c=0;c<i;c++)(o=n[t.indexData.courses[c]]).cat===e&&""===o.assgn&&a++;return!0===t.settings.overrides.maxHours?(window.mscAlert({title:"",subtitle:"Please turn off the override for MAX. HOURS!"}),s=!1):a<t.settings.maxHours/2?(window.mscAlert({title:"",subtitle:"Too few unassigned courses left to justify this action!"}),s=!1):r.length||(window.mscAlert({title:"",subtitle:"No empty schedules are available."}),s=!1),s}function Vt(e){var t=JSON.parse(e.data),n=Object.keys(t),r=n.length,i,o,c,d,l,u;for(l=0;l<r;l++){for(i=(o=t[c=n[l]]).cRef.length,u=0;u<i;u++)ie(c,d=o.cRef[u]),as(c,d,"on");a[c].dayOff=o.dayOff,s("off"+o.dayOff+c).style.color="#2c3e50",ts(c),We(c)}}function zt(t,n){var a,r={text:" "+n,color:e.pdfCourseColors[t.indexOf(n)]||""};return t.length&&n!==t[t.length-1]&&(r.text=" "+n+", "),r}function Ut(){var e=t.indexData.courses.map((function(e){if("CLINIC"===n[e].cat&&""!==n[e].assgn)return n[e]})).filter((function(e){return void 0!==e})),r=e.length,s,i;for(i=0;i<r;i++)(s=e[i]).tchr="unassigned",a[s.assgn].hasOwnProperty("tchr")&&""!==a[s.assgn].tchr&&(s.tchr=a[s.assgn].tchr);return e}function Yt(){var e=Ut(),n=t.indexData.klinics.map((function(e){return e.name})),a=[],r,s,i;for(d(n),i=0;i<n.length;i++)(r=e.filter((function(e){return e.name===n[i]}))).length&&((s={}).def=n[i],s.inst=r,a.push(s));return a}function Zt(e){var t={},n=B((new Date).toDateString()),a,r;"dlklinicpdf"===e?(a="PrintClinics_"+n+".pdf",r=Aa()):(a="PrintSchedules_"+n+".pdf",r=Ta()),s(e).className+=" disabled";try{t=new Worker("pdfWorker.js")}catch(e){return}t.onmessage=function(t){window.saveAs(t.data.pdfBlob,a),s(e).className=R(s(e).className,"disabled")},t.postMessage(r)}function Xt(e){var t;if("csv"!==(t=e.target.files[0]).name.substring(t.name.length-3))return s("inputFile").reset(),void window.mscAlert({title:"Error",subtitle:"File is not .csv!"});window.Papa.parse(t,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t=[r.courseCat,r.courseNum,r.courseTime,r.courseRm],a=[!1,""],i;for(i=0;i<t.length;i++)if(-1===e.meta.fields.indexOf(t[i])){a[0]=!0,a[1]=t[i];break}!0===a[0]?(n={},window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+a[1]+'"'})):hn(e.data,e.meta.fields),s("inputFile").reset(),rr("parsing")}})}function Qt(e){var n;if("csv"!==(n=e.target.files[0]).name.substring(n.name.length-3))return s("freshFile").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file."});window.Papa.parse(n,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var n=[r.courseCat,r.courseNum,r.courseTime,r.courseRm],a=[!1,""],i=!1,o;for(t.newDepts=[],t.newKlinicDefs=[],t.newCourses=[],t.overwriteCourses=[],o=0;o<n.length;o++)if(-1===e.meta.fields.indexOf(n[o])){a[0]=!0,a[1]=n[o];break}!0===a[0]?(ve(),window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+a[1]+'"'})):(-1!==e.meta.fields.indexOf(r.courseTchr)&&(i=!0),pn(e.data,e.meta.fields,i)),s("freshFile").reset(),rr("parsing")}})}function en(e){var n=e.target.files[0];if("csv"!==n.name.substring(n.name.length-3))return s("inputTCHRS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(n,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var n,a,r;if(!e.data[0].hasOwnProperty("teachers"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "teachers"\n("강사명" is an optional ADMIN .csv display name).'});for(r=0;r<e.data.length;r++)if(n=O(P(e.data[r].teachers)),a=O(P(e.data[r]["강사명"]))||"",""!==n)if(!0===Hn(n)){if(""!==a&&void 0!==a){var i=t.teachers.map((function(e){return e.en})).indexOf(n);t.teachers[i].kor=a}}else Qa(n,a)}s("inputTCHRS").reset()}})}function tn(e){var n=e.target.files[0];if("csv"!==n.name.substring(n.name.length-3))return s("inputDEPTS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(n,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var n,a,r;if(!e.data[0].hasOwnProperty("shortcode"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "shortcode"\n("description" is an optional header.)'});for(r=0;r<e.data.length;r++)if(n=I(P(e.data[r].shortcode)),a=S(P(e.data[r].description))||"",""!==n)if(!0===Gn(n)){if(""!==a&&void 0!==a){var i=t.indexData.depts.map((function(e){return e.shortcode})).indexOf(n);t.indexData.depts[i].description=a}}else Ya(n,a)}s("inputDEPTS").reset()}})}function nn(e){var t={},n;try{t=(n=JSON.parse(e))[0],da(),va(t)}catch(e){return window.mscAlert({title:"Error",subtitle:"The JSON file you have supplied cannot be used."}),void la()}As(),Ts(),Va(),pr(),window.mscAlert({title:"Success!",subtitle:"Settings, departments, groups, teachers and clinic definitions have been loaded from file."})}function an(e){var t=e.target.files[0],n;if("json"!==t.name.substring(t.name.length-4))return s("uploadJSON").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(n=new window.FileReader).onload=function(){nn(n.result)},n.readAsText(t),s("uploadJSON").reset()}function rn(e){var a={},r=t.indexData.courses.length,s,i;for(i=0;i<r;i++)(s=n[t.indexData.courses[i]]).cat===e&&(a[t.indexData.courses[i]]={},a[t.indexData.courses[i]].assign="",a[t.indexData.courses[i]].cat=s.cat,a[t.indexData.courses[i]].dayhr=s.dayhr,a[t.indexData.courses[i]].dept=s.dept,a[t.indexData.courses[i]].duration=s.duration,a[t.indexData.courses[i]].name=s.name,a[t.indexData.courses[i]].rm=s.rm,a[t.indexData.courses[i]].times=s.times,"ninety"===s.duration&&(a[t.indexData.courses[i]].allowFollow=s.allowFollow));return a}function sn(){var n={},a=[],r,s,i,o,c,d,l;for((s=JSON.parse(JSON.stringify(t.settings))).overrides.maxHours=!1,l=0;l<t.catData.length;l++)"CLINIC"!==t.catData[l][0]&&(n=new Worker("autoBldr_14.min.js"),i=t.indexData.schedules,o=rn(t.catData[l][0]),c=s,d=""+e.uiScheduleNumOfHrsPerDay,(a=[]).push(i,o,c,d),r=JSON.stringify(a),n.onmessage=function(e){},n.onerror=function(e){throw e.preventDefault(),new Error("Cannot autoBld with this JSON.")},n.postMessage(r))}function on(e){var t;Object.keys(e).forEach((function(t){"string"==typeof e[t]&&""!==e[t]&&void 0!==r[t]&&(r[t]=e[t])}))}function cn(r,s,o){var c;try{c=JSON.parse(r),!0===s?(n={},a={},i(),va(c[0])):(t=c[0],n=c[1],a=c[2],on(c[3]),e.uiTimeInputStartHr=c[4].uiTimeInputStartHr,e.uiScheduleNumOfHrsPerDay=c[4].uiScheduleNumOfHrsPerDay,sn())}catch(e){return void ca(o)}try{Ye(!0)}catch(e){return ca(o),void Ra()}_()}function dn(e){var t=e.target.files[0],n=s("settingsOnly").checked,a;if("json"!==t.name.substring(t.name.length-4))return s("inputJSON").reset(),s("settingsOnly").checked=!1,void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(a=new window.FileReader).onload=function(){cn(a.result,n,0)},a.readAsText(t),s("inputJSON").reset(),s("settingsOnly").checked=!1}function ln(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return s("inputRENAME").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .csv file!"});window.Papa.parse(t,{header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t=[];if(e.data.length){if(!e.data[0].hasOwnProperty(r.oldNum)||!e.data[0].hasOwnProperty(r.newNum))return void window.mscAlert({title:"",subtitle:'File is missing the required headers: "'+r.oldNum+'" and "'+r.newNum+'".'});var n;for(n=0;n<e.data.length;n++)t.push([G(P(e.data[n][r.oldNum])),G(P(e.data[n][r.newNum]))])}et(t),s("inputRENAME").reset()}})}function un(e,t){var n=fn(e,a),a=!t;n>0&&window.mscAlert({title:"",subtitle:n+' course(s) contain(s) exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),!0!==t?ye():ht()}function pn(e,n,a){var s=e.length,i=t.teachers,o=[],c,d,l,u,p;for(p=0;p<s;p++)if("CLINIC"===(l=e[p])[r.courseCat])try{if((c={}).cat="CLINIC",c.name=l[r.courseNum],c.fullname=c.name,c.rm={},c.rm.a=H(L(l[r.courseRm])),c.dept=vn(I(l[r.courseRm])),""===c.dept||""===c.name||""===c.rm.a)throw new Error("Parsed value is empty string");t.newKlinicDefs.push(JSON.parse(JSON.stringify(c)))}catch(e){o.push(l[r.courseCat]);continue}else try{if((c={}).assgn="",d=wn(l[r.courseTime]),c.dayhr=Nn(d),c.times=Cn(d),c.duration=d.type,"ninety"===c.duration&&(c.allowFollow=Dn(d.charArr[4],d.charArr[9])),c.cat=F(S(l[r.courseCat])),c.dept=vn(l[r.courseRm]),c.name=G(l[r.courseNum]),c.rm=gn(l[r.courseRm],d.type,c.dept),""===c.cat||""===c.dept||""===c.name||""===c.rm.a)throw new Error("Parsed value is empty string");!0===a&&null==(u=i.filter((function(e){return e.en===l[r.courseTchr]||e.kor===l[r.courseTchr]}))[0])&&""!==l[r.courseTchr]&&t.teachers.push({en:l[r.courseTchr],kor:l[r.courseTchr]}),t.newCourses.push(c)}catch(t){o.push(e[p]);continue}o.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),pa(n,o)),un(t.newCourses,!1)}function hn(e,t){var a=e.length,s=[],i,o,c,d,l;for(Bs(),l=0;l<a;l++)if("CLINIC"!==(c=e[l])[r.courseCat])try{if(i="c"+(l+1),(d={}).assgn="",o=wn(c[r.courseTime]),d.dayhr=Nn(o),d.times=Cn(o),d.duration=o.type,"ninety"===d.duration&&(d.allowFollow=Dn(o.charArr[4],o.charArr[9])),d.cat=F(S(c[r.courseCat])),d.dept=vn(c[r.courseRm]),d.name=G(c[r.courseNum]),d.rm=gn(c[r.courseRm],o.type,d.dept),""===d.cat||""===d.dept||""===d.name||""===d.rm.a)throw new Error("Parsed value is empty string");n[i]=d}catch(t){s.push(e[l]);continue}s.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),pa(t,s)),un(n,!0)}function mn(t,n){return!!n.hasOwnProperty(t)&&(("assgn"===t||""!==n[t])&&(("name"!==t||!(n[t].length!==e.courseNameNumLength||Number(n[t])<1||Number.isNaN(Number(n[t]))))&&("dayhr"!==t||!n[t][0].identical(n[t][1]))))}function fn(e,t){var n=0,a=Object.keys(e),r=["assgn","cat","dayhr","dept","duration","name","rm","times"],s=r.length,i,o,c,d;for(!0===t&&(a=a.map((function(e){return Number(e)}))),c=a.length-1;c>=0;c--){for(i=!0,d=0;d<s;d++)(o=mn(r[d],e[a[c]]))||(i=!1);!1===i&&(n+=1,!0===t?e.splice(c,1):delete e[a[c]])}return n}function gn(e,t,n){var a={},r=L(e).split(n).filter((function(e){return""!==e}));return a.a=r[0],r.length>1&&("onehour"===t||"ninety"===t)&&(a.b=r[1]),a}function vn(e){var t=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter((function(e){return""!==e})),n="error";return t.length&&(n=t[0]),n}function yn(e){var t={charArr:[],type:"error"},n=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter((function(e){return""!==e})),a=e.split(/[^0-9]/).filter((function(e){return""!==e})),r=n.length,s=a.length;return 2!==s&&4!==s&&8!==s?t:(2===r&&8===s&&(a.splice(0,0,n[0]),a.splice(5,0,n[1]),t.type="1"),1===r&&(4===s&&(t.type="2"),2===s&&(t.type="3"),a.unshift(n[0])),t.charArr=a,t)}function xn(t,n){return t>=Number(e.uiTimeInputStartHr)&&t<n}function wn(t){var n=bn(t),a=!1,r=Number(e.uiTimeInputStartHr)+Number(e.uiScheduleNumOfHrsPerDay),s={onehour:r,ninety:r-1,twohour:r-1,threehour:r-2,klinichour:r};if("error"!==n.type&&(a=xn(Number(n.charArr[1]),s[n.type]),"klinichour"!==n.type&&(a=xn(Number(n.charArr[3]),s[n.type]),"twohour"!==n.type&&"threehour"!==n.type&&(a=xn(Number(n.charArr[6]),s[n.type])&&xn(Number(n.charArr[8]),s[n.type])))),!0!==a)throw new Error("Unexpected day/time values");return n}function bn(e){var t=yn(e),n=t.charArr[2],a,r,s,i;return"error"===t.type?t:"3"===t.type&&"00"===n?(t.type="klinichour",t):("00"===n&&(a=Number(t.charArr[3])-Number(t.charArr[1]),"50"===t.charArr[4]&&("2"===t.type&&(1===a&&(t.type="twohour"),2===a&&(t.type="threehour")),"1"===t.type&&(i=Number(t.charArr[8])-Number(t.charArr[6]),r=t.charArr[7],s=t.charArr[9],0===a&&0===i&&"00"===r&&"50"===s&&(t.type="onehour"))),"15"===t.charArr[4]&&"1"===t.type&&1===a&&(i=Number(t.charArr[8])-Number(t.charArr[6]),r=t.charArr[7],s=t.charArr[9],1===i&&(t.type="ninety"))),"30"===n&&"1"===t.type&&(a=Number(t.charArr[3])-Number(t.charArr[1]),"45"===t.charArr[4]&&1===a&&(i=Number(t.charArr[8])-Number(t.charArr[6]),r=t.charArr[7],s=t.charArr[9],1===i&&(t.type="ninety"))),t)}function Dn(e,t){var n=[];return n[0]=Boolean(!1),n[1]=Boolean(!1),"15"===e&&(n[0]=Boolean(!0)),"15"===t&&(n[1]=Boolean(!0)),n}function Cn(e){var t="";return"error"!==e.type&&(t+=e.charArr[0]+""+e.charArr[1]+":"+e.charArr[2],"klinichour"!==e.type&&("twohour"!==e.type&&"threehour"!==e.type||(t+="-"+e.charArr[3]+":"+e.charArr[4]),"onehour"!==e.type&&"ninety"!==e.type||(t+=","+e.charArr[5]+e.charArr[6]+":"+e.charArr[7]))),t}function Nn(t){var n={"월":0,"화":1,"수":2,"목":3,"금":4,"토":5},a=[[],[]],r=Number(e.uiTimeInputStartHr);if("error"!==t.type&&(a[0][0]=n[t.charArr[0]],a[0][1]=Number(t.charArr[1])-r,"klinichour"!==t.type&&("twohour"!==t.type&&"threehour"!==t.type||(a[1][0]=n[t.charArr[0]],a[1][1]=Number(t.charArr[3])-r),"onehour"!==t.type&&"ninety"!==t.type||(a[1][0]=n[t.charArr[5]],a[1][1]=Number(t.charArr[6])-r)),"klinichour"===t.type&&(a[1][0]=n[t.charArr[0]],a[1][1]=Number(t.charArr[1])-r),a[0][0]===a[1][0]&&a[0][1]===a[1][1]&&(t.type="error")),"error"===t.type)throw new Error("Unexpected day/time values");return a}function kn(e){In(e),rr("tchrsee"+e),sr("tchrchg"+e)}function En(e){var t=s("tchrset"+e);"unassigned"!==t.textContent&&(t.textContent="unassigned",a[e].tchr="",Ln(e))}function Sn(e){var n,r,i;if(t.teachers.length){var o=s("tchredt"+e).options[s("tchredt"+e).selectedIndex].value;if(""!==o){for(r=t.indexData.schedules.length,i=0;i<r;i++)if(n=t.indexData.schedules[i],a[n].hasOwnProperty("tchr")){if(n===e)continue;if(a[n].tchr===o)return window.mscAlert({title:"",subtitle:o+" has already been assigned to schedule "+n}),En(e),rr("tchrchg"+e),void sr("tchrsee"+e)}s("tchrset"+e).textContent=o}else s("tchrset"+e).textContent="unassigned";a[e].tchr=o}rr("tchrchg"+e),Ln(e),sr("tchrsee"+e)}function Ln(e){""!==a[e].tchr&&a[e].hasOwnProperty("tchr")?sr("tchrclr"+e):rr("tchrclr"+e)}function In(e){var n=s("tchredt"+e),r=document.createDocumentFragment(),i=document.createElement("option"),o=t.teachers.length,d,l;if(c(n),i.value="",i.textContent="select teacher",r.appendChild(i),o)for(l=0;l<o;l++)(d=document.createElement("option")).value=""+t.teachers[l].en,d.textContent=d.value,r.appendChild(d);if(n.appendChild(r),n.options[0].disabled=!0,a[e].hasOwnProperty("tchr")&&""!==a[e].tchr)for(l=1;l<n.options.length;l++)if(a[e].tchr===n.options[l].value){n.selectedIndex=l;break}}function On(){var e=t.indexData.schedules.length,n,a;for(Rt(),a=0;a<e;a++)Ln(n=t.indexData.schedules[a]),ir(n),sr("tchrsee"+n)}function Pn(){var e=t.indexData.schedules.length,n,a;for(At(),a=0;a<e;a++)rr("tchrsee"+(n=t.indexData.schedules[a])),or(n),rr("tchrchg"+n)}function Hn(e){var n=!1,a=t.teachers.length,r;if(a)for(r=0;r<a;r++)if(t.teachers[r].en.toLowerCase()===e.toLowerCase()){n=!0;break}return n}function Tn(){var e=t.indexData.schedules.length,n,a;for(Xa(),rr("displayOverrides"),rr("left"),rr("right"),Lt(),sr("tchrs-section"),a=0;a<e;a++)s(n=t.indexData.schedules[a]).classList.contains("show-teacher")&&(sr("tchrsee"+n),rr("tchrchg"+n))}function An(){c(s("alltchrs")),rr("tchrs-section"),It(),sr("displayOverrides"),sr("left"),sr("right")}function Rn(){Qa("","")}function Fn(){var e=s("alltchrs").childNodes,n,r,i,o;for(t.teachers=[],o=0;o<e.length;o++)1==e[o].nodeType&&""!==e[o].childNodes[0].value&&void 0!==e[o].childNodes[0].value&&((n={}).en=e[o].childNodes[0].value,n.kor=e[o].childNodes[1].value,t.teachers.push(n));if(t.teachers.length){for(o=0;o<t.teachers.length;o++)t.teachers[o].en=P(O(t.teachers[o].en)),t.teachers[o].kor=P(O(t.teachers[o].kor));t.teachers.sort((function(e,t){return e.en.localeCompare(t.en)})),t.teachers=l(t.teachers,"en")}for(r=t.indexData.schedules.length,o=0;o<r;o++)i=t.indexData.schedules[o],a[i].hasOwnProperty("tchr")&&""!==a[i].tchr&&(t.teachers.length?-1===t.teachers.map((function(e){return e.en})).indexOf(a[i].tchr)&&En(i):En(i));An()}function Gn(e){var n=!1,a=t.indexData.depts.length,r;if(a)for(r=0;r<a;r++)if(t.indexData.depts[r].shortcode===e){n=!0;break}return n}function Bn(){Ya("","")}function Kn(e){var a=!0,r=t.indexData.courses.length,s,i;for(i=0;i<r;i++)if(s=t.indexData.courses[i],n[s].dept===e){a=!1;break}return a}function qn(e){var t=!0,n=I(s(e).value);return""!==n&&!0===Gn(n)&&!0!==Kn(n)&&(t=!1,window.mscAlert({title:"",subtitle:"The department: "+n+" is currently assigned to one or more courses and cannot be deleted."})),t}function _n(){var e=s("deptEDIT").childNodes,n=[],a=[],r,i,o,c,d,l,p,h,m,f,g;for(d=e.length,m=0;m<d;m++)1==e[m].nodeType&&(r=I(e[m].childNodes[0].value),i=S(e[m].childNodes[1].value),o=t.indexData.depts.map((function(e){return e.shortcode})).indexOf(r),void 0!==r&&""!==r&&((c={}).shortcode=r,c.description=i,n.push(c),-1===o?t.indexData.depts.push(c):t.indexData.depts[o].description=i));for((d=t.indexData.depts.length)&&(t.indexData.depts.sort((function(e,t){return e.shortcode.localeCompare(t.shortcode)})),t.indexData.depts=u(t.indexData.depts,"shortcode")),m=0;m<d;m++)p=t.indexData.depts[m].shortcode,-1===(h=n.map((function(e){return e.shortcode})).indexOf(p))&&!0===Kn(p)&&a.push(p);for(d=a.length,m=0;m<d;m++)for(f=t.indexData.depts.length-1;f>=0;f--)t.indexData.depts[f].shortcode===a[m]&&t.indexData.depts.splice(f,1);if(Ma(),(l=t.settings.deptGrps).length&&d)for(m=0;m<d;m++)for(f=0;f<l.length;f++)for(g=l[f].length-1;g>=0;g--)l[f][g]===a[m]&&l[f].splice(g,1);Xe(),s("setting-section").classList.contains("nodisplay")?hs():(Wa(),za()),Fs()}function Jn(e){var t=[],r=a[e].cRef,s=r.length,i,o;for(o=0;o<s;o++)t.push(n[r[o]].dept);for(t.sort(),s=(i=d(t)).length,o=0;o<s;o++)i[o]="\n"+i[o]+" = "+Mn(i[o]);return i}function Mn(e){var n=t.indexData.depts.filter((function(t){return t.shortcode===e}))[0];return null==n?"":n.description}function jn(){var e=t.newCourses.length,n,a,r;for(r=0;r<e;r++)null!=t.newCourses[r]&&-1===(n=t.indexData.depts.map((function(e){return e.shortcode})).indexOf(t.newCourses[r].dept))&&((a={}).shortcode=t.newCourses[r].dept,a.description="",t.newDepts.push(a));t.newDepts.length>1&&(t.newDepts.sort((function(e,t){return e.shortcode.localeCompare(t.shortcode)})),t.newDepts=u(t.newDepts,"shortcode"))}function Wn(){var e=t.newDepts.length,n;if(e){for(n=0;n<e;n++)t.indexData.depts.push(t.newDepts[n]);t.indexData.depts.length>1&&t.indexData.depts.sort((function(e,t){return e.shortcode.localeCompare(t.shortcode)})),t.newDepts=[]}delete t.newDepts}function $n(e,n){var a=Number(s("newgroupid").dataset.grpindex),r=s(e),i=r.dataset.deptname,o=t.settings.deptGrps;if(!0===n)return r.style.backgroundColor="#3498db",r.style.color="#ffffff",r.style.borderColor="#3498db",o.length&&o[a]||t.settings.deptGrps.push([]),void(-1===o[a].indexOf(i)&&t.settings.deptGrps[a].push(i));r.style.backgroundColor="",r.style.color="",r.style.borderColor="",(o=t.settings.deptGrp)[a]&&o[a].length&&-1!==o[a].indexOf(i)&&t.settings.deptGrps[a].splice(t.settings.deptGrps[a].indexOf(i),1)}function Vn(e){if(e.target!==e.currentTarget&&"remove"==e.target.id.substring(0,6)){var n=Number(e.target.id.substring(6));t.settings.deptGrps[n]&&zn(n)}e.stopPropagation()}function zn(e){t.settings.deptGrps.splice(e,1),s("newgroupid").dataset.grpindex=t.settings.deptGrps.length,za()}function Un(){t.indexData.depts.length?(rr("displayOverrides"),s("left").style.visibility="hidden",s("right").style.visibility="hidden",Ot(),er(),sr("defineklinics")):window.mscAlert({title:"",subtitle:"Please define at least one department first.\n(New course or category -> Edit departments)"})}function Yn(){rr("defineklinics"),Pt(),qt(),s("left").style.visibility="visible",s("right").style.visibility="visible",sr("displayOverrides")}function Zn(e){var t=e.substring(6);s("klnm_"+t).value="",s("klfn_"+t).value="",rr("kl_"+t)}function Xn(e,t){var n;if(!0===t)for(n=0;n<e.length;n++)e[n]=e[n].toLowerCase();return e.length!==d(e).length}function Qn(){s("klinicHold").checked?t.tempKlinic.isHeld=!0:t.tempKlinic.isHeld=!1}function ea(e){s("klinicHold").checked="on"===e,Qn()}function ta(t){var n,a;return""+e.monToSatKr[t[0]]+("0"+(t[1]+Number(e.uiTimeInputStartHr))).slice(-2)+":00"}function na(){var e,n;if(e=t.catData.length)for(n=0;n<e;n++)if("CLINIC"===t.catData[n][0])return;t.catData.push(["CLINIC",0,q(0)]),_a(e=t.catData.length),s("courselist"+e).setAttribute("class","show")}function aa(e,a){var r=ka(e,a),s=t.catData.length,i,o;if(null!=r){for(o=0;o<s;o++)if(t.catData[o][0]===n[r[1]].cat){i=o+1;break}Sa(r[1],i),Be(r[0],r[1])}}function ra(e){e.target!==e.currentTarget&&"kldel_"===e.target.id.substring(0,6)&&Zn(e.target.id)}function sa(){var e=t.newKlinicDefs.length,n,a;if(e){for(_t("CLINIC")||he(!1,"CLINIC"),a=0;a<e;a++)-1===(n=t.indexData.klinics.map((function(e){return e.name})).indexOf(t.newKlinicDefs[a].name))&&t.indexData.klinics.push(t.newKlinicDefs[a]);t.indexData.klinics.sort((function(e,t){return e.name.localeCompare(t.name)})),t.newKlinicDefs=[]}delete t.newKlinicDefs}function ia(){var e=window.localStorage.getItem("lastStats"),t=window.localStorage.getItem("lastCourseData"),n=window.localStorage.getItem("lastScheduleData"),a=window.localStorage.getItem("lastCsvStrs"),r=window.localStorage.getItem("lastCfg"),s;null!==e&&null!==t&&null!==n&&null!==r?(s="["+e+","+t+","+n,s+=null!==a?","+a:",{}",cn(s+=","+r+"]",!1,1)):window.mscAlert({title:"",subtitle:"No previous session available."})}function oa(){var s,i,c;if(!o(t)&&t.hasOwnProperty("catData")){if(t.catData.length){for(c=t.catData.length-1;c>=0;c--)"$deleted"===t.catData[c][0].substring(0,8)&&t.catData.splice(c,1);for(s=0,t.indexData.schedules.length>t.indexData.courses.length/(t.settings.maxHours/2)&&(s=t.indexData.schedules.length-Math.round(t.indexData.courses.length/(t.settings.maxHours/2))),c=t.indexData.schedules.length-1;c>=0;c--)if(!a[t.indexData.schedules[c]].cRef.length&&6===a[t.indexData.schedules[c]].dayOff){if(--s<=0)break;delete a[t.indexData.schedules[c]],t.indexData.schedules.splice(c,1)}}(i={}).uiTimeInputStartHr=e.uiTimeInputStartHr,i.uiScheduleNumOfHrsPerDay=e.uiScheduleNumOfHrsPerDay,window.localStorage.clear(),window.localStorage.setItem("lastStats",JSON.stringify(t)),window.localStorage.setItem("lastCourseData",JSON.stringify(n)),window.localStorage.setItem("lastScheduleData",JSON.stringify(a)),window.localStorage.setItem("lastCsvStrs",JSON.stringify(r)),window.localStorage.setItem("lastCfg",JSON.stringify(i))}}function ca(e){var i=["The JSON file you have supplied cannot be used.","The last saved session is unusable and has been deleted."];t={},n={},a={},r={courseCat:f("courseCat"),courseNum:f("courseNum"),courseTime:f("courseTime"),courseRm:f("courseRm"),courseTchr:f("courseTchr"),oldNum:f("oldNum"),newNum:f("newNum")},Bs(),s("inputJSON").reset(),s("settingsOnly").checked=!1,s("configStartHr").disabled=!1,s("configNumOfHrsPerDay").disabled=!1,sr("parsing"),window.mscAlert({title:"",subtitle:i[e]}),1===e&&window.localStorage.clear()}function da(){window.localStorage.setItem("statsBkUp",JSON.stringify(t))}function la(){var e=JSON.parse(window.localStorage.getItem("statsBkUp"));t={},o(e)||(t=e),window.localStorage.removeItem("statsBkUp")}function ua(t,n,a){var r,s=t+"_"+B((new Date).toDateString())+"."+n,i,o;i="csv"===n?window.Papa.unparse(a):a,o=new Blob([i],{type:e.uriTypes[n]}),window.saveAs(o,s)}function pa(e,t){var n={fields:[],data:[]};n.fields=e,n.data=t,ua("CSV_ERRORS","csv",n)}function ha(t,n){return("0"+(t+Number(e.uiTimeInputStartHr)+n).toString()).slice(-2)}function ma(){var e={fields:[r.courseCat,r.courseNum,r.courseTchr,"대상학과",r.courseTime,r.courseRm],data:[]},s=["월","화","수","목","금","토"],i=t.indexData.courses.length,o={},c=[],d,l,u;for(u=0;u<i;u++)l=n[t.indexData.courses[u]],o.tmeStr="",o.rmStr="",o.numStr="00",c=[l.cat,l.name,"","","",""],o.krDay0=s[l.dayhr[0][0]],o.krDay1=s[l.dayhr[1][0]],o.dyhr01=l.dayhr[0][1],o.dyhr11=l.dayhr[1][1],o.sRef=a[l.assgn],""!==l.assgn&&o.sRef.hasOwnProperty("tchr")&&(-1!==(d=t.teachers.map((function(e){return e.en})).indexOf(o.sRef.tchr))&&""!==t.teachers[d].kor?c[2]=t.teachers[d].kor:c[2]=o.sRef.tchr),"onehour"===l.duration&&(o.numStr=ha(o.dyhr01,0),o.tmeStr+=o.krDay0+"("+o.numStr+":00∼"+o.numStr+":50) ",o.numStr=ha(o.dyhr11,0),o.tmeStr+=o.krDay1+"("+o.numStr+":00∼"+o.numStr+":50)"),"twohour"!==l.duration&&"threehour"!==l.duration||(o.numStr=ha(o.dyhr01,0),o.tmeStr+=o.krDay0+"("+o.numStr+":00∼","twohour"===l.duration&&(o.numStr=ha(o.dyhr01,1)),"threehour"===l.duration&&(o.numStr=ha(o.dyhr01,2)),o.tmeStr+=o.numStr+":50)"),"ninety"===l.duration&&(o.numStr=ha(o.dyhr01,0),o.tmeStr+=o.krDay0+"("+o.numStr,o.numStr=ha(o.dyhr01,1),!0===l.allowFollow[0]&&(o.tmeStr+=":00∼"+o.numStr+":15) "),!1===l.allowFollow[0]&&(o.tmeStr+=":30∼"+o.numStr+":45) "),o.numStr=ha(o.dyhr11,0),o.tmeStr+=o.krDay1+"("+o.numStr,o.numStr=ha(o.dyhr11,1),!0===l.allowFollow[1]&&(o.tmeStr+=":00∼"+o.numStr+":15)"),!1===l.allowFollow[1]&&(o.tmeStr+=":30∼"+o.numStr+":45)")),"klinichour"===l.duration&&(o.numStr=ha(o.dyhr01,0),o.tmeStr+=o.krDay0+"("+o.numStr+":00∼"+o.numStr+":50)"),c[4]=o.tmeStr,o.rmStr=l.dept+l.rm.a,l.rm.hasOwnProperty("b")&&l.rm.a!==l.rm.b&&(o.rmStr+=" "+l.dept+l.rm.b),c[5]=o.rmStr,e.data.push(c);ua("AllCourseData_","csv",e)}function fa(){var s=0,i=JSON.parse(JSON.stringify(t)),o=JSON.parse(JSON.stringify(a)),c={uiTimeInputStartHr:e.uiTimeInputStartHr,uiScheduleNumOfHrsPerDay:e.uiScheduleNumOfHrsPerDay},d=[],l;if(i.catData.length)for(l=i.catData.length-1;l>=0;l--)"$deleted"===i.catData[l][0].substring(0,8)&&i.catData.splice(l,1);for(i.indexData.schedules.length>i.indexData.courses.length/(i.settings.maxHours/2)&&(s=i.indexData.schedules.length-Math.round(i.indexData.courses.length/(i.settings.maxHours/2))),l=i.indexData.schedules.length-1;l>=0;l--)if(!o[i.indexData.schedules[l]].cRef.length&&6===o[i.indexData.schedules[l]].dayOff){if(--s<=0)break;delete o[i.indexData.schedules[l]],i.indexData.schedules.splice(l,1)}d.push(i),d.push(n),d.push(o),d.push(r),d.push(c),ua("Schedules_","json",JSON.stringify(d))}function ga(e){var n,a,r;if(e.length&&t.hasOwnProperty("indexData")&&t.indexData.hasOwnProperty("depts"))for(r=0;r<e.length;r++)!0!==Gn(a=e[r])&&t.indexData.depts.push({shortcode:a,description:""})}function va(n){var a,r,s,i,o,c,d;if(!n.hasOwnProperty("settings"))throw new Error("Prop 'settings' is undefined.");if(!n.settings.hasOwnProperty("overrides"))throw new Error("Prop 'overrides' is undefined.");if("day"!==n.settings.deptGrpsSetBy&&"week"!==n.settings.deptGrpsSetBy||(t.settings.deptGrpsSetBy=n.settings.deptGrpsSetBy),n.settings.maxHours<=5*e.uiScheduleNumOfHrsPerDay&&(t.settings.maxHours=n.settings.maxHours),n.settings.maxHrsPerDay<=e.uiScheduleNumOfHrsPerDay&&(t.settings.maxHrsPerDay=n.settings.maxHrsPerDay),2!==n.settings.maxSeqHrs&&3!==n.settings.maxSeqHrs||(t.settings.maxSeqHrs=n.settings.maxSeqHrs),(i=Object.keys(n.settings.overrides)).forEach((function(e){"boolean"==typeof n.settings.overrides[e]&&void 0!==t.settings.overrides[e]&&(t.settings.overrides[e]=n.settings.overrides[e])})),n.settings.hasOwnProperty("deptGrps")&&n.settings.deptGrps.length)for(c=0;c<n.settings.deptGrps.length;c++)if((s=n.settings.deptGrps[c].map((function(e){return I(e)})).filter((function(e){return""!==e}))).length){for(a=-1,d=0;d<t.settings.deptGrps.length;d++)if(s.identical(t.settings.deptGrps[d])){a=1;break}1!==a&&(ga(s),t.settings.deptGrps.push(s))}if(n.hasOwnProperty("teachers")&&n.teachers.length)for(c=0;c<n.teachers.length;c++){if(!n.teachers[c].hasOwnProperty("en"))throw new Error("Prop 'en' is undefined.");n.teachers[c].en=O(n.teachers[c].en),""!==(r=n.teachers[c]).en&&(!1!==Hn(r.en)?t.teachers[a].kor=r.kor||t.teachers[a].kor:t.teachers.push(r))}if(n.hasOwnProperty("indexData")){if(n.indexData.hasOwnProperty("klinics")&&n.indexData.klinics.length)for(c=0;c<n.indexData.klinics.length;c++){if(!n.indexData.klinics[c].hasOwnProperty("name"))throw new Error("Prop 'name' is undefined.");if(!n.indexData.klinics[c].hasOwnProperty("fullname"))throw new Error("Prop 'fullname' is undefined.");if(!n.indexData.klinics[c].hasOwnProperty("dept"))throw new Error("Prop 'dept' is undefined.");if(!n.indexData.klinics[c].hasOwnProperty("rm"))throw new Error("Prop 'rm' is undefined.");if(!n.indexData.klinics[c].rm.hasOwnProperty("a"))throw new Error("Prop 'rm.a' is undefined.");if(n.indexData.klinics[c].dept=I(n.indexData.klinics[c].dept),n.indexData.klinics[c].rm.a=H(L(n.indexData.klinics[c].rm.a)),""===n.indexData.klinics[c].dept)throw new Error("Value of 'dept' is an empty string.");if(""===n.indexData.klinics[c].rm.a)throw new Error("Value of 'rm.a' is an empty string.");r=n.indexData.klinics[c],-1===(a=t.indexData.klinics.map((function(e){return e.name})).indexOf(r.name))?(n.indexData.hasOwnProperty("depts")&&!1===Gn(n.indexData.klinics[c].dept)&&n.indexData.depts.push(n.indexData.klinics[c].dept),t.indexData.klinics.push(r)):(t.indexData.klinics[a].fullname=r.fullname,t.indexData.klinics[a].dept=r.dept,t.indexData.klinics[a].rm={},t.indexData.klinics[a].rm.a=r.rm.a)}if(n.indexData.hasOwnProperty("depts")&&n.indexData.depts.length)for(c=0;c<n.indexData.depts.length;c++){if(!n.indexData.depts[c].hasOwnProperty("shortcode"))throw new Error("Prop 'shortcode' is undefined.");n.indexData.depts[c].shortcode=I(n.indexData.depts[c].shortcode),""!==(r=n.indexData.depts[c]).shortcode&&(!1!==Gn(r.shortcode)?t.indexData.depts[a].description=r.description||t.indexData.depts[a].description:t.indexData.depts.push(r))}}}function ya(t,n){var a=["Please choose a "+e.courseNameNumLength+" digit course name greater than zero.","A course named : "+n+" already exists.\nPlease choose a different name.","Please define all parameters.","Classes cannot have overlapping times!","Both classes cannot start at the same time!"];window.mscAlert({title:"",subtitle:a[t]})}function xa(){var a=ge(),r=me(a),s=fe(a),i="c1",o=t.indexData.courses.length,c;if(o&&(i="c"+(Number(t.indexData.courses[o-1].substring(1))+1)),r.newName.length!==e.courseNameNumLength||Number(r.newName)<1||Number.isNaN(Number(r.newName)))return ya(0),"nada";for(c=0;c<o;c++)if(n[t.indexData.courses[c]].name===r.newName)return ya(1,r.newName),"nada";if(""===r.newName||""===r.newCat||""===r.newDept||""===r.newRm.a)return ya(2),"nada";if("ninety"===a&&s[0][0][0]===s[0][1][0])if(s[0][0][1]+1===s[0][1][1]){if(!0!==s[1][0]||!0===s[1][0]&&!1!==s[1][1])return ya(3),"nada"}else if(s[0][0][1]===s[0][1][1]+1&&(!0!==s[1][1]||!0===s[1][1]&&!1!==s[1][0]))return ya(3),"nada";if(s[0][0].identical(s[0][1]))return ya(4),"nada";for(t.indexData.courses.push(i),n[i]={},n[i].cat=r.newCat,n[i].dept=r.newDept,n[i].rm={},n[i].rm.a=r.newRm.a,r.newRm.hasOwnProperty("b")&&(n[i].rm.b=r.newRm.b),n[i].dayhr=s[0],n[i].name=r.newName,n[i].times=r.newTimes,n[i].duration=a,n[i].assgn="",s[1].length&&(n[i].allowFollow=s[1]),c=0;c<t.catData.length;c++)if(t.catData[c][0]===n[i].cat){t.catData[c][1]+=1,t.catData[c][2][n[i].dayhr[0][0]][n[i].dayhr[0][1]]+=1,t.catData[c][2][n[i].dayhr[1][0]][n[i].dayhr[1][1]]+=1,"threehour"===n[i].duration&&(t.catData[c][2][n[i].dayhr[0][0]][n[i].dayhr[0][1]+1]+=1);break}return i}function wa(e,a){var r;for(t.indexData.courses.push(e),n[e]={},n[e].cat=a.cat,n[e].dept=a.dept,n[e].rm={},n[e].rm.a=a.rm.a,a.rm.hasOwnProperty("b")&&(n[e].rm.b=a.rm.b),n[e].dayhr=a.dayhr,n[e].name=a.name,n[e].times=a.times,n[e].duration=a.duration,n[e].assgn="",a.hasOwnProperty("allowFollow")&&(n[e].allowFollow=a.allowFollow),r=0;r<t.catData.length;r++)if(t.catData[r][0]===n[e].cat){t.catData[r][1]+=1,t.catData[r][2][n[e].dayhr[0][0]][n[e].dayhr[0][1]]+=1,t.catData[r][2][n[e].dayhr[1][0]][n[e].dayhr[1][1]]+=1,"threehour"===n[e].duration&&(t.catData[r][2][n[e].dayhr[0][0]][n[e].dayhr[0][1]+1]+=1);break}}function ba(e){var r=0,s,i,c,d,l,u,h;if(Wn(),!0===e)for(u=t.overwriteCourses.length-1;u>=0;u--)for(h=t.indexData.courses.length-1;u>=0;h--)if(i=t.overwriteCourses[u],c=n[t.indexData.courses[h]],i.name===c.name){i.cat!==c.cat&&(t.newCourses.push(i),t.overwriteCourses.splice(u,1),xe(t.indexData.courses[h]));break}if(t.indexData.courses.length&&(r=Number(t.indexData.courses[t.indexData.courses.length-1].substring(1))),t.newCourses.length)for(u=0;u<t.newCourses.length;u++)_t((c=t.newCourses[u]).cat)||he(!1,c.cat),wa(s="c"+ ++r,c);if(sa(),!0===e)for(u=0;u<t.overwriteCourses.length;u++)d=p((i=t.overwriteCourses[u]).name,n),""!==(l=""+(c=n[d]).assgn)&&Fe(l,d),c.dept=i.dept,c.rm={},c.rm.a=i.rm.a,i.rm.hasOwnProperty("b")&&(c.rm.b=i.rm.b),c.dayhr=i.dayhr,c.times=i.times,c.duration=i.duration,i.hasOwnProperty("allowFollow")&&(c.allowFollow=i.allowFollow),""!==l&&(ie(l,d),Z(l,d)||(as(l,d,"on"),ts(l),We(l,d)));o(a)?(t.indexData.schedules=[],ot(!0)):ot(!1),ve(),Ra(),Ye(!0),fs()}function Da(e){var a,r,s;for(s=0;s<t.indexData.courses.length;s++)a=t.indexData.courses[s],"CLINIC"===(r=n[a]).cat&&r.name===e.name&&(r.fullname=e.fullname,r.dept=e.dept,r.rm={},r.rm.a=e.rm.a,nr(a))}function Ca(e){var t=["Each nickname can contain only English or Korean characters.","Please complete each full name with an appropriate description.","Please select the department.","Please check that each nickname is unique","Please check that each definition is unique."];window.mscAlert({title:"",subtitle:t[e]})}function Na(){var e=s("klinic-section").childNodes,a=[],r=[],i,o,c,d,l,u,p;for(u=0;u<e.length;u++)1==(o=e[u]).nodeType&&((i={}).name=T(O(o.childNodes[0].value)),i.fullname=L(o.childNodes[1].value),i.dept=o.childNodes[2].value,i.rm={},i.rm.a=A(o.childNodes[3].value),a.push(i));if(a.length){for(c=[],d=[],u=a.length-1;u>=0;u--)if(""===a[u].name&&""===a[u].fullname)a.splice(u,1);else{if(""===a[u].name)return void Ca(0);if(""===a[u].fullname)return void Ca(1);if(""===a[u].dept)return void Ca(2);c.push(a[u].name),d.push(""+a[u].fullname+a[u].dept+a[u].rm.a)}if(!0===Xn(c,!1))return void Ca(3);if(!0===Xn(d,!0))return void Ca(4)}for(a.length>1&&a.sort((function(e,t){return e.name.localeCompare(t.name)})),u=0;u<t.indexData.klinics.length;u++)-1===(l=a.map((function(e){return e.name})).indexOf(t.indexData.klinics[u].name))?r.push(t.indexData.klinics[u].name):Da(a[l]);if(r.length)for(u=r.length-1;u>=0;u--)for(p=t.indexData.courses.length-1;p>=0;p--)i=t.indexData.courses[p],"CLINIC"===n[i].cat&&n[i].name===r[u]&&xe(i);for(t.indexData.klinics=[],u=0;u<a.length;u++)t.indexData.klinics.push(a[u]);Yn()}function ka(e,a){var r=Gr(e),s="c1",i,o,s,c,d,l,u;if(4===r.length&&0===r[1]&&(i=[],o=[r[2],r[3]],i.push(o,o),t.indexData.courses.length&&(s="c"+(Number(t.indexData.courses[t.indexData.courses.length-1].substring(1))+1)),c=t.indexData.klinics.map((function(e){return e.name})).indexOf(a),t.indexData.klinics.length&&-1!==c)){for(l=t.indexData.klinics[c],t.indexData.courses.push(s),n[s]={},n[s].cat="CLINIC",n[s].dept=l.dept,n[s].rm={},n[s].rm.a=l.rm.a,n[s].dayhr=i,n[s].name=l.name,n[s].fullname=l.fullname,n[s].times=ta(o),n[s].duration="klinichour",n[s].assgn="",u=0;u<t.catData.length;u++)if(t.catData[u][0]===n[s].cat){t.catData[u][1]+=1,t.catData[u][2][n[s].dayhr[0][0]][n[s].dayhr[0][1]]+=1;break}return!1===t.tempKlinic.isHeld&&(t.tempKlinic.kbtn=""),[r[0],s]}}function Ea(){var e=[],r=[],s=0,i=Object.keys(n),o,c,l;for(l=0;l<i.length;l++)"CLINIC"===(o=n[i[l]]).cat?(s+=1,(c={}).name=o.name,c.fullname=o.name,c.dept=o.dept,c.rm={},c.rm.a=o.rm.a,r.push(c)):e.push(o.name);return e.sort(),e=d(e),i.length-s!==e.length?(t={},n={},a={},Ra(),window.mscAlert({title:"",subtitle:"Please check that each course has a unique name (ID).\nSome new course names are duplicates."}),!1):!(r.length&&s>0)||(r.sort((function(e,t){return e.name.localeCompare(t.name)})),r=u(r,"name"))}function Sa(e,t){var a=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),c=document.createElement("div"),d=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),p=document.createElement("span"),h=n[e].name+" - "+n[e].dept+n[e].rm.a,m;n[e].rm.hasOwnProperty("b")&&(h+="/"+n[e].dept+n[e].rm.b),h+=" - "+n[e].times,"ninety"===n[e].duration&&(h+=" - (90분)"),m=document.createTextNode(h),r.id="contain"+e,r.className="row",i.className="col-lg-12",o.id="ref"+e,o.className="whitecircle",c.id="edredit-"+e,c.className="nodisplay",d.id="edrinit-"+e,d.className="btn-xs btn-warning pull-left nodisplay",d.textContent="Edit",l.id="edrsave-"+e,l.className="btn-xs btn-primary pull-left nodisplay",l.textContent="Save",u.id="sSgn"+e,u.className="sSgnd",p.id="edrdel-"+e,p.className="btn btn-xs btn-danger pull-right nodisplay",p.textContent="✖","CLINIC"===n[e].cat&&(c.className+=" disabled",d.className+=" disabled",l.className+=" disabled",p.className+=" disabled"),o.appendChild(m),o.appendChild(u),i.appendChild(d),i.appendChild(l),i.appendChild(o),i.appendChild(c),i.appendChild(p),r.appendChild(i),a.appendChild(r),s("courselist"+t).appendChild(a),ds()}function La(e){var t={};return t.name=s("edrname-"+e).value,t.dept=s("edrdept-"+e).value,t.rmA=s("edrrm-"+e).value,t.rmB=null!==s("edrrmB-"+e)?s("edrrmB-"+e).value:"",t.timeDay1=""+s("edrday1-"+e).value+s("edrstart1-"+e).value,t.timeDay2=""+s("edrday2-"+e).value+s("edrstart2-"+e).value,t.idxDay1=s("edrday1-"+e).selectedIndex,t.idxStart1=s("edrstart1-"+e).selectedIndex,t.idxDay2=s("edrday2-"+e).selectedIndex,t.idxStart2=s("edrstart2-"+e).selectedIndex,t}function Ia(t){var n=["A course with that name already exists!","Please choose a "+e.courseNameNumLength+" digit course name greater than zero.","Both classes cannot start at the same time!","Please define all parameters with appropriate values"];window.mscAlert({title:"",subtitle:n[t]})}function Oa(t){var a=La(t),r=n[t],s="",i;"CLINIC"!==r.cat&&(a.name=G(a.name),i=y(a.name),a.rmA=L(a.rmA),a.rmB=L(a.rmB),void 0===i||i===t?a.name.length!==e.courseNameNumLength||Number(a.name)<1||Number.isNaN(Number(a.name))?Ia(1):Ve(t)?Ia(2):""!==a.rmA&&""!==a.name?(""!==r.assgn&&Fe(s=""+r.assgn,t),ps(t),Pa(t,a)&&(tr(t),ze(s,t))):Ia(3):Ia(0))}function Pa(e,a){var r=n[e],s,i,o,c;if("CLINIC"!==r.cat){for(c=0;c<t.catData.length;c++)if(t.catData[c][0]===r.cat){o=c;break}return r.name=a.name,r.dept=a.dept,r.rm.a=a.rmA,r.rm.hasOwnProperty("b")&&delete r.rm.b,""!==a.rmB&&a.rmB!==r.rm.a&&(r.rm.b=a.rmB),s=a.timeDay1,"twohour"!==r.duration&&"threehour"!==r.duration&&(s+=","+a.timeDay2),"threehour"===r.duration&&(s+="-"+(a.idxStart1+11)+":50"),"twohour"===r.duration&&(s+="-"+(a.idxStart1+10)+":50"),r.times=s,(i=[[],[]])[0].push(r.dayhr[0][0]),i[0].push(r.dayhr[0][1]),i[1].push(r.dayhr[1][0]),i[1].push(r.dayhr[1][1]),t.catData[o][2][i[0][0]][i[0][1]]-=1,t.catData[o][2][i[1][0]][i[1][1]]-=1,"threehour"===r.duration&&(t.catData[o][2][i[0][0]][i[0][1]+1]-=1),r.dayhr[0][0]=a.idxDay1,"ninety"===r.duration?(r.dayhr[1][0]=a.idxDay2,a.idxStart1%2==1?(r.dayhr[0][1]=(a.idxStart1-1)/2,r.allowFollow[0]=!1):(r.dayhr[0][1]=a.idxStart1/2,r.allowFollow[0]=!0),a.idxStart2%2==1?(r.dayhr[1][1]=(a.idxStart2-1)/2,r.allowFollow[1]=!1):(r.dayhr[1][1]=a.idxStart2/2,r.allowFollow[1]=!0)):(r.dayhr[0][1]=a.idxStart1,"twohour"===r.duration||"threehour"===r.duration?(r.dayhr[1][0]=a.idxDay1,"twohour"===r.duration&&(r.dayhr[1][1]=a.idxStart1+1),"threehour"===r.duration&&(r.dayhr[1][1]=a.idxStart1+2)):(r.dayhr[1][0]=a.idxDay2,r.dayhr[1][1]=a.idxStart2)),t.catData[o][2][r.dayhr[0][0]][r.dayhr[0][1]]+=1,t.catData[o][2][r.dayhr[1][0]][r.dayhr[1][1]]+=1,"threehour"===r.duration&&(t.catData[o][2][r.dayhr[0][0]][r.dayhr[0][1]+1]+=1),!0}}function Ha(e){var t={},n=e.split(/[^(0-9)]/g).filter((function(e){return""!==e}));return t.a=n[0]+":"+n[1]+"-"+(Number(n[0])+1)+":"+(Number(n[1])+15),t.b=n[2]+":"+n[3]+"-"+(Number(n[2])+1)+":"+(Number(n[3])+15),t}function Ta(){var r={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},s=t.indexData.schedules.length,i,o,c,d,l,u,p,h,m,f,g,v,y,x,w,b;for(x=0;x<s;x++)if(m=t.indexData.schedules[x],(f=a[m]).cRef.length){for(v=Ke(m).split(", "),(c={text:[]}).text.push(f.display+" - "),w=0;w<v.length;w++)c.text.push(zt(v,v[w]));for(c.text.push("\n"),d=q(""),(i={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),i.table.body.push([e.pdfBlankHr,"","","","",""]),w=0;w<d[0].length;w++)y="\n"+(e.uiTimeInputStartHr+w)+":00-"+(e.uiTimeInputStartHr+w)+":50",y+="\n("+(w+1)+")",i.table.body.push([y]);for(o={pageBreak:"after",text:[]},w=0;w<f.cRef.length;w++)l=""+(g=n[a[m].cRef[w]]).name,u=""+g.name,p=zt(v,g.cat),"CLINIC"===g.cat&&(u=""+g.fullname),u+="\n"+g.cat+"\n"+g.dept+g.rm.a,l+="\n"+g.cat+"\n"+g.dept,g.rm.hasOwnProperty("b")?l+=""+g.rm.b:l+=""+g.rm.a,g.hasOwnProperty("allowFollow")&&(u+="\n("+(h=Ha(g.times)).a+")",l+="\n("+h.b+")"),d[g.dayhr[0][0]][g.dayhr[0][1]]={text:u,color:p.color},g.rm.hasOwnProperty("b")?d[g.dayhr[1][0]][g.dayhr[1][1]]={text:l,color:p.color}:d[g.dayhr[1][0]][g.dayhr[1][1]]={text:u,color:p.color},"threehour"===g.duration&&(d[g.dayhr[0][0]][g.dayhr[0][1]+1]={text:u,color:p.color});for(f.hasOwnProperty("tchr")&&""!==f.tchr&&c.text.push("Instructor: "+f.tchr),c.text.push("\n\n"),f.hasOwnProperty("isSat")?(i.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],i.table.body[0].push("Saturday"),i.table.body[1].push("")):i.table.widths=["15%","17%","17%","17%","17%","17%"],w=2;w<i.table.body.length;w++)for(b=0;b<i.table.widths.length-1;b++)i.table.body[w].push(d[b][w-2]);o.text=Jn(m),r.content.push(c),r.content.push(i),r.content.push(o)}return JSON.stringify(r)}function Aa(){var t=Yt(),n={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},a=t.length,r,s,i,o,c,d,l,u,p;for(l=0;l<a;l++)if(t[l].inst.length){var h=t[l].inst[0].fullname,m=Mn(t[l].inst[0].dept);for(""===h&&(h=t[l].def),r={text:h+" clinic - "+t[l].inst[0].rm.a+" "+m+"\n\n"},s={style:"default",table:{widths:[],body:[]}},i=q(""),(s={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),s.table.body.push([e.pdfBlankHr,"","","","",""]),u=0;u<i[0].length;u++)c="\n"+(e.uiTimeInputStartHr+u)+":00-"+(e.uiTimeInputStartHr+u)+":50",c+="\n("+(u+1)+")",s.table.body.push([c]);for(o={pageBreak:"after",text:[]},u=0;u<t[l].inst.length;u++)(d={text:"\n"}).text+=""+t[l].inst[u].tchr,"unassigned"===t[l].inst[u].tchr&&(d.color=e.pdfCourseColors[2]),i[t[l].inst[u].dayhr[0][0]][t[l].inst[u].dayhr[0][1]].hasOwnProperty("text")&&(d.color=e.pdfCourseColors[1],d.text+=i[t[l].inst[u].dayhr[0][0]][t[l].inst[u].dayhr[0][1]].text),i[t[l].inst[u].dayhr[0][0]][t[l].inst[u].dayhr[0][1]]=d;for(t[l].inst.hasOwnProperty("isSat")?(s.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],s.table.body[0].push("Saturday"),s.table.body[1].push("")):s.table.widths=["15%","17%","17%","17%","17%","17%"],u=2;u<s.table.body.length;u++)for(p=0;p<s.table.widths.length-1;p++)s.table.body[u].push(i[p][u-2]);n.content.push(r),n.content.push(s),n.content.push(o)}return JSON.stringify(n)}function Ra(){var e=document.createDocumentFragment(),t=document.createDocumentFragment(),n=document.createElement("option"),a=document.createElement("option");c(s("schedule-instances")),c(s("references")),c(s("newcoursecat")),c(s("newcoursedept")),n.textContent="select",n.value="",a.textContent="select",a.value="",e.appendChild(n),t.appendChild(a),s("newcoursecat").appendChild(e),s("newcoursedept").appendChild(t),s("newcoursecat").options[0].disabled=!0,s("newcoursedept").options[0].disabled=!0}function Fa(){var e=t.catData.length,a,r,i;if(e){if("nada"!==(r=xa())){for(s("newcoursename").value="",s("newcourseroom").value="",s("newcourseroomB").value="",s("newcoursecat").selectedIndex=0,s("newcoursedept").selectedIndex=0,s("newdayone").selectedIndex=0,s("newhrsone").selectedIndex=0,s("newdaytwo").selectedIndex=0,s("newhrstwo").selectedIndex=0,i=0;i<e;i++)if(t.catData[i][0]===n[r].cat){a=i+1;break}Sa(r,a),window.mscConfirm({title:"Success!",subtitle:"Course: "+n[r].name+" has been created.\nCreate another?",cancelText:"Exit",onOk:function(){},onCancel:function(){fs(),is(r)}})}}else window.mscAlert({title:"",subtitle:"At least one category must be defined before a course can be created."})}function Ga(){var t={arr:[],lastEl:""},n=e.uiScheduleNumOfHrsPerDay-1,a=":00",r=":30",s,i;for(i=0;i<n;i++)s=("0"+(e.uiTimeInputStartHr+i)).slice(-2),t.arr.push(""+s+a),t.arr.push(""+s+r);return t.lastEl+=e.uiTimeInputStartHr+(e.uiScheduleNumOfHrsPerDay-1)+a,t}function Ba(e){var t=Ga(),n=t.arr,a=n.length,r=document.createDocumentFragment(),i=document.createDocumentFragment(),o,d,l,u,p,h,m,f;if(c(s("newhrsone")),c(s("newhrstwo")),"ninety"===e)for(f=0;f<a;f++)m=n[f],o=document.createElement("option"),d=document.createElement("option"),o.value=m,o.textContent=m,d.value=m,d.textContent=m,r.appendChild(o),i.appendChild(d);else{for(f=0;f<a;f+=2)m=n[f],l=document.createElement("option"),u=document.createElement("option"),l.value=m,l.textContent=m,u.value=m,u.textContent=m,r.appendChild(l),i.appendChild(u);"threehour"===e&&r.removeChild(r.lastChild),"onehour"===e&&(p=document.createElement("option"),h=document.createElement("option"),p.value=t.lastEl,p.textContent=t.lastEl,h.value=t.lastEl,h.textContent=t.lastEl,r.appendChild(p),i.appendChild(h))}s("newhrsone").appendChild(r),s("newhrstwo").appendChild(i)}function Ka(e){var t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span");c(s("catcontain"+e)),c(s("catref"+e)),c(s("courselist"+e)),n.id="catedt"+e,n.className="catedt btn-xs btn-warning pull-left nodisplay",n.textContent="Edit",n.style.display="none",a.id="bldr"+e,a.className="autobuilder pull-right icon-flash nodisplay",a.style.display="none",r.id="recycle"+e,r.className="pull-right recycler icon-recycle",r.style.display="none",t.appendChild(n),t.appendChild(a),t.appendChild(r),s("catref"+e).appendChild(t),s("list"+e).style.display="none",s("catcontain"+e).style.display="none",s("catref"+e).style.display="none",s("courselist"+e).style.display="none"}function qa(n,r){var i=q(0),o=e.monToSatEn.slice(),c="p16c",d=document.createDocumentFragment(),l=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),y=document.createElement("span"),x=document.createElement("span"),w=document.createElement("span"),b=document.createElement("span"),D=document.createElement("span"),C=document.createElement("select"),N=document.createElement("option"),k,E;for("Sat"!==r&&(i.pop(),o.pop(),c="p20c"),l.id=""+n,l.className="col-lg-3 col-md-3 col-sm-3 col-xs-3 bordered",u.className="row text-center",u.style.paddingLeft="43px",u.textContent=a[n].display,y.id="del"+n,y.className="btn btn-xs btn-danger pull-right",y.textContent="✖",x.id="reset"+n,x.className="btn btn-xs icon-recycle pull-right",p.className="row text-center",h.id="tchrsee"+n,h.className="tchrsee nodisplay",w.id="tchrclr"+n,w.className="btn-xs btn-warning pull-left",w.textContent="Clear",b.id="tchrset"+n,b.className="btn-xs btn-whiteBlue tchrset",b.textContent="unassigned",m.id="tchrchg"+n,m.className="tchrchg nodisplay",D.id="tchrsve"+n,D.className="btn btn-xs btn-primary pull-left",D.textContent="Save",C.id="tchredt"+n,C.className="select-styles tchredt",N.value="",N.textContent="select teacher",f.id="catlist"+n,f.className="row text-center cat-list",g.className="row text-center dayofweek "+c,v.className="row text-center "+c,u.appendChild(y),u.appendChild(x),h.appendChild(w),h.appendChild(b),C.appendChild(N),m.appendChild(D),m.appendChild(C),p.appendChild(h),p.appendChild(m),k=0;k<o.length;k++){var S=document.createElement("div");S.textContent=o[k],g.appendChild(S)}for(l.appendChild(u),l.appendChild(p),l.appendChild(f),l.appendChild(g),k=0;k<i[0].length;k++){var L=document.createElement("div");for(L.className="row text-center "+c,E=0;E<i.length;E++){var I=document.createElement("div");I.id=n+"c0d"+[E]+"t"+[k],I.textContent="0",L.appendChild(I)}l.appendChild(L)}for(k=0;k<o.length;k++){var O=document.createElement("div");O.id="off"+[k]+n,O.className="dayoff",O.textContent="▲",v.appendChild(O)}l.appendChild(v),d.appendChild(l),s("schedule-instances").appendChild(d),s("tchredt"+n).options[0].disabled=!0,t.indexData.schedules.length&&s(t.indexData.schedules[0]).classList.contains("show-teacher")&&(sr("tchrsee"+n),ir(n),Ln(n))}function _a(e){var n=document.createDocumentFragment(),a=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div"),c=document.createElement("span"),d=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),p=document.createElement("span"),h=document.createElement("input"),m=t.catData[e-1][0],f=document.createTextNode(m);a.id="list"+e,a.className=ns(m,!0)+"courselist",r.id="catcontain"+e,r.className="nodisplay",i.id="catref"+e,o.id="courselist"+e,o.className="hide",c.id="catsve"+e,c.className="btn btn-xs btn-primary pull-left",c.textContent="Rename",h.type="text",h.id="catchg"+e,h.className="inputstyle btn-xs","CLINIC"===m&&(h.className+=" disabled",c.textContent="Delete only"),h.value=m,d.id="catdel"+e,d.className="btn btn-xs btn-danger pull-right",d.textContent="✖",l.id="catedt"+e,l.className="catedt btn-xs btn-warning pull-left nodisplay",l.textContent="Edit",u.id="bldr"+e,u.className="autobuilder pull-right icon-flash nodisplay",p.id="recycle"+e,p.className="pull-right recycler icon-recycle",r.appendChild(c),r.appendChild(h),r.appendChild(d),i.appendChild(l),i.appendChild(f),i.appendChild(u),i.appendChild(p),a.appendChild(r),a.appendChild(i),n.appendChild(a),n.appendChild(o),s("references").appendChild(n)}function Ja(){var e=document.createDocumentFragment(),n=document.createElement("option"),a,r,i;for(c(s("newcoursecat")),n.value="",n.textContent="select",e.appendChild(n),i=0;i<t.catData.length;i++)"CLINIC"!==(r=t.catData[i][0])&&"$deleted"!==r.substring(0,8)&&((a=document.createElement("option")).value=""+r,a.textContent=r,e.appendChild(a));s("newcoursecat").appendChild(e),s("newcoursecat").options[0].disabled=!0,s("newcoursecat").options[0].selected=!0}function Ma(){var e=document.createDocumentFragment(),n=document.createElement("option"),a,r;for(c(s("newcoursedept")),n.value="",n.textContent="select",e.appendChild(n),r=0;r<t.indexData.depts.length;r++)(a=document.createElement("option")).value=""+t.indexData.depts[r].shortcode,a.textContent=a.value,e.appendChild(a);s("newcoursedept").appendChild(e),s("newcoursedept").options[0].disabled=!0,s("newcoursedept").options[0].selected=!0}function ja(t){var a=document.createDocumentFragment(),r=document.createElement("span"),i=document.createElement("input"),o=document.createTextNode(" -> ");r.textContent=n[t].name,r.style.paddingLeft="60px",i.id="newName-"+t,i.type="number",i.className="btn-xs",i.style.width="60px",i.style.verticalAlign="middle",i.style.padding="2px",i.value="",i.maxLength=e.courseNameNumLength,i.minLength=e.courseNameNumLength,i.min=Math.pow(10,e.courseNameNumLength-1).toString().split("").reverse().join(""),i.max=""+(Math.pow(10,e.courseNameNumLength)-1),a.appendChild(r),a.appendChild(o),a.appendChild(i),s("edredit-"+t).appendChild(a)}function Wa(){var e=document.createDocumentFragment(),n,a;for(c(s("alldepartments")),a=0;a<t.indexData.depts.length;a++)(n=document.createElement("span")).id="opt"+[a+1],n.dataset.deptname=""+t.indexData.depts[a].shortcode,n.className="btn btn-xs btn-dept",n.textContent=t.indexData.depts[a].shortcode,e.appendChild(n);s("alldepartments").appendChild(e)}function $a(){var e=s("klinic-section").childNodes.length,n=document.createDocumentFragment(),a=document.createElement("div"),r=document.createElement("input"),i=document.createElement("input"),o=document.createElement("select"),c=document.createElement("input"),d=document.createElement("span"),l=document.createElement("option"),u,p;for(d.id="kldel_"+e,d.className="btn btn-xs btn-danger deletex pull-right",d.textContent="✖",a.id="kl_"+e,r.id="klnm_"+e,r.type="text",r.className="btn-xs",r.style.width="90px",r.style.verticalAlign="middle",r.style.padding="2px",r.value="",r.maxLength=8,r.placeholder="nickname",i.id="klfn_"+e,i.type="text",i.className="inputStyle",i.style.width="160px",i.style.verticalAlign="middle",i.style.padding="2px",i.value="",i.maxLength=32,i.placeholder="full .pdf name",o.id="kldp_"+e,o.className="select-styles",o.style.marginRight="1px",c.id="klrm_"+e,c.type="text",c.className="inputStyle",c.style.width="80px",c.style.verticalAlign="middle",c.style.padding="2px",c.value="",c.maxLength=8,c.placeholder="room",l.value="",l.textContent="dept",o.appendChild(l),p=0;p<t.indexData.depts.length;p++)(u=document.createElement("option")).value=""+t.indexData.depts[p].shortcode,u.textContent=u.value,o.appendChild(u);a.appendChild(r),a.appendChild(i),a.appendChild(o),a.appendChild(c),a.appendChild(d),n.appendChild(a),s("klinic-section").appendChild(n),s("kldp_"+e).options[0].disabled=!0}function Va(){var e,n,a,r;if(c(s("klinicscontainer")),t.tempKlinic.kbtn="",t.indexData.klinics.length){for(e=document.createDocumentFragment(),na(),r=0;r<t.indexData.klinics.length;r++)n=document.createElement("span"),a=t.indexData.klinics[r].name,n.id="kbtn_"+a,n.className="btn btn-xs btn-whiteBlue",n.textContent=a,n.style.marginRight="5px",e.appendChild(n);s("klinicscontainer").appendChild(e),sr("klinicHolder"),sr("klinicscontainer")}else rr("klinicHolder")}function za(){var e=document.createDocumentFragment(),n,a,r,i,o;for(c(s("allgroups")),i=0;i<t.settings.deptGrps.length;i++){for(n=document.createElement("div"),(a=document.createElement("span")).id="remove"+i,a.className="btn btn-xs btn-danger",a.textContent="delete",n.textContent="(",r=t.settings.deptGrps[i],o=0;o<r.length-1;o++)n.textContent+=r[o]+", ";n.textContent+=r[r.length-1]+") ",n.appendChild(a),e.appendChild(n)}s("allgroups").appendChild(e)}function Ua(){var e=document.createDocumentFragment(),n,a,r,i,o;for(c(s("deptEDIT")),o=0;o<t.indexData.depts.length;o++)n=document.createElement("div"),a=document.createElement("input"),r=document.createElement("input"),i=document.createElement("span"),n.id="dpts"+[o],a.type="text",a.id="deptnm"+[o],a.className="inputstylenarrow disabled",a.value=t.indexData.depts[o].shortcode,a.maxLength=8,a.placeholder="shortcode",r.type="text",r.id="ddesc"+[o],r.className="inputstyle",r.value=t.indexData.depts[o].description,r.maxLength=32,r.placeholder="description",i.id="deptdel"+[o],i.className="btn btn-xs btn-danger deletex pull-right",i.textContent="✖",n.appendChild(a),n.appendChild(r),n.appendChild(i),e.appendChild(n);s("deptEDIT").appendChild(e)}function Ya(e,t){var n=s("deptEDIT").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("input"),o=document.createElement("input"),c=document.createElement("span");r.id="dpts"+n,i.type="text",i.id="deptnm"+n,i.className="inputstylenarrow",i.value=e,i.maxLength=8,i.placeholder="shortcode",o.type="text",o.id="ddesc"+n,o.className="inputstyle",o.value=t,o.maxLength=32,o.placeholder="description",c.id="deptdel"+n,c.className="btn btn-xs btn-danger deletex",c.textContent="✖",r.appendChild(i),r.appendChild(o),r.appendChild(c),a.appendChild(r),s("deptEDIT").appendChild(a)}function Za(){var e=Number(s("newgroupid").dataset.grpindex),n=t.settings.deptGrps[e],a=s("alldepartments").childNodes,r,i,o,c;if(n&&n.length){for(r=document.createDocumentFragment(),i=document.createElement("div"),(o=document.createElement("span")).id="remove"+e,o.className="btn btn-xs btn-danger",o.textContent="delete",i.textContent="(",c=0;c<n.length-1;c++)i.textContent+=n[c]+", ";i.textContent+=n[n.length-1]+") ",i.appendChild(o),r.appendChild(i),s("allgroups").appendChild(r),s("newgroupid").dataset.grpindex=t.settings.deptGrps.length}for(c=0;c<a.length;c++)1==a[c].nodeType&&(a[c].style.backgroundColor="",a[c].style.color="",a[c].style.borderColor="")}function Xa(){var e=document.createDocumentFragment(),n,a,r,i,o;for(c(s("alltchrs")),o=0;o<t.teachers.length;o++)n=document.createElement("div"),a=document.createElement("input"),r=document.createElement("input"),i=document.createElement("span"),n.id="prsn"+[o],a.type="text",a.id="prsnnm"+[o],a.className="inputstyle",a.value=t.teachers[o].en,a.maxLength=32,r.type="text",r.id="prsnKR"+[o],r.className="inputstyle",r.value=t.teachers[o].kor,r.maxLength=32,r.placeholder="csv name",i.id="prsndel"+[o],i.className="btn btn-xs btn-danger deletex pull-right",i.textContent="✖",n.appendChild(a),n.appendChild(r),n.appendChild(i),e.appendChild(n);s("alltchrs").appendChild(e)}function Qa(e,t){var n=s("alltchrs").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("input"),o=document.createElement("input"),c=document.createElement("span");r.id="prsn"+n,i.type="text",i.id="prsnnm"+n,i.className="inputstyle",i.value=e,i.maxLength=32,i.placeholder="new teacher",o.type="text",o.id="prsnKR"+n,o.className="inputstyle",o.value=t,o.maxLength=32,o.placeholder="csv name",c.id="prsndel"+n,c.className="btn btn-xs btn-danger deletex",c.textContent="✖",r.appendChild(i),r.appendChild(o),r.appendChild(c),a.appendChild(r),s("alltchrs").appendChild(a)}function er(){var e,n,a,r,i,o,d,l,u,p,h,m,f,g;if(c(s("klinic-section")),t.indexData.klinics.length){for(e=document.createDocumentFragment(),n=t.indexData.klinics.length,f=0;f<n;f++){for(r=document.createElement("div"),i=document.createElement("input"),o=document.createElement("input"),d=document.createElement("select"),l=document.createElement("input"),u=document.createElement("span"),p=document.createElement("option"),a=t.indexData.klinics[f],u.id="kldel_"+f,u.className="btn btn-xs btn-danger deletex pull-right",u.textContent="✖",r.id="kl_"+f,i.id="klnm_"+f,i.type="text",i.className="btn-xs disabled",i.style.width="90px",i.style.verticalAlign="middle",i.style.padding="2px",i.value=a.name,o.id="klfn_"+f,o.type="text",o.className="inputStyle",o.style.width="160px",o.style.verticalAlign="middle",o.style.padding="2px",o.value=a.fullname,o.maxLength=32,o.placeholder="full .pdf name",d.id="kldp_"+f,d.className="select-styles",d.style.marginRight="1px",l.id="klrm_"+f,l.type="text",l.className="inputStyle",l.style.width="80px",l.style.verticalAlign="middle",l.style.padding="2px",l.value=a.rm.a,l.maxLength=8,l.placeholder="room",p.value="",p.textContent="dept",d.appendChild(p),g=0;g<t.indexData.depts.length;g++)(h=document.createElement("option")).value=t.indexData.depts[g].shortcode,h.textContent=h.value,d.appendChild(h);r.appendChild(i),r.appendChild(o),r.appendChild(d),r.appendChild(l),r.appendChild(u),e.appendChild(r)}for(s("klinic-section").appendChild(e),f=0;f<t.indexData.klinics.length;f++)for((m=s("kldp_"+f)).options[0].disabled=!0,g=1;g<m.options.length;g++)if(t.indexData.klinics[f].dept===m.options[g].value){m.selectedIndex=g;break}}}function tr(e){var t=n[e],a=document.createDocumentFragment(),r=document.createElement("span"),i=t.name+" - "+t.dept+t.rm.a,o="ref"+e,d;t.rm.hasOwnProperty("b")&&(i+="/"+t.dept+t.rm.b),i+=" - "+t.times,c(s(o)),"ninety"===t.duration&&(i+=" - (90분)"),r.id="sSgn"+e,r.className="sSgnd",d=document.createTextNode(i),a.appendChild(d),a.appendChild(r),s(o).appendChild(a)}function nr(e){var t=n[e],a=""+t.assgn+e+"d"+t.dayhr[0][0]+"t"+t.dayhr[0][1],r=document.createDocumentFragment(),i=document.createElement("span"),o="",d;s(a).textContent=t.name+"("+t.dept+")",c(s("ref"+e)),o=t.name+" - "+t.dept+t.rm.a+" - "+t.times,d=document.createTextNode(o),i.id="sSgn"+e,i.className="sSgnd",r.appendChild(d),r.appendChild(i),s("ref"+e).appendChild(r),s("sSgn"+e).textContent=""+t.assgn}function ar(a){var r,i,o,d,l,u,p,h,m,f,g,v,y,x,w,b,D,C,N,k,E,S,L;if("CLINIC"!==n[a].cat){for(i=(r=Ga()).arr,o=e.monToSatKr.slice(),d=document.createDocumentFragment(),l=document.createElement("input"),u=document.createElement("input"),h=document.createElement("select"),m=document.createElement("select"),f=document.createElement("select"),g=document.createElement("select"),v=document.createElement("select"),y=document.createElement("span"),c(s("edredit-"+a)),l.id="edrname-"+a,l.type="number",l.className="btn-xs",l.style.width="60px",l.style.verticalAlign="middle",l.style.padding="2px",l.value=n[a].name,l.maxLength=e.courseNameNumLength,l.minLength=e.courseNameNumLength,l.min=Math.pow(10,e.courseNameNumLength-1).toString().split("").reverse().join(""),l.max=""+(Math.pow(10,e.courseNameNumLength)-1),h.id="edrdept-"+a,h.className="select-styles",h.style.marginRight="1px",u.id="edrrm-"+a,u.type="text",u.className="inputStyle",u.style.width="80px",u.style.verticalAlign="middle",u.style.padding="2px",u.value=n[a].rm.a,"onehour"!==n[a].duration&&"ninety"!==n[a].duration||((p=document.createElement("input")).id="edrrmB-"+a,p.type="text",p.className="inputStyle",p.style.width="80px",p.style.verticalAlign="middle",p.style.padding="2px",p.value=n[a].rm.b||n[a].rm.a),m.id="edrday1-"+a,m.className="select-styles",f.id="edrday2-"+a,f.className="select-styles",g.id="edrstart1-"+a,g.className="select-styles",v.id="edrstart2-"+a,v.className="select-styles",y.id="edrduration-"+a,"ninety"===n[a].duration&&(y.textContent=" 90분(2)"),"twohour"===n[a].duration&&(y.textContent=" 2시간(1)"),"threehour"===n[a].duration&&(y.textContent=" 3시간(1)"),"onehour"===n[a].duration&&(y.textContent=" 1시간(2)"),L=0;L<t.indexData.depts.length;L++)(x=document.createElement("option")).value=t.indexData.depts[L].shortcode,x.textContent=x.value,h.appendChild(x);for(L=0;L<o.length;L++)w=document.createElement("option"),b=document.createElement("option"),w.value=o[L],w.textContent=w.value,b.value=w.value,b.textContent=w.value,m.appendChild(w),f.appendChild(b);if("ninety"===n[a].duration)for(L=0;L<i.length;L++)D=document.createElement("option"),C=document.createElement("option"),D.value=i[L],D.textContent=D.value,C.value=D.value,C.textContent=C.value,g.appendChild(D),v.appendChild(C);else{for(L=0;L<i.length;L+=2)N=document.createElement("option"),k=document.createElement("option"),N.value=i[L],N.textContent=N.value,k.value=N.value,k.textContent=N.value,g.appendChild(N),v.appendChild(k);"threehour"===n[a].duration&&g.removeChild(g.lastChild),"onehour"===n[a].duration&&(E=document.createElement("option"),S=document.createElement("option"),E.value=r.lastEl,E.textContent=r.lastEl,S.value=r.lastEl,S.textContent=r.lastEl,g.appendChild(E),v.appendChild(S))}d.appendChild(l),d.appendChild(h),d.appendChild(u),"onehour"!==n[a].duration&&"ninety"!==n[a].duration||d.appendChild(p),d.appendChild(m),d.appendChild(g),d.appendChild(f),d.appendChild(v),d.appendChild(y),s("edredit-"+a).appendChild(d),$e(a)}}function rr(e){s(e).classList.contains("nodisplay")||(s(e).className+=" nodisplay")}function sr(e){s(e).className=s(e).className.replace(/(?:^|\s)nodisplay(?!\S)/g,"")}function ir(e){s(e).classList.contains("show-teacher")||(s(e).className+=" show-teacher")}function or(e){s(e).className=R(s(e).className,"show-teacher")}function cr(e){var t=s("courselist"+e.substring(6));"hide"!==t.getAttribute("class")?t.setAttribute("class","hide"):t.setAttribute("class","show")}function dr(e){var t=s(e),n=t.classList.contains("btn-warning"),a;!0===t.classList.contains("btn-primary")?Cs(!1,e):!0===n&&Cs(!0,e)}function lr(){dr("updateHdrsA")}function ur(){dr("updateHdrsB")}function pr(){Bt(),w(),Xe(),ms(),rr("setting-section"),sr("displayOverrides"),sr("left"),sr("right")}function hr(){sr("information"),rr("parsing")}function mr(){rr("information"),sr("parsing")}function fr(){sr("information"),rr("displayOverrides"),rr("left"),rr("right")}function gr(){rr("information"),sr("displayOverrides"),sr("left"),sr("right")}function vr(){Ht(),sr("statistics"),rr("displayOverrides"),rr("left"),rr("right")}function yr(){Tt(),rr("statistics"),sr("displayOverrides"),sr("left"),sr("right")}function xr(){rr("displayOverrides"),s("left").style.visibility="hidden",s("right").style.visibility="hidden",Et(),sr("newcoursemodal")}function wr(){Je("MtoF"),s("pagebottom").scrollIntoView({behavior:"smooth"})}function br(){Je("Sat"),s("pagebottom").scrollIntoView({behavior:"smooth"})}function Dr(e,n){if(!0===t.settings.overrides[e])return t.settings.overrides[e]=!1,void(s(n).className=R(s(n).className,"bypass"));t.settings.overrides[e]=!0,s(n).className+=" bypass"}function Cr(){Dr("deptGrps","deptgrpsbyps")}function Nr(){Dr("maxHours","schedhrsbyps")}function kr(){Dr("maxHrsPerDay","dayhrsbyps")}function Er(){Dr("maxSeqHrs","seqhrsbyps")}function Sr(e){s("select-styleF").style.visibility=e,s("select-styleG").style.visibility=e,s("newcourseroomB").style.visibility=e}function Lr(){Ba("onehour"),Sr("visible")}function Ir(){Ba("ninety"),Sr("visible")}function Or(){Ba("twohour"),Sr("hidden")}function Pr(){Ba("threehour"),Sr("hidden")}function Hr(){rr("chooseexistingcats"),sr("choosenewcat")}function Tr(){sr("chooseexistingcats"),rr("choosenewcat")}function Ar(){var e=t.indexData.courses.length,a,r,i;for(Ze(),c(s("references")),cs(),i=0;i<e;i++)r=t.indexData.courses[i],""!==(a=n[r]).assgn&&(as(a.assgn,r,"off"),as(a.assgn,r,"on")),"CLINIC"!==a.cat&&(s("edrinit-"+r).style.display="inline-block",s("ref"+r).style.display="inline-block")}function Rr(e){sr("catref"+e),rr("catcontain"+e)}function Fr(e){rr("catref"+e),sr("catcontain"+e)}function Gr(e){var t=e.split(/[scdt]/).map(Number);return t.shift(),t}function Br(e,a){var r=a.substring(3);if(ss(a),Yr(e)){if("CLINIC"===n[r].cat)return void xe(r);if(!Zr(e))return void Ie(r);t.tempCparam=""+r,s(a).style.backgroundColor="#2c3e50",s(a).style.color="#ffffff"}}function Kr(e){var t=e.substring(0,8),n=e.substring(8);"edrinit-"!==t?"edrsave-"!==t?"edrdel-"!==e.substring(0,7)||Ee(e.substring(7)):Oa(n):ar(n)}function qr(e){var t=e.substring(0,6),n=e.substring(6);switch(t){case"catedt":Fr(n);break;case"catsve":De(n);break;case"catdel":Ne(n);break;case"catref":cr(e);break;default:return}}function _r(e){var n,a;if(""!==t.tempCparam&&(s("ref"+t.tempCparam).style.backgroundColor="",s("ref"+t.tempCparam).style.color=""),ea("off"),""!==t.tempKlinic.kbtn&&(Jr(null,"off"),t.tempKlinic.kbtn=""),e.target!==e.currentTarget)switch(a=(n=e.target.id).substring(0,3)){case"rec":je(n);break;case"bld":Wt(n);break;case"ref":Br(e,n);break;case"cat":qr(n);break;case"edr":Kr(n);break;default:return}e.stopPropagation()}function Jr(e,t){var n=s("klinicscontainer"),a,r;if(n.hasChildNodes())for(a=n.childNodes,r=0;r<a.length;r++)a[r].className=R(a[r].className,"active");"on"===t&&(s("kbtn_"+e).className+=" active")}function Mr(e,a){var r=Gr(a),s,i;if(4===r.length)if(s="c0",0!==r[1]&&(s="c"+r[1]),0===r[1]){if(""!==t.tempKlinic.kbtn)return i=""+t.tempKlinic.kbtn,aa(e.target.id,i),void(!1===t.tempKlinic.isHeld&&(t.tempKlinic.kbtn=""));Yr(e)&&Zr(e)&&""!==t.tempCparam?"CLINIC"!==n[t.tempCparam].cat&&(Be(r[0],t.tempCparam),t.tempCparam=""):Qr(e.target.id,r)}else"CLINIC"!==n[s].cat?Yr(e)?Oe(r):Qr(e.target.id,r):(Jr(null,"off"),t.tempKlinic.kbtn="",xe(s))}function jr(e){var n,a,r,i;""!==t.tempCparam&&(s("ref"+t.tempCparam).style.backgroundColor="",s("ref"+t.tempCparam).style.color=""),""!==t.tempKlinic.kbtn&&!1===t.tempKlinic.isHeld&&Jr(null,"off"),""===t.tempKlinic.kbtn&&!1!==t.tempKlinic.isHeld&&(ea("off"),Jr(null,"off")),e.target!==e.currentTarget&&("s"===(a=(n=e.target.id).substring(0,1))?Mr(e,n):"del"===(r=n.substring(0,3))?_e(n):"off"===r?Yr(e)?Pe(n):He(n):"tchr"===(i=n.substring(0,4))?Ur(n):"rese"===i&&Me(n),e.stopPropagation())}function Wr(e,n){if(Yr(e))return t.tempKlinic.kbtn="",void Jr(null,"off");t.tempKlinic.kbtn=n.substring(5),Jr(t.tempKlinic.kbtn,"on")}function $r(e){if(e.target!==e.currentTarget){var t=e.target.id;if("kbtn_"===t.substring(0,5))Wr(e,t);else switch(t){case"addnewcourse":xr();break;case"renamer":bs();break;case"purger":Le();break;case"openklinics":Un();break;case"coursefinder":Ls();break;case"savenewCNames":at();break;case"exitnewCNames":Ds();break;default:return}}e.stopPropagation()}function Vr(e){if(e.target!==e.currentTarget){var t=e.target.id;switch(t){case"deptgrpsbyps":Cr();break;case"dayhrsbyps":case"dayhrsset":kr();break;case"downloadjson":fa();break;case"downloadcsv":ma();break;case"downloadpdf":case"dlklinicpdf":Zt(t);break;case"newmontofri":wr();break;case"newmontosat":br();break;case"schedhrsbyps":case"schedhrsset":Nr();break;case"seqhrsbyps":case"seqhrsset":Er();break;case"open-settings":Qe();break;case"updatenames":Tn();break;default:return}}e.stopPropagation()}function zr(e){var t;if(e.target!==e.currentTarget)switch(e.target.id){case"newcoursecatmake":Hr();break;case"savenewcat":he(!0,s("definenewcat").value);break;case"savecoursechanges":Fa();break;case"exitchoosenewcat":Tr();break;case"exitcoursechanges":fs();break;default:return}e.stopPropagation()}function Ur(e){var t=e.substring(4,7),n=e.substring(7);switch(t){case"set":kn(n);break;case"clr":En(n);break;case"sve":Sn(n);break;default:return}}function Yr(e){return!!e.shiftKey}function Zr(e){return!!e.altKey}function Xr(e){var t=e.substring(4),n;for(n=0;n<5;n++)s("off"+n+t).style.color="";return a[t].hasOwnProperty("isSat")&&(s("off5"+t).style.color=""),s(e).style.color="#2c3e50",t}function Qr(e,t){var n="s"+t[0],a=[t[2],t[3]],r,i,o,c;0===t[1]&&("nada"!==(r=Re(n,a))?(as(n,r,"on"),ts(n)):(s(e).textContent="X",i=window.setTimeout((function(){s(e).textContent="0",window.clearTimeout(i)}),800))),0!==t[1]&&("nada"!==(c=Te(n,a,o="c"+t[1]))?(as(n,c,"on"),ts(n)):Fe(n,o)),We(n)}function es(){t.indexData.klinics.length||(ea("off"),Jr(null,"off"),t.tempKlinic.kbtn="")}function ts(e){s("catlist"+e).textContent=Ke(e)}function ns(a,r){var s=e.alphabet,i="",o,c,d;for(o=!0===r?a:n[a].cat,c=t.catData.length,d=0;d<c;d++)if(t.catData[d][0]===o){if(d>=s.length){i=s[d-s.length];break}i=s[d];break}return i}function as(e,t,a){var r=n[t],i,o,c,d,l,u;"off"===a?(i=""+e+t+"d"+r.dayhr[0][0]+"t"+r.dayhr[0][1],o=""+e+t+"d"+r.dayhr[1][0]+"t"+r.dayhr[1][1],l=e+"c0d"+r.dayhr[0][0]+"t"+r.dayhr[0][1],u=e+"c0d"+r.dayhr[1][0]+"t"+r.dayhr[1][1],"threehour"===r.duration&&(c=""+e+t+"d"+r.dayhr[0][0]+"t"+(r.dayhr[0][1]+1),d=e+"c0d"+r.dayhr[0][0]+"t"+(r.dayhr[0][1]+1)),s(i).setAttribute("id",l),s(l).className="",s(l).textContent="0","klinichour"!==r.duration&&(s(o).setAttribute("id",u),s(u).className="",s(u).textContent="0"),"threehour"===r.duration&&(s(c).setAttribute("id",d),s(d).className="",s(d).textContent="0")):(i=e+"c0d"+r.dayhr[0][0]+"t"+r.dayhr[0][1],o=e+"c0d"+r.dayhr[1][0]+"t"+r.dayhr[1][1],l=""+e+t+"d"+r.dayhr[0][0]+"t"+r.dayhr[0][1],u=""+e+t+"d"+r.dayhr[1][0]+"t"+r.dayhr[1][1],"threehour"===r.duration&&(c=e+"c0d"+r.dayhr[0][0]+"t"+(r.dayhr[0][1]+1),d=""+e+t+"d"+r.dayhr[0][0]+"t"+(r.dayhr[0][1]+1)),s(i).setAttribute("id",l),s(l).className="selected"+ns(t,!1),s(l).textContent=r.name+"("+r.dept+")","klinichour"!==r.duration&&(s(o).setAttribute("id",u),s(u).className="selected"+ns(t,!1),s(u).textContent=r.name+"("+r.dept+")"),"threehour"===r.duration&&(s(c).setAttribute("id",d),s(d).className="selected"+ns(t,!1),s(d).textContent=r.name+"("+r.dept+")")),"init"!==a&&is(t),os(t)}function rs(e){var t;e.target!==e.currentTarget&&"prsndel"==e.target.id.substring(0,7)&&(s("prsnnm"+(t=e.target.id.substring(7))).value="",s("prsn"+t).style.display="none"),e.stopPropagation()}function ss(e){var t=n[""+e.substring(3)].assgn,a;""!==t&&(s(t).scrollIntoView({behavior:"smooth",block:"center"}),s(t).className+=" highlight",a=window.setTimeout((function(){s(t).className=R(s(t).className,"highlight"),window.clearTimeout(a)}),3e3))}function is(e){"c0"!==e&&s("contain"+e).scrollIntoView({behavior:"smooth",block:"center"})}function os(e){var t=s("ref"+e),a=s("sSgn"+e),r;if(""===n[e].assgn)return t.setAttribute("class","whitecircle"),void(a.textContent="");r="activecircle"+ns(e,!1),t.setAttribute("class",r),a.textContent=" "+n[e].assgn}function cs(){var e=[],a=t.catData.length,r=t.indexData.courses.length,s,i,o;for(o=0;o<a;o++)i=t.catData[o][0],_a(o+1),e.push(i),"$deleted"===i.substring(0,8)&&Ka(o+1);for(o=0;o<r;o++)Sa(s=t.indexData.courses[o],e.indexOf(n[s].cat)+1);ds()}function ds(){var e;for(e=0;e<t.catData.length;e++)"CLINIC"!==t.catData[e][0]&&Number(t.catData[e][1])>Number(t.settings.maxHours)/2&&sr("bldr"+[e+1])}function ls(e,t){var a="none",r="inline-block",i=n[e];"CLINIC"!==i.cat&&(t||(r="none",a="inline-block"),s("ref"+e).style.display=a,s("edrinit-"+e).style.display=a,"twohour"!==i.duration&&"threehour"!==i.duration||(s("edrday2-"+e).style.display="none",s("edrstart2-"+e).style.display="none"),s("edrsave-"+e).style.display=r,s("edredit-"+e).style.display=r,s("edrdel-"+e).style.display=r)}function us(e){ls(e,!0)}function ps(e){ls(e,!1)}function hs(){var e;if(s("deptgroupsset").textContent="",!t.settings.deptGrps.length)return rr("deptgrpcontrol"),void sr("nodeptgrps");for(e=0;e<t.settings.deptGrps.length-1;e++)s("deptgroupsset").textContent+=" "+t.settings.deptGrps[e]+" -";s("deptgroupsset").textContent+=" "+t.settings.deptGrps[t.settings.deptGrps.length-1],sr("deptgrpcontrol"),rr("nodeptgrps")}function ms(){s("schedhrsset").textContent=t.settings.maxHours,s("dayhrsset").textContent=t.settings.maxHrsPerDay,2===t.settings.maxSeqHrs?s("seqhrsset").textContent="2-2-3(3)":s("seqhrsset").textContent="3-4-3(6)",Hs(t.settings.overrides.deptGrps,"deptgrpsbyps"),hs(),sr("displayOverrides")}function fs(){rr("newcoursemodal"),St(),qt(),s("left").style.visibility="visible",s("right").style.visibility="visible",sr("displayOverrides")}function gs(e){var t,n;e.target!==e.currentTarget&&"deptdel"==e.target.id.substring(0,7)&&!0===qn(n="deptnm"+(t=e.target.id.substring(7)))&&(s(n).value="",s("dpts"+t).style.display="none"),e.stopPropagation()}function vs(e){e.target!==e.currentTarget&&"makegroup"===e.target.id&&Za(),e.stopPropagation()}function ys(e){e.target!==e.currentTarget&&"opt"==e.target.id.substring(0,3)&&(e.shiftKey?$n(e.target.id,!1):$n(e.target.id,!0)),e.stopPropagation()}function xs(){var e=t.indexData.courses.length,a,r;for(s("left").style.width="40%",s("right").style.width="60%",s("rightsidesettings").style.width="60%",s("leftsidesettings").style.width="40%",s("right").className+=" disabled",s("rightsidesettings").className+=" disabled",r=0;r<e;r++)a=t.indexData.courses[r],"CLINIC"!==n[a].cat&&(s("edrinit-"+a).style.display="inline-block",s("ref"+a).style.display="inline-block");for(r=0;r<t.catData.length;r++)sr("catedt"+[r+1])}function ws(){var e=t.indexData.courses.length,n,a;for(s("left").style.width="",s("right").style.width="",s("rightsidesettings").style.width="",s("leftsidesettings").style.width="",s("right").className=R(s("right").className,"disabled"),s("rightsidesettings").className=R(s("rightsidesettings").className,"disabled"),a=0;a<e;a++)s("edredit-"+(n=t.indexData.courses[a])).hasChildNodes&&c(s("edredit-"+n)),s("edrinit-"+n).style.display="none",s("edrsave-"+n).style.display="none",s("edredit-"+n).style.display="none",s("edrdel-"+n).style.display="none",s("ref"+n).style.display="block";for(a=0;a<t.catData.length;a++)rr("catcontain"+[a+1]),rr("catedt"+[a+1]),sr("catref"+[a+1])}function bs(){var e=t.indexData.courses.length,a,r;for(rr("renamer"),r=0;r<e;r++)a=t.indexData.courses[r],"CLINIC"!==n[a].cat&&(s("edredit-"+a).hasChildNodes&&c(s("edredit-"+a)),s("edrinit-"+a).style.display="none",s("edrsave-"+a).style.display="none",s("edrdel-"+a).style.display="none",s("ref"+a).style.display="none",s("edredit-"+a).style.display="inline-block",ja(a));for(r=0;r<t.catData.length;r++)cr("catref"+[r+1]),rr("catedt"+[r+1]);sr("newCNames"),rr("purger"),rr("addnewcourse"),rr("openklinics")}function Ds(){var e=t.indexData.courses.length,a,r;for(rr("newCNames"),r=0;r<e;r++)s("edredit-"+(a=t.indexData.courses[r])).style.display="none",s("edredit-"+a).hasChildNodes&&c(s("edredit-"+a)),s("ref"+a).style.display="inline-block","CLINIC"!==n[a].cat&&(s("edrinit-"+a).style.display="inline-block");for(r=0;r<t.catData.length;r++)cr("catref"+[r+1]),sr("catedt"+[r+1]);sr("renamer"),sr("purger"),sr("addnewcourse"),sr("openklinics")}function Cs(e,t){var n=[],a;for(n="updateHdrsA"===t?["strHdr1","strHdr2","strHdr3","strHdr4"]:["strHdr5","strHdr6"],a=0;a<n.length;a++)g(n[a]),s(n[a]).disabled=!e;if(!1===e)return s(t).className=R(s(t).className,"btn-primary"),s(t).className+=" btn-warning",s(t).textContent="edit headers",void window.mscAlert({title:"",subtitle:"The csv headers have been updated."});s(t).className=R(s(t).className,"btn-warning"),s(t).className+=" btn-primary",s(t).textContent="update headers"}function Ns(){var t=Number(s("hrsPerSchedule").value),n="";5*e.uiScheduleNumOfHrsPerDay<t&&(n="#d62c1a"),s("hrsPerSchedule").style.color=n}function ks(){var t=Number(s("hrsPerDay").value),n="";e.uiScheduleNumOfHrsPerDay<t&&(n="#d62c1a"),s("hrsPerDay").style.color=n}function Es(){var t=s("newcoursename"),n="^([0-9]{"+e.courseNameNumLength+"})$";t.style.color=K(t.value,n)}function Ss(){var e=s("newcourseroom");e.style.color=K(e.value,"^([a-zA-Z0-9\\-\\u3130-\\u318F\\uAC00-\\uD7AF])")}function Ls(){var t=s("searchcourses"),n,a,r,i;return new RegExp("^([0-9]{"+e.courseNameNumLength+"})$","g").test(t.value)?(t.style.color="",null==(i=y(r=t.value))?(Os(),void(t.style.color="#d62c1a")):(Is(i),void is(i))):(Os(),void(t.style.color="#d62c1a"))}function Is(e){Os(),s("contain"+e).className+=" arrow-pointer",t.lastSearchItem=e}function Os(){var e=t.lastSearchItem,a="contain"+e;""!==e&&void 0!==n[e]&&(s(a).className=R(s(a).className,"arrow-pointer"),t.lastSearchItem="")}function Ps(e){var n=t.indexData.schedules.length,r,s;for(s=0;s<n;s++)r=t.indexData.schedules[s],a[r].display="s"+(t.indexData.schedules.indexOf(r)+1);if(!0===e)for(s=0;s<n;s++)r=t.indexData.schedules[s],document.getElementById(r).childNodes[0].childNodes[0].textContent=a[r].display}function Hs(e,t){!0!==e?s(t).className=R(s(t).className,"bypass"):s(t).className+=" bypass"}function Ts(){Hs(t.settings.overrides.deptGrps,"deptgrpsbyps"),Hs(t.settings.overrides.maxHours,"schedhrsbyps"),Hs(t.settings.overrides.maxHrsPerDay,"dayhrsbyps"),Hs(t.settings.overrides.maxSeqHrs,"seqhrsbyps"),"week"===t.settings.deptGrpsSetBy?s("deptGrpsWeekly").checked=!0:s("deptGrpsDaily").checked=!0,!0===t.settings.overrides.multiCats?s("mlticatsyes").checked=!0:s("mlticatsno").checked=!0}function As(){s("hrsPerSchedule").value=t.settings.maxHours,s("hrsPerDay").value=t.settings.maxHrsPerDay,2===t.settings.maxSeqHrs?s("seqHrsTwo").checked=!0:s("seqHrsThree").checked=!0}function Rs(){Ua(),s("setting-section").className+=" disabled",s("newcourseform").className+=" disabled",rr("hiddendeptopenL"),rr("hiddendeptopenR"),sr("departments")}function Fs(){rr("departments"),sr("hiddendeptopenR"),sr("hiddendeptopenL"),s("setting-section").className=R(s("setting-section").className,"disabled"),s("newcourseform").className=R(s("newcourseform").className,"disabled"),c(s("deptEDIT"))}function Gs(){var t=s("configStartHr"),n=s("configNumOfHrsPerDay"),a=Number(t.options[t.selectedIndex].value),r=document.createDocumentFragment(),i,o,d;for(c(n),d=a;d<23;d++)(i=document.createElement("OPTION")).value=d+1,i.textContent=("0"+i.value).slice(-2)+":00",r.appendChild(i);n.appendChild(r),(o=n.options.length)<e.uiScheduleNumOfHrsPerDay?n.options[o-1].selected=!0:n.options[e.uiScheduleNumOfHrsPerDay-1].selected=!0}function Bs(){var t=Number(s("configStartHr").value),n=Number(s("configNumOfHrsPerDay").value);e.uiTimeInputStartHr=1*t,e.uiScheduleNumOfHrsPerDay=1*(n-t),9!==e.uiTimeInputStartHr&&(e.pdfBlankHr=""),s("configStartHr").disabled=!0,s("configNumOfHrsPerDay").disabled=!0}Array.prototype.identical=function(e){var t;if(this.length!==e.length)return!1;for(t=0;t<e.length;t++)if(this[t].identical){if(!this[t].identical(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},"serviceWorker"in navigator&&navigator.serviceWorker.register("/schedules/serviceWorker.js"),"onpagehide"in window?window.addEventListener("pagehide",oa,!1):window.addEventListener("beforeunload",oa,!1),lt()}()}));
//# sourceMappingURL=main.min.js.map