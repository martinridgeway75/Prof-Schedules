window.addEventListener("load",function(){!function(){"use strict";var e,t,S={notes:"App assumes that there are either MonToFri or MonToSat schedules.\nApp assumes that courses are: 2x1 hour blocks, 2x90 minute blocks, 2 hour blocks, 3 hour blocks or 1 hour clinics.\nApp assumes all courses start on the hour.",uriTypes:{csv:"data:text/csv;charset=utf-8,%EF%BB%BF",json:"data:application/json;charset=utf-8",txt:"data:text/plain;charset=utf-8"},maxHrsPerDay:4,maxHours:12,uiTimeInputStartHr:9,uiScheduleNumOfHrsPerDay:9,courseNameNumLength:4,csvStr:{courseCat:"교과목명",courseNum:"수강 번호",courseTime:"시간",courseRm:"강의실",courseTchr:"강사명",oldNum:"수강 번호1",newNum:"수강 번호2"},alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],monToSatKr:["월","화","수","목","금","토"],monToSatEn:["M","T","W","Th","F","S"],pdfBlankHr:"7:50-8:40",pdfCourseColors:["","blue","crimson","green","purple","darkorange"],scheduleRowPixelHeight:18},L={},N={},I={},l={courseCat:S.csvStr.courseCat,courseNum:S.csvStr.courseNum,courseTime:S.csvStr.courseTime,courseRm:S.csvStr.courseRm,courseTchr:S.csvStr.courseTchr,oldNum:S.csvStr.oldNum,newNum:S.csvStr.newNum};function O(e){return document.getElementById(e)}function s(){L={catData:[],indexData:{courses:[],schedules:[],klinics:[],depts:[]},settings:{deptGrps:[],deptGrpsSetBy:"day",maxHours:S.maxHours,maxHrsPerDay:S.maxHrsPerDay,maxSeqHrs:3,overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},teachers:[],tempCparam:"",tempKlinic:{kbtn:"",isHeld:!1},lastSearchItem:""}}function o(e){return null===e||("object"!=typeof e||0===Object.keys(e).length)}function k(e){for(;e.hasChildNodes();){for(;e.lastChild.hasChildNodes();)e.lastChild.removeChild(e.lastChild.lastChild);e.removeChild(e.lastChild)}}function v(e){for(var t,n=[],a=e.length,r=0;r<a;r++){for(t=r+1;t<a;t++)e[r]===e[t]&&(t=++r);n.push(e[r])}return n}function h(e,t){for(var n,a=[],r=e.length,s=0;s<r;s++){for(n=s+1;n<r;n++)e[s][t]===e[n][t]&&(n=++s);a.push(e[s])}return a}function d(e){return S.csvStr[e]}function c(e){for(var t,n,a=L.indexData.courses.length,r=0;r<a;r++)if(n=L.indexData.courses[r],N[n].name===e){t=n;break}return t}function n(){L.settings.maxSeqHrs=2}function a(){L.settings.maxSeqHrs=3}function r(){L.settings.deptGrpsSetBy="day"}function i(){L.settings.deptGrpsSetBy="week"}function u(){L.settings.overrides.multiCats=!0}function p(){L.settings.overrides.multiCats=!1}function m(e){return e.replace(/[,=<>$/'"&\t]/g,"")}function f(e){return e.replace(/[,=<>$/'"&\t\s]/g,"")}function g(e){return e.replace(/[^\u3130-\u318F\uAC00-\uD7AF]/gim,"")}function y(e){return e.replace(/[^a-zA-Z\-\u3130-\u318F\uAC00-\uD7AF\s]/gim,"")}function x(e){return e.replace(/[\s\t]+$/,"")}function w(e){return e.replace(/[\u3130-\u318F\uAC00-\uD7AF]/g,"")}function b(e){return e.replace(/[^a-zA-Z0-9\-]/gim,"")}function D(e,t){t=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");return e.replace(t,"")}function C(e){return e.replace(/\s+/g," ")}function E(e){return e.replace(/[^0-9]/g,"")}function P(e){return e.replace(/\s/g,"_")}function H(e,t){var n="";return n=!new RegExp(t,"g").test(e)?"#d62c1a":n}function T(e){e=new Array(S.uiScheduleNumOfHrsPerDay).fill(e);return JSON.parse(JSON.stringify(new Array(6).fill(e)))}function A(){O("csv-file").removeEventListener("change",qe,{capture:!1,passive:!0}),O("json-file").removeEventListener("change",ze,{capture:!1,passive:!0}),O("configStartHr").removeEventListener("change",va,{capture:!1,passive:!0}),O("savedsession").removeEventListener("click",Lt,{capture:!1,passive:!0}),O("newsession").removeEventListener("click",R,{capture:!1,passive:!0}),O("helpfileA").removeEventListener("click",mn,{capture:!1,passive:!0}),O("helpfile1").removeEventListener("click",fn,{capture:!1,passive:!0}),O("leftsidesettings").addEventListener("click",Fn,{capture:!1,passive:!0}),O("uploadnewCNames").addEventListener("change",Ue,{capture:!1,passive:!0}),O("rightsidesettings").addEventListener("click",Gn,{capture:!1,passive:!0}),O("schedule-instances").addEventListener("click",Rn,{capture:!1,passive:!0}),O("references").addEventListener("click",Hn,{capture:!1,passive:!0}),O("searchcourses").addEventListener("input",la,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",dt,{capture:!1,passive:!0}),O("deptGrpsDaily").addEventListener("click",r,{capture:!1,passive:!0}),O("deptGrpsWeekly").addEventListener("click",i,{capture:!1,passive:!0}),O("mlticatsyes").addEventListener("click",u,{capture:!1,passive:!0}),O("mlticatsno").addEventListener("click",p,{capture:!1,passive:!0}),O("startedr").addEventListener("click",Pe,{capture:!1,passive:!0}),O("helpfileB").addEventListener("click",gn,{capture:!1,passive:!0}),O("helpfile1").addEventListener("click",yn,{capture:!1,passive:!0}),O("view-stats").addEventListener("click",Oe,{capture:!1,passive:!0}),O("klinicHold").addEventListener("click",Nt,{capture:!1,passive:!0})}function R(){xa(),s(),ge(!1),A()}function F(e,t,n){var a=N[I[e].cRef[n]],r=N[t];return r.hasOwnProperty("allowFollow")?a.hasOwnProperty("allowFollow")?function(e,t,n){for(var a=N[I[e].cRef[n]],r=N[t],s=[[r.dayhr[0][0],r.dayhr[0][1]+1],[r.dayhr[1][0],r.dayhr[1][1]+1]],i=[[a.dayhr[0][0],a.dayhr[0][1]+1],[a.dayhr[1][0],a.dayhr[1][1]+1]],d=0;d<2;d++){if(s[d].identical(a.dayhr[0]))return!0===r.allowFollow[d]&&!1===a.allowFollow[0];if(s[d].identical(a.dayhr[1]))return!0===r.allowFollow[d]&&!1===a.allowFollow[1];if(i[d].identical(r.dayhr[0]))return!0===a.allowFollow[d]&&!1===r.allowFollow[0];if(i[d].identical(r.dayhr[1]))return!0===a.allowFollow[d]&&!1===r.allowFollow[1]}return 1}(e,t,n):!((n=[[r.dayhr[0][0],r.dayhr[0][1]+1],[r.dayhr[1][0],r.dayhr[1][1]+1]])[0].identical(a.dayhr[0])||n[1].identical(a.dayhr[1])||n[1].identical(a.dayhr[0])||n[0].identical(a.dayhr[1])):!a.hasOwnProperty("allowFollow")||(a=[[a.dayhr[0][0],a.dayhr[0][1]+1],[a.dayhr[1][0],a.dayhr[1][1]+1]],!(r.dayhr[0].identical(a[0])||r.dayhr[1].identical(a[1])||r.dayhr[1].identical(a[0])||r.dayhr[0].identical(a[1])))}function G(e){return""===N[e].assgn}function B(e,t){return N[t].dayhr[0][0]!==I[e].dayOff&&N[t].dayhr[1][0]!==I[e].dayOff}function K(e){for(var t,n=0,a=I[e].cRef.length,r=0;r<a;r++)"CLINIC"!==(t=N[I[e].cRef[r]]).cat&&("ninety"===t.duration||"threehour"===t.duration?n+=1.5:n+=1);return 2*n}function q(e,t){return-1===I[e].cRef.indexOf(t)}function _(e){return e>Number(L.settings.maxHrsPerDay)}function J(e,t){var n,a,r,s,i,d,o,c,l,u=T(0),p=!1,h=!1;if(!0===L.settings.overrides.maxSeqHrs)return!0;if("CLINIC"===N[t].cat)return!0;for(a=N[t].dayhr[0][0],r=N[t].dayhr[1][0],s=N[t].dayhr[0][1],t=N[t].dayhr[1][1],l=0;l<I[e].cRef.length;l++)"CLINIC"!==(n=N[I[e].cRef[l]]).cat&&(i=n.dayhr[0][0],d=n.dayhr[1][0],o=n.dayhr[0][1],c=n.dayhr[1][1],a!==i&&a!==d&&r!==i&&r!==d||(u[i][o]+=1,u[d][c]+=1,"threehour"===n.duration&&(u[i][o+1]+=1)));return u[a][s]+=1,u[r][t]+=1,"twohour"===n.duration&&(p=!0),"threehour"===n.duration&&(u[a][s+1]+=1,h=p=!0),function(e,t,n){var a,r,s,i=!0,d=e.length;if(2===L.settings.maxSeqHrs)if(n){for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-2;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]){i=!1;break}}else for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-1;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]){i=!1;break}if(3===L.settings.maxSeqHrs)if(t){for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-3;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]&&a[s+3]===a[s+4]){i=!1;break}}else for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-2;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]){i=!1;break}return i}(u,p,h)}function M(e,t){t=N[t];return!!I[e].hasOwnProperty("isSat")||5!==t.dayhr[0][0]&&5!==t.dayhr[1][0]&&!I[e].hasOwnProperty("isSat")}function j(e,t){var n,a,r,s,i,d,o,c,l,u,p;if(!L.settings.deptGrps.length)return 1;if(!0===L.settings.overrides.deptGrps)return 1;if("CLINIC"===N[t].cat)return 1;for(n=function(e){for(var t,n=[],a=L.settings.deptGrps.length,r=0;r<a;r++)-1!==(t=L.settings.deptGrps[r]).indexOf(e)&&n.push(t);return n}(N[t].dept),a=[],s=I[e].cRef.length,u=0;u<s;u++)"CLINIC"!==(r=N[I[e].cRef[u]]).cat&&("week"===L.settings.deptGrpsSetBy&&a.push(r.dept),"day"===L.settings.deptGrpsSetBy&&(d=r.dayhr[0][0],o=r.dayhr[1][0],c=N[t].dayhr[0][0],l=N[t].dayhr[1][0],d!==c&&d!==l&&o!==c&&o!==l||a.push(r.dept)));for(a.push(N[t].dept),v(a),u=0;u<n.length;u++){for(p=i=0;p<a.length;p++)n[u].includes(a[p])&&i++;if(i===a.length)return 1}}function W(e,t){I[e].cRef.push(t),N[t].assgn=e}function $(e,t){var n,a,r,s,i,d,o,c,l;if(I[e].cRef.length){if(!1!==q(e,t)&&!1!==G(t)&&!1!=(s=e,i=t,d=Number(L.settings.maxHours),o=2,!0===L.settings.overrides.maxHours||("CLINIC"===N[i].cat||("ninety"!==N[i].duration&&"threehour"!==N[i].duration||(o=3),K(s)+o<=d)))&&!1!==B(e,t)&&!1!==function(e,t){var n,a,r,s,i,d,o,c;if(!0===L.settings.overrides.maxHrsPerDay)return!0;if("CLINIC"===N[t].cat)return!0;for(n=[0,0,0,0,0,0],r=I[e].cRef,s=N[t].dayhr[0][0],i=N[t].dayhr[1][0],c=0;c<r.length;c++)"CLINIC"!==(a=N[r[c]]).cat&&(d=a.dayhr[0][0],o=a.dayhr[1][0],s!==d&&s!==o&&i!==d&&i!==o||(n[d]+=1,n[o]+=1,"threehour"===a.duration&&(n[d]+=1)));return n[s]+=1,n[i]+=1,"threehour"===a.duration&&(n[s]+=1),!n.some(_)}(e,t)&&!1!==J(e,t)&&!1!==M(e,t)){for(n=0,a=I[e].cRef.length,r=0;r<a&&(c=t,l=r,l=N[I[e].cRef[l]],c=N[c],!(l.dayhr[0].identical(c.dayhr[0])||l.dayhr[1].identical(c.dayhr[1])||l.dayhr[1].identical(c.dayhr[0])||l.dayhr[0].identical(c.dayhr[1]))&&F(e,t,r)&&function(e,t,n){if(e=N[I[e].cRef[n]],n=N[t],t=[],"threehour"===n.duration){if(t.push(n.dayhr[0][0]),t.push(n.dayhr[0][1]+1),e.dayhr[0].identical(t)||e.dayhr[1].identical(t))return}else if(t.push(e.dayhr[0][0]),t.push(e.dayhr[0][1]+1),"threehour"===e.duration&&(n.dayhr[0].identical(t)||n.dayhr[1].identical(t)))return;return 1}(e,t,r));r++)n++;n===a&&j(e,t)&&W(e,t)}}else G(t)&&B(e,t)&&M(e,t)&&W(e,t)}function V(e,t){if(!I[e].cRef.length)throw new Error("Internal error: Attempted to remove an assignment that was never made: s"+e+", c"+t);N[t].assgn===e&&-1!==I[e].cRef.indexOf(t)&&(e=e,N[t=t].assgn="",I[e].cRef.splice(I[e].cRef.indexOf(t),1))}function z(e,t){var n,a,r=I[e].cRef,s=!1;if(!0===L.settings.overrides.multiCats)return!0;if("CLINIC"===N[t].cat)return!0;if(!r.length)return!0;for(a=n=0;a<r.length;a++)if("CLINIC"!==N[r[a]].cat){if(N[r[a]].cat===N[t].cat){s=!0;break}}else n++;return s=n===r.length?!0:s}function U(e){var t="s1",n=L.indexData.schedules.length;return(n||0<n)&&(t="s"+(Number(L.indexData.schedules[n-1].substring(1))+1)),I[t]={},I[t].cRef=[],I[t].dayOff=6,I[t].display="","Sat"===e&&(I[t].isSat="yes"),L.indexData.schedules.push(t),pa(!1),t}function Y(e,t){t=["Please enter an appropriate name.",'"CLINIC" is a reserved category name!',"The name: "+t+" already exists.\nPlease choose a unique name."];window.mscAlert({title:"",subtitle:t[e]})}function Z(e,t){var n,a;if(!0===e){if(""===(t=C(m(t))))return void Y(0);if("clinic"===t.toLowerCase())return void Y(1);if(L.catData.length)for(a=0;a<L.catData.length;a++)if(L.catData[a][0]===t)return void Y(2,t)}n=[t,0,T(0)],L.catData.push(n),Ut(L.catData.length),!0===e&&(window.mscAlert({title:"",subtitle:t+" has been added to the list of categories."}),O("definenewcat").value="",En()),Yt()}function X(){L.newDepts=[],L.newKlinicDefs=[],L.newCourses=[],L.overwriteCourses=[],delete L.newDepts,delete L.newKlinicDefs,delete L.newCourses,delete L.overwriteCourses}function Q(){var e,t;for(!function(){var e,t,n=L.newCourses.length;for(t=0;t<n;t++)null!=L.newCourses[t]&&-1===L.indexData.depts.map(function(e){return e.shortcode}).indexOf(L.newCourses[t].dept)&&((e={}).shortcode=L.newCourses[t].dept,e.description="",L.newDepts.push(e));1<L.newDepts.length&&(L.newDepts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.newDepts=h(L.newDepts,"shortcode"))}(),e=L.newCourses.length-1;0<=e;e--)for(t=0;t<L.indexData.courses.length;t++)if(L.newCourses[e].name===N[L.indexData.courses[t]].name){L.overwriteCourses.push(L.newCourses[e]),L.newCourses.splice(e,1);break}L.overwriteCourses.length?window.mscConfirm({title:"Overwrite courses?",subtitle:'Some of the courses you are attempting to upload have names (IDs) that currently exist. Choose: "Ok" to overwrite the existing courses, or cancel this action.',onOk:function(){Gt(!0)},onCancel:function(){X()}}):Gt(!1)}function ee(e){var t,n;for(G(e)||oe(N[e].assgn,e),L.indexData.courses.splice(L.indexData.courses.indexOf(e),1),k(t=O("contain"+e)),t.parentNode.removeChild(t),n=0;n<L.catData.length;n++)if(L.catData[n][0]===N[e].cat){--L.catData[n][1],--L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]],"CLINIC"!==N[e].cat&&--L.catData[n][2][N[e].dayhr[1][0]][N[e].dayhr[1][1]],"threehour"===N[e].duration&&--L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]+1];break}delete N[e]}function te(e,t){for(var n,a,r,s,i=L.indexData.courses.length,d=0;d<i;d++)(r=N[L.indexData.courses[d]]).cat===t&&(r.cat=e);for(d=0;d<L.catData.length;d++)L.catData[d][0]===e?n=d:L.catData[d][0]===t&&(a=d);if(null==n)throw new Error("Internal error: Attempting to read a category that doesn't exist!");if(null==a)throw new Error("Internal error: Attempting to read a category that doesn't exist!");for(L.catData[n][1]+=L.catData[a][1],d=0;d<L.catData[n][2].length;d++)for(s=0;s<L.catData[n][2][d].length;s++)L.catData[n][2][d][s]+=L.catData[a][2][d][s];for(L.catData[a][0]="$deleted"+[a+1],function(){var e,t,n,a=L.indexData.courses.length;for(ye(),k(O("references")),Un(),n=0;n<a;n++)t=L.indexData.courses[n],""!==(e=N[t]).assgn&&(Wn(e.assgn,t,"off"),Wn(e.assgn,t,"on")),"CLINIC"!==e.cat&&(O("edrinit-"+t).style.display="inline-block",O("ref"+t).style.display="inline-block")}(),ae(e),d=0;d<L.catData.length;d++)dn("catedt"+[d+1]);cn("catref"+(n+1))}function ne(e){window.mscAlert({title:"",subtitle:["Please choose an appropriate name!",'"CLINIC" is a reserved category name!'][e]})}function ae(e){for(var t,n=L.indexData.courses.length,a=0;a<n;a++)(t=N[L.indexData.courses[a]]).cat===e&&""!==t.assgn&&Mn(t.assgn)}function re(e){var t=Number(e)-1;window.mscConfirm({title:"Warning",subtitle:"This action will also delete all courses under the category:\n"+L.catData[t][0]+".\nThis action cannot be undone. Proceed?",onOk:function(){!function(e){var t,n=L.catData[e][0];if(null!=L.catData[e]&&!Number.isNaN(Number(e))){for(t=L.indexData.courses.length-1;0<=t&&0<L.catData[e][1];t--)N[L.indexData.courses[t]].cat===n&&ee(L.indexData.courses[t]);"CLINIC"===n&&(L.indexData.klinics=[]),L.catData[e][0]="$deleted"+[e+1],Vt(e+1)}}(t)},onCancel:function(){}})}function se(){window.mscConfirm({title:"Purge?",subtitle:"This action will remove all courses and categories.\nSettings, teachers, departments, groups and clinic definitions will all remain intact.\nThis action cannot be undone! Proceed?",onOk:function(){!function(){var e,t=L.indexData.schedules.length;if(t)for(e=0;e<t;e++)he("reset"+L.indexData.schedules[e]);k(O("references")),N={},L.catData=[],L.indexData.courses=[]}()},onCancel:function(){}})}function ie(e){var t,n=function(e){var t,n=e.substring(4);for(t=0;t<5;t++)O("off"+t+n).style.color="";I[n].hasOwnProperty("isSat")&&(O("off5"+n).style.color="");return O(e).style.color="#2c3e50",n}(e),a=function(e,t){var n,a,r=I[e].cRef;if(I[e].dayOff=Number(t),!r.length)return[];for(n=[],a=0;a<r.length;a++)B(e,r[a])||n.push(r[a]);for(a=0;a<n.length;a++)V(e,n[a]);return n}(n,Number(e.substring(3,4)));if(a.length)for(t=a.length-1;0<=t;t--)Wn(n,a[t],"off"),"CLINIC"===N[a[t]].cat&&ee(a[t]);Mn(n),me(n)}function de(e,t){var n=!1,e=N[e];return"threehour"===e.duration&&[e.dayhr[0][0],e.dayhr[0][1]+1].identical(t)&&(n=!0),n=e.dayhr[0].identical(t)||e.dayhr[1].identical(t)?!0:n}function oe(e,t){V(e,t),Wn(e,t,"off"),Mn(e),me(e)}function ce(e,t){var n,a="s"+e,e=(n=a,!!G(e=t)&&(!0===z(n,e)&&($(n,e),!q(n,e))));!0==e&&(Wn(a,t,"on"),Mn(a),me(a)),!1==e&&"CLINIC"===N[t].cat&&ee(t),L.tempCparam=""}function le(e){var t,n,a,r="",s=[],i=I[e].cRef;if(!i.length)return"";for(a=0;a<i.length;a++)"CLINIC"!==(t=N[i[a]]).cat&&s.push(t.cat);if(!s.length)return"";for(s.sort(),r+=(n=v(s))[0],a=1;a<n.length;a++)r+=", "+n[a];return r}function ue(e){var t,n=I[e].cRef.slice(),a=O(""+e);for(k(a),a.parentElement.removeChild(a),function(e){var t;if(I[e].cRef.length)for(t=I[e].cRef.length-1;0<=t;t--)V(e,I[e].cRef[t]);L.indexData.schedules.splice(L.indexData.schedules.indexOf(e),1),delete I[e],pa(!0)}(e),t=0;t<n.length;t++)zn(n[t])}function pe(e){var t=U(e);zt(t,e),me(t)}function he(e){var t,n=e.substring(5);if(I[n].cRef.length)for(t=I[n].cRef.length-1;0<=t;t--)"CLINIC"===N[I[n].cRef[t]].cat?ee(I[n].cRef[t]):oe(n,I[n].cRef[t]);for(I[n].dayOff=6,t=0;t<5;t++)O("off"+t+n).style.color="";I[n].hasOwnProperty("isSat")&&(O("off5"+n).style.color=""),I[n].hasOwnProperty("tchr")&&""!==I[n].tchr&&st(n)}function me(e){var t=O(""+e);if(!I[e].cRef.length)return t.style.borderColor="#3498db",t.style.color="#3498db",void(t.firstChild.style.fontWeight="700");K(e)<L.settings.maxHours-1?(t.style.borderColor="#3498db",t.style.color="#3498db"):(t.style.borderColor="",t.style.color=""),t.firstChild.style.fontWeight="700"}function fe(e){var t,n,a=N[e];if("CLINIC"!==a.cat){for(t=O("edrdept-"+e),n=0;n<t.options.length;n++)if(a.dept===t.options[n].value){t.selectedIndex=n;break}O("edrday1-"+e).selectedIndex=a.dayhr[0][0],O("edrday2-"+e).selectedIndex=a.dayhr[1][0],"ninety"===a.duration?(!1===a.allowFollow[0]?O("edrstart1-"+e).options.length>2*a.dayhr[0][1]+1?O("edrstart1-"+e).selectedIndex=2*a.dayhr[0][1]+1:O("edrstart1-"+e).selectedIndex=O("edrstart1-"+e).options.length-1:O("edrstart1-"+e).selectedIndex=2*a.dayhr[0][1],!1===a.allowFollow[1]?O("edrstart2-"+e).options.length>2*a.dayhr[1][1]+1?O("edrstart2-"+e).selectedIndex=2*a.dayhr[1][1]+1:O("edrstart2-"+e).selectedIndex=O("edrstart2-"+e).options.length-1:O("edrstart2-"+e).selectedIndex=2*a.dayhr[1][1]):(O("edrstart1-"+e).selectedIndex=a.dayhr[0][1],O("edrstart2-"+e).selectedIndex=a.dayhr[1][1]),Zn(e,!0)}}function ge(e){var t,n,a;for(sn("parsing"),Qn(),ye(),Un(),Le("stats-grid","g_d"),Le("klinics-grid","gk_d"),a=0;a<L.indexData.schedules.length;a++)t=L.indexData.schedules[a],(n=I[t]).hasOwnProperty("isSat")?zt(t,"Sat"):zt(t,"MtoF");if(!0===e){for(a=0;a<L.indexData.courses.length;a++)t=L.indexData.courses[a],""!==(n=N[t]).assgn&&Wn(n.assgn,t,"init");for(a=0;a<L.indexData.schedules.length;a++)t=L.indexData.schedules[a],n=I[t],Mn(t),6!==n.dayOff&&(O("off"+n.dayOff+t).style.color="#2c3e50"),n.hasOwnProperty("tchr")&&""!==n.tchr&&(O("tchrset"+t).textContent=n.tchr);fa(),ma()}for(a=0;a<L.indexData.schedules.length;a++)me(L.indexData.schedules[a]);en()}function ye(){Yt(),Zt(),$t("onehour")}function ve(){var e,t;if(L.settings.deptGrps.length){for(e=[],t=0;t<L.indexData.depts.length;t++)e.push(L.indexData.depts[t].shortcode);for(t=L.settings.deptGrps.length-1;0<=t;t--)(o(L.settings.deptGrps[t])||e.identical(L.settings.deptGrps[t].sort()))&&L.settings.deptGrps.splice(t,1)}L.settings.deptGrps.length?L.settings.overrides.deptGrps=!1:L.settings.overrides.deptGrps=!0,O("newgroupid").dataset.grpindex=L.settings.deptGrps.length}function xe(){Xt(),tn(),sn("displayOverrides"),sn("left"),sn("right"),O("deptEDIT").addEventListener("click",ta,{capture:!1,passive:!0}),O("deptEDIT-file").addEventListener("change",Me,{capture:!1,passive:!0}),O("deptopenR").addEventListener("click",ga,{capture:!1,passive:!0}),O("save-deptEDIT").addEventListener("click",yt,{capture:!1,passive:!0}),O("deptEDITadd").addEventListener("click",ft,{capture:!1,passive:!0}),O("exit-deptEDIT").addEventListener("click",ya,{capture:!1,passive:!0}),O("jsonSettings-file").addEventListener("change",We,{capture:!1,passive:!0}),O("alldepartments").addEventListener("click",aa,{capture:!1,passive:!0}),O("newgroupid").addEventListener("click",na,{capture:!1,passive:!0}),O("allgroups").addEventListener("click",wt,{capture:!1,passive:!0}),O("seqHrsTwo").addEventListener("click",n,{capture:!1,passive:!0}),O("seqHrsThree").addEventListener("click",a,{capture:!1,passive:!0}),O("hrsPerSchedule").addEventListener("input",ia,{capture:!1,passive:!0}),O("hrsPerDay").addEventListener("input",da,{capture:!1,passive:!0}),O("save-settings").addEventListener("click",hn,{capture:!1,passive:!0}),dn("setting-section")}function we(e,t){t=["The new name for course: "+t+" must be a four digit number.","The course name: "+t+"\nbelongs to another existing course!\nNew course names cannot be duplicates of existing course names.","Please check that each course has a new unique name.\nSome new course names are being duplicated."];window.mscAlert({title:"",subtitle:t[e]})}function be(){for(var e,t,n,a=!1,r=[],s=L.indexData.courses.length,i=0;i<s;i++)if(e=L.indexData.courses[i],"CLINIC"!==N[e].cat)if(""===(t=O("newName-"+e).value))a=!0;else{if(""!==t&&(t.length!==S.courseNameNumLength||Number(t)<1||Number.isNaN(Number(t))))return void we(0,N[e].name);if(!0!==function(e){for(var t,n=L.indexData.courses.length,a=0;a<n;a++)if(t=L.indexData.courses[a],e===N[t].name&&""===O("newName-"+t).value)return!1;return!0}(t))return void we(1,t);r.push(t)}r.sort(),n=v(r),r.length===n.length?!0===a?window.mscConfirm({title:"",subtitle:"Some fields have been left blank.\nCourses with blank fields will not be renamed.\nContinue?",cancelText:"Cancel",onOk:function(){De()},onCancel:function(){}}):De():we(2)}function De(){for(var e,t,n,a=L.indexData.courses.length,r=0;r<a;r++)t=L.indexData.courses[r],"CLINIC"!==(e=N[t]).cat&&""!==(n=O("newName-"+t).value)&&(e.name=n,""!==e.assgn&&(Wn(e.assgn,t,"off"),Wn(e.assgn,t,"on")),rn(t));ra()}function Ce(){for(var e,t=0,n=0,a=L.indexData.schedules.length,r=0;r<a;r++)e=L.indexData.schedules[r],I[e].hasOwnProperty("isSat")?n++:t++;return[t,n]}function Ne(e){for(var t,n,a,r,s=0,i=0,d=[],o=0;o<L.catData.length;o++)s+=L.catData[o][1],i+=L.catData[o][2][5].reduce(function(e,t){return e+t},0);if(a=s,r=i,d=[a=Math.ceil((Math.ceil(a)-Math.ceil(r))/(Number(L.settings.maxHours)/2))+1,r=Math.ceil(r/(Number(L.settings.maxHours)/2))+1],!0!==e){if(n=d[1]-1-Ce[0],0<(t=d[0]-1-Ce[0]))for(o=0;o<t;o++)U("MtoF");if(0<n)for(o=0;o<n;o++)U("Sat")}else{if(0<d[0])for(o=0;o<d[0];o++)U("MtoF");if(0<d[1])for(o=0;o<d[1];o++)U("Sat")}}function ke(e,t,n){var a;L.catData=(a=e).map(function(e,t){return t%3==0?a.slice(t,t+3):null}).filter(function(e){return e}),L.indexData={},L.indexData.courses=t,L.indexData.schedules=[],L.indexData.depts=function(){for(var e,t=[],n=[],a=L.indexData.courses.length,r=0;r<a;r++)e=L.indexData.courses[r],t.push(N[e].dept);for(t.sort(),t=v(t),r=0;r<t.length;r++)n.push({shortcode:t[r],description:""});return n}(),!0===Array.isArray(n)?L.indexData.klinics=n:L.indexData.klinics=[],L.teachers=[],L.tempCparam="",L.tempKlinic={kbtn:"",isHeld:!1},L.lastSearchItem="",L.settings={maxHours:S.maxHours,maxHrsPerDay:S.maxHrsPerDay,maxSeqHrs:3,deptGrps:[[]],deptGrpsSetBy:"day",overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},L.settings.deptGrps=[]}function Ee(){var t,n,a=[],r=[],e=function(){var e,t,n,a=[],r=[],s=0,i=Object.keys(N);for(n=0;n<i.length;n++)"CLINIC"===(e=N[i[n]]).cat?(s+=1,(t={}).name=e.name,t.fullname=e.name,t.dept=e.dept,t.rm={},t.rm.a=e.rm.a,r.push(t)):a.push(e.name);if(a.sort(),a=v(a),i.length-s!==a.length)return L={},N={},I={},jt(),window.mscAlert({title:"",subtitle:"Please check that each course has a unique name (ID).\nSome new course names are duplicates."}),!1;if(r.length&&0<s)return r.sort(function(e,t){return e.name.localeCompare(t.name)}),r=h(r,"name");return!0}();if(!1!==e){try{Object.keys(N).forEach(function(e){r.push(""+e),t=N[e],-1===a.indexOf(t.cat)?(a.push(t.cat),a.push(1),n=T(0),a.push(n)):a[a.indexOf(t.cat)+1]+=1,a[a.indexOf(t.cat)+2][t.dayhr[0][0]][t.dayhr[0][1]]+=1,"CLINIC"!==t.cat&&(a[a.indexOf(t.cat)+2][t.dayhr[1][0]][t.dayhr[1][1]]+=1),"threehour"===t.duration&&(a[a.indexOf(t.cat)+2][t.dayhr[0][0]][t.dayhr[0][1]+1]+=1)}),ke(a,r,e),Ne(!0),ge(!1)}catch(e){return L={},N={},I={},jt(),void window.mscAlert({title:"Error",subtitle:"The .csv file you have supplied contains unexpected formatting and/or data."})}A()}}function Se(){for(var e,t,n=function(){for(var e,t,n,a,r=L.catData.length,s=T(0),i=T(0),d=T(0),o=0;o<r;o++)if(t=L.catData[o],"CLINIC"!==t[0]&&"$deleted"!==t[0].substring(0,8)){for(n=0;n<t[2].length;n++)for(a=0;a<t[2][n].length;a++)s[n][a]+=t[2][n][a];for(n=0;n<L.indexData.courses.length;n++)(e=N[L.indexData.courses[n]]).cat===t[0]&&""===e.assgn&&(d[e.dayhr[0][0]][e.dayhr[0][1]]+=1,d[e.dayhr[1][0]][e.dayhr[1][1]]+=1,"threehour"===e.duration&&(d[e.dayhr[1][0]][e.dayhr[1][1]+1]+=1))}for(o=0;o<i.length;o++)for(n=0;n<i[o].length;n++)i[o][n]=s[o][n]-d[o][n];return[i,d]}(),a=function(){for(var e,t,n,a=L.catData.length,r=T(0),s=0;s<a;s++)if("CLINIC"===(e=L.catData[s])[0])for(t=0;t<e[2].length;t++)for(n=0;n<e[2][t].length;n++)r[t][n]+=e[2][t][n];return r}(),r=0;r<n[0].length;r++)for(t=0;t<n[0][r].length;t++)O(e="g_d"+r+"t"+t).textContent=n[0][r][t],0<n[1][r][t]&&(O(e).textContent+=" ("+n[1][r][t]+")");for(r=0;r<a.length;r++)for(t=0;t<a[r].length;t++)O(e="gk_d"+r+"t"+t).textContent=a[r][t]}function Le(e,t){var n,a,r,s,i=function(){for(var e,t=[],n=S.uiScheduleNumOfHrsPerDay,a=0;a<n;a++)e=S.uiTimeInputStartHr+a,t.push(e+":00");return t}(),d=S.monToSatKr,o=O(e),c=document.createDocumentFragment(),l=document.createElement("TABLE"),u=document.createElement("THEAD"),p=document.createElement("TBODY"),h=document.createElement("TR"),e=document.createElement("TD");for(k(o),l.className="table table-bordered table-condensed",h.className="unbordered",h.appendChild(e),r=0;r<d.length;r++)(a=document.createElement("TD")).textContent=d[r],h.appendChild(a);for(p.appendChild(h),r=0;r<i.length;r++){for(n=document.createElement("TR"),s=0;s<=d.length;s++)a=document.createElement("TD"),0===s?(a.className="unbordered text-right",a.textContent=i[r]+"  "):a.id=""+t+(s-1)+"t"+r,n.appendChild(a);p.appendChild(n)}l.appendChild(u),l.appendChild(p),c.appendChild(l),o.appendChild(c)}function Ie(){for(var e="",t=L.catData.length,n=0;n<t;n++)"$deleted"!==L.catData[n][0].substring(0,8)&&"CLINIC"!==L.catData[n][0]&&(e+=function(e){for(var t,n=0,a=0,r="",s=L.indexData.courses.length,i=0;i<s;i++)e===(t=N[L.indexData.courses[i]]).cat&&(""!==t.assgn&&n++,a++);return r+=0<a-n?e+": "+n+" ("+(a-n)+")\n":e+": "+n+"\n"}(L.catData[n][0]));O("coursesByCat").textContent=e,O("coursesByDef").textContent=function(){for(var e,t,n,a=[],r="",s=L.indexData.courses.length,i=L.indexData.klinics.length,d=0;d<i;d++)(t={}).name=L.indexData.klinics[d].name,t.count=0,a.push(t);for(d=0;d<s;d++)"CLINIC"===(e=N[L.indexData.courses[d]]).cat&&-1!==(n=a.map(function(e){return e.name}).indexOf(e.name))&&(a[n].count+=1);for(d=0;d<a.length;d++)r+=a[d].name+": "+a[d].count+"\n";return r}()||""}function Oe(){Se(),Ie(),O("exit-stats").addEventListener("click",vn,{capture:!1,passive:!0}),dn("statistics"),sn("displayOverrides"),sn("left"),sn("right")}function Pe(){!function(){var e,t,n=L.indexData.courses.length;for(O("left").style.width="40%",O("right").style.width="60%",O("rightsidesettings").style.width="60%",O("leftsidesettings").style.width="40%",O("right").className+=" disabled",O("rightsidesettings").className+=" disabled",t=0;t<n;t++)e=L.indexData.courses[t],"CLINIC"!==N[e].cat&&(O("edrinit-"+e).style.display="inline-block",O("ref"+e).style.display="inline-block");for(t=0;t<L.catData.length;t++)dn("catedt"+[t+1])}(),O("startedr").removeEventListener("click",Pe,{capture:!1,passive:!0}),O("startedr").addEventListener("click",He,{capture:!1,passive:!0}),O("startedr").textContent="Close",dn("addnewcourse"),dn("renamer"),dn("purger"),dn("openklinics"),sn("klinicscontainer"),sn("klinicHolder")}function He(){!function(){var e,t,n=L.indexData.courses.length;for(O("left").style.width="",O("right").style.width="",O("rightsidesettings").style.width="",O("leftsidesettings").style.width="",O("right").className=D(O("right").className,"disabled"),O("rightsidesettings").className=D(O("rightsidesettings").className,"disabled"),t=0;t<n;t++)O("edredit-"+(e=L.indexData.courses[t])).hasChildNodes&&k(O("edredit-"+e)),O("edrinit-"+e).style.display="none",O("edrsave-"+e).style.display="none",O("edredit-"+e).style.display="none",O("edrdel-"+e).style.display="none",O("ref"+e).style.display="block";for(t=0;t<L.catData.length;t++)sn("catcontain"+[t+1]),sn("catedt"+[t+1]),dn("catref"+[t+1])}(),O("startedr").removeEventListener("click",He,{capture:!1,passive:!0}),O("startedr").addEventListener("click",Pe,{capture:!1,passive:!0}),O("startedr").textContent="",sn("renamer"),sn("newCNames"),sn("addnewcourse"),sn("purger"),sn("openklinics"),en(),Te("CLINIC")&&dn("klinicscontainer")}function Te(e){for(var t=!1,n=0;n<L.catData.length;n++)if(L.catData[n][0]===e){t=!0;break}return t}function Ae(){for(var e,t=[],n=L.indexData.schedules.length,a=0;a<n;a++)(e=I[L.indexData.schedules[a]]).cRef.length||6!==e.dayOff||t.push(L.indexData.schedules[a]);return t}function Re(e){var t,n,a,r={},s=[];try{r=new Worker("autoBldr_14.min.js")}catch(e){return}t=Ae(),n=function(e){for(var t,n={},a=L.indexData.courses.length,r=0;r<a;r++)(t=N[L.indexData.courses[r]]).cat===e&&""===t.assgn&&(n[L.indexData.courses[r]]=t);return n}(e),a=L.settings,e=""+S.uiScheduleNumOfHrsPerDay,s.push(t,n,a,e),s=JSON.stringify(s),r.onmessage=function(c){!function(){var e,t,n,a,r,s,i=JSON.parse(c.data),d=Object.keys(i),o=d.length;for(r=0;r<o;r++){for(n=d[r],t=i[n],e=t.cRef.length,s=0;s<e;s++)a=t.cRef[s],$(n,a),Wn(n,a,"on");I[n].dayOff=t.dayOff,O("off"+t.dayOff+n).style.color="#2c3e50",Mn(n),me(n)}}()},r.postMessage(s)}function Fe(e){e=Number(e.substring(4))-1,e=L.catData[e][0];!0===function(e){var t,n,a=0,r=Ae(),s=!0,i=L.indexData.courses.length;!1===Te(e)&&(s=!1);"CLINIC"===e&&(s=!1);for(n=0;n<i;n++)(t=N[L.indexData.courses[n]]).cat===e&&""===t.assgn&&a++;!0===L.settings.overrides.maxHours?(window.mscAlert({title:"",subtitle:"Please turn off the override for MAX. HOURS!"}),s=!1):a<L.settings.maxHours/2?(window.mscAlert({title:"",subtitle:"Too few unassigned courses left to justify this action!"}),s=!1):r.length||(window.mscAlert({title:"",subtitle:"No empty schedules are available."}),s=!1);return s}(e)&&Re(e)}function Ge(e,t){var n={text:" "+t,color:S.pdfCourseColors[e.indexOf(t)]||""};return e.length&&t!==e[e.length-1]&&(n.text=" "+t+", "),n}function Be(){var e,t,n,a=function(){for(var e,t=L.indexData.courses.map(function(e){if("CLINIC"===N[e].cat&&""!==N[e].assgn)return N[e]}).filter(function(e){return void 0!==e}),n=t.length,a=0;a<n;a++)(e=t[a]).tchr="unassigned",I[e.assgn].hasOwnProperty("tchr")&&""!==I[e.assgn].tchr&&(e.tchr=I[e.assgn].tchr);return t}(),r=L.indexData.klinics.map(function(e){return e.name}),s=[];for(v(r),n=0;n<r.length;n++)(e=a.filter(function(e){return e.name===r[n]})).length&&((t={}).def=r[n],t.inst=e,s.push(t));return s}function Ke(t){var n,e={},a=P((new Date).toDateString()),a="dlklinicpdf"===t?(n="PrintClinics_"+a+".pdf",function(){var e,t,n,a,r,s,i,d=Be(),o={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},c=d.length;for(r=0;r<c;r++)if(d[r].inst.length){var l=d[r].inst[0].fullname,u=vt(d[r].inst[0].dept);for(""===l&&(l=d[r].def),l={text:l+" clinic - "+d[r].inst[0].rm.a+" "+u+"\n\n"},e={style:"default",table:{widths:[],body:[]}},t=T(""),(e={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),e.table.body.push([S.pdfBlankHr,"","","","",""]),s=0;s<t[0].length;s++)n="\n"+(S.uiTimeInputStartHr+s)+":00-"+(S.uiTimeInputStartHr+s)+":50",n+="\n("+(s+1)+")",e.table.body.push([n]);for(u={pageBreak:"after",text:[]},s=0;s<d[r].inst.length;s++)(a={text:"\n"}).text+=""+d[r].inst[s].tchr,"unassigned"===d[r].inst[s].tchr&&(a.color=S.pdfCourseColors[2]),t[d[r].inst[s].dayhr[0][0]][d[r].inst[s].dayhr[0][1]].hasOwnProperty("text")&&(a.color=S.pdfCourseColors[1],a.text+=t[d[r].inst[s].dayhr[0][0]][d[r].inst[s].dayhr[0][1]].text),t[d[r].inst[s].dayhr[0][0]][d[r].inst[s].dayhr[0][1]]=a;for(d[r].inst.hasOwnProperty("isSat")?(e.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],e.table.body[0].push("Saturday"),e.table.body[1].push("")):e.table.widths=["15%","17%","17%","17%","17%","17%"],s=2;s<e.table.body.length;s++)for(i=0;i<e.table.widths.length-1;i++)e.table.body[s].push(t[i][s-2]);o.content.push(l),o.content.push(e),o.content.push(u)}return JSON.stringify(o)}()):(n="PrintSchedules_"+a+".pdf",function(){var e,t,n,a,r,s,i,d,o,c,l,u,p,h,m,f,g={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},y=L.indexData.schedules.length;for(h=0;h<y;h++)if(o=L.indexData.schedules[h],(c=I[o]).cRef.length){for(u=le(o).split(", "),(n={text:[]}).text.push(c.display+" - "),m=0;m<u.length;m++)n.text.push(Ge(u,u[m]));for(n.text.push("\n"),a=T(""),(e={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),e.table.body.push([S.pdfBlankHr,"","","","",""]),m=0;m<a[0].length;m++)p="\n"+(S.uiTimeInputStartHr+m)+":00-"+(S.uiTimeInputStartHr+m)+":50",p+="\n("+(m+1)+")",e.table.body.push([p]);for(t={pageBreak:"after",text:[]},m=0;m<c.cRef.length;m++)l=N[I[o].cRef[m]],r=""+l.name,s=""+l.name,i=Ge(u,l.cat),"CLINIC"===l.cat&&(s=""+l.fullname),s+="\n"+l.cat+"\n"+l.dept+l.rm.a,r+="\n"+l.cat+"\n"+l.dept,l.rm.hasOwnProperty("b")?r+=""+l.rm.b:r+=""+l.rm.a,l.hasOwnProperty("allowFollow")&&(d=function(e){var t={},e=e.split(/[^(0-9)]/g).filter(function(e){return""!==e});return t.a=e[0]+":"+e[1]+"-"+(Number(e[0])+1)+":"+(Number(e[1])+15),t.b=e[2]+":"+e[3]+"-"+(Number(e[2])+1)+":"+(Number(e[3])+15),t}(l.times),s+="\n("+d.a+")",r+="\n("+d.b+")"),a[l.dayhr[0][0]][l.dayhr[0][1]]={text:s,color:i.color},l.rm.hasOwnProperty("b")?a[l.dayhr[1][0]][l.dayhr[1][1]]={text:r,color:i.color}:a[l.dayhr[1][0]][l.dayhr[1][1]]={text:s,color:i.color},"threehour"===l.duration&&(a[l.dayhr[0][0]][l.dayhr[0][1]+1]={text:s,color:i.color});for(c.hasOwnProperty("tchr")&&""!==c.tchr&&n.text.push("Instructor: "+c.tchr),n.text.push("\n\n"),c.hasOwnProperty("isSat")?(e.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],e.table.body[0].push("Saturday"),e.table.body[1].push("")):e.table.widths=["15%","17%","17%","17%","17%","17%"],m=2;m<e.table.body.length;m++)for(f=0;f<e.table.widths.length-1;f++)e.table.body[m].push(a[f][m-2]);t.text=function(e){var t,n,a=[],r=I[e].cRef,s=r.length;for(n=0;n<s;n++)a.push(N[r[n]].dept);for(a.sort(),t=v(a),s=t.length,n=0;n<s;n++)t[n]="\n"+t[n]+" = "+vt(t[n]);return t}(o),g.content.push(n),g.content.push(e),g.content.push(t)}return JSON.stringify(g)}());O(t).className+=" disabled";try{e=new Worker("pdfWorker.js")}catch(e){return}e.onmessage=function(e){window.saveAs(e.data.pdfBlob,n),O(t).className=D(O(t).className,"disabled")},e.postMessage(a)}function qe(e){e=e.target.files[0];if("csv"!==e.name.substring(e.name.length-3))return O("inputFile").reset(),void window.mscAlert({title:"Error",subtitle:"File is not .csv!"});window.Papa.parse(e,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){for(var t=[l.courseCat,l.courseNum,l.courseTime,l.courseRm],n=[!1,""],a=0;a<t.length;a++)if(-1===e.meta.fields.indexOf(t[a])){n[0]=!0,n[1]=t[a];break}!0===n[0]?(N={},window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+n[1]+'"'})):function(t,e){var n,a,r,s,i,d=t.length,o=[];for(xa(),i=0;i<d;i++)if("CLINIC"!==(r=t[i])[l.courseCat])try{if(n="c"+(i+1),s={assgn:""},a=et(r[l.courseTime]),s.dayhr=at(a),s.times=nt(a),s.duration=a.type,"ninety"===s.duration&&(s.allowFollow=tt(a.charArr[4],a.charArr[9])),s.cat=C(m(r[l.courseCat])),s.dept=Xe(r[l.courseRm]),s.name=E(r[l.courseNum]),s.rm=Ze(r[l.courseRm],a.type,s.dept),""===s.cat||""===s.dept||""===s.name||""===s.rm.a)throw new Error("Parsed value is empty string");N[n]=s}catch(e){o.push(t[i]);continue}o.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),Ht(e,o)),Ye(N,!0)}(e.data,e.meta.fields),O("inputFile").reset(),sn("parsing")}})}function _e(e){e=e.target.files[0];if("csv"!==e.name.substring(e.name.length-3))return O("freshFile").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file."});window.Papa.parse(e,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t,n=[l.courseCat,l.courseNum,l.courseTime,l.courseRm],a=[!1,""],r=!1;for(L.newDepts=[],L.newKlinicDefs=[],L.newCourses=[],L.overwriteCourses=[],t=0;t<n.length;t++)if(-1===e.meta.fields.indexOf(n[t])){a[0]=!0,a[1]=n[t];break}!0===a[0]?(X(),window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+a[1]+'"'})):(-1!==e.meta.fields.indexOf(l.courseTchr)&&(r=!0),function(t,e,n){var a,r,s,i,d=t.length,o=L.teachers,c=[];for(i=0;i<d;i++)if("CLINIC"===(s=t[i])[l.courseCat])try{if((a={cat:"CLINIC"}).name=s[l.courseNum],a.fullname=a.name,a.rm={},a.rm.a=w(f(s[l.courseRm])),a.dept=Xe(g(s[l.courseRm])),""===a.dept||""===a.name||""===a.rm.a)throw new Error("Parsed value is empty string");L.newKlinicDefs.push(JSON.parse(JSON.stringify(a)))}catch(e){c.push(s[l.courseCat]);continue}else try{if(a={assgn:""},r=et(s[l.courseTime]),a.dayhr=at(r),a.times=nt(r),a.duration=r.type,"ninety"===a.duration&&(a.allowFollow=tt(r.charArr[4],r.charArr[9])),a.cat=C(m(s[l.courseCat])),a.dept=Xe(s[l.courseRm]),a.name=E(s[l.courseNum]),a.rm=Ze(s[l.courseRm],r.type,a.dept),""===a.cat||""===a.dept||""===a.name||""===a.rm.a)throw new Error("Parsed value is empty string");!0===n&&null==o.filter(function(e){return e.en===s[l.courseTchr]||e.kor===s[l.courseTchr]})[0]&&""!==s[l.courseTchr]&&L.teachers.push({en:s[l.courseTchr],kor:s[l.courseTchr]}),L.newCourses.push(a)}catch(e){c.push(t[i]);continue}c.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),Ht(e,c)),Ye(L.newCourses,!1)}(e.data,e.meta.fields,r)),O("freshFile").reset(),sn("parsing")}})}function Je(e){e=e.target.files[0];if("csv"!==e.name.substring(e.name.length-3))return O("inputTCHRS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(e,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var t;if(!e.data[0].hasOwnProperty("teachers"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "teachers"\n("강사명" is an optional ADMIN .csv display name).'});for(t=0;t<e.data.length;t++){var n,a=y(x(e.data[t].teachers)),r=y(x(e.data[t]["강사명"]))||"";""!==a&&(!0===ct(a)?""!==r&&(n=L.teachers.map(function(e){return e.en}).indexOf(a),L.teachers[n].kor=r):an(a,r))}}O("inputTCHRS").reset()}})}function Me(e){e=e.target.files[0];if("csv"!==e.name.substring(e.name.length-3))return O("inputDEPTS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(e,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var t;if(!e.data[0].hasOwnProperty("shortcode"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "shortcode"\n("description" is an optional header.)'});for(t=0;t<e.data.length;t++){var n,a=g(x(e.data[t].shortcode)),r=m(x(e.data[t].description))||"";""!==a&&(!0===mt(a)?""!==r&&(n=L.indexData.depts.map(function(e){return e.shortcode}).indexOf(a),L.indexData.depts[n].description=r):nn(a,r))}}O("inputDEPTS").reset()}})}function je(e){var t,n;try{t=JSON.parse(e)[0],window.localStorage.setItem("statsBkUp",JSON.stringify(L)),At(t)}catch(e){return window.mscAlert({title:"Error",subtitle:"The JSON file you have supplied cannot be used."}),n=JSON.parse(window.localStorage.getItem("statsBkUp")),L={},o(n)||(L=n),void window.localStorage.removeItem("statsBkUp")}fa(),ma(),en(),hn(),window.mscAlert({title:"Success!",subtitle:"Settings, departments, groups, teachers and clinic definitions have been loaded from file."})}function We(e){var t,e=e.target.files[0];if("json"!==e.name.substring(e.name.length-4))return O("uploadJSON").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(t=new window.FileReader).onload=function(){je(t.result)},t.readAsText(e),O("uploadJSON").reset()}function $e(){var e,t,n,a,r={},s=[],i=JSON.parse(JSON.stringify(L.settings));for(i.overrides.maxHours=!1,a=0;a<L.catData.length;a++)"CLINIC"!==L.catData[a][0]&&(r=new Worker("autoBldr_14.min.js"),e=L.indexData.schedules,t=function(e){for(var t,n={},a=L.indexData.courses.length,r=0;r<a;r++)(t=N[L.indexData.courses[r]]).cat===e&&(n[L.indexData.courses[r]]={},n[L.indexData.courses[r]].assign="",n[L.indexData.courses[r]].cat=t.cat,n[L.indexData.courses[r]].dayhr=t.dayhr,n[L.indexData.courses[r]].dept=t.dept,n[L.indexData.courses[r]].duration=t.duration,n[L.indexData.courses[r]].name=t.name,n[L.indexData.courses[r]].rm=t.rm,n[L.indexData.courses[r]].times=t.times,"ninety"===t.duration&&(n[L.indexData.courses[r]].allowFollow=t.allowFollow));return n}(L.catData[a][0]),n=""+S.uiScheduleNumOfHrsPerDay,(s=[]).push(e,t,i,n),n=JSON.stringify(s),r.onmessage=function(e){},r.onerror=function(e){throw e.preventDefault(),new Error("Cannot autoBld with this JSON.")},r.postMessage(n))}function Ve(e,t,n){var a,r;try{a=JSON.parse(e),!0===t?(N={},I={},s(),At(a[0])):(L=a[0],N=a[1],I=a[2],r=a[3],Object.keys(r).forEach(function(e){"string"==typeof r[e]&&""!==r[e]&&void 0!==l[e]&&(l[e]=r[e])}),S.uiTimeInputStartHr=a[4].uiTimeInputStartHr,S.uiScheduleNumOfHrsPerDay=a[4].uiScheduleNumOfHrsPerDay,$e())}catch(e){return void Ot(n)}try{ge(!0)}catch(e){return Ot(n),void jt()}A()}function ze(e){var t,e=e.target.files[0],n=O("settingsOnly").checked;if("json"!==e.name.substring(e.name.length-4))return O("inputJSON").reset(),O("settingsOnly").checked=!1,void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(t=new window.FileReader).onload=function(){Ve(t.result,n,0)},t.readAsText(e),O("inputJSON").reset(),O("settingsOnly").checked=!1}function Ue(e){e=e.target.files[0];if("csv"!==e.name.substring(e.name.length-3))return O("inputRENAME").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .csv file!"});window.Papa.parse(e,{header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t=[];if(e.data.length){if(!e.data[0].hasOwnProperty(l.oldNum)||!e.data[0].hasOwnProperty(l.newNum))return void window.mscAlert({title:"",subtitle:'File is missing the required headers: "'+l.oldNum+'" and "'+l.newNum+'".'});for(var n=0;n<e.data.length;n++)t.push([E(x(e.data[n][l.oldNum])),E(x(e.data[n][l.newNum]))])}!function(e){for(var t,n=e.length-1;0<=n;n--)null!=(t=c(e[n][0]))&&(e[n][0]=t);for(n=0;n<e.length;n++)try{O("newName-"+e[n][0]).value=e[n][1]}catch(e){continue}}(t),O("inputRENAME").reset()}})}function Ye(e,t){e=function(e,t){var n,a,r,s=0,i=Object.keys(e),d=["assgn","cat","dayhr","dept","duration","name","rm","times"],o=d.length;!0===t&&(i=i.map(function(e){return Number(e)}));for(a=i.length-1;0<=a;a--){for(n=!0,r=0;r<o;r++)(function(e,t){if(!t.hasOwnProperty(e))return!1;if("assgn"!==e&&""===t[e])return!1;if("name"===e&&(t[e].length!==S.courseNameNumLength||Number(t[e])<1||Number.isNaN(Number(t[e]))))return!1;if("dayhr"===e&&t[e][0].identical(t[e][1]))return!1;return!0})(d[r],e[i[a]])||(n=!1);!1===n&&(s+=1,!0===t?e.splice(a,1):delete e[i[a]])}return s}(e,void 0);0<e&&window.mscAlert({title:"",subtitle:e+' course(s) contain(s) exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),(!0!==t?Q:Ee)()}function Ze(e,t,n){var a={},n=f(e).split(n).filter(function(e){return""!==e});return a.a=n[0],1<n.length&&("onehour"===t||"ninety"===t)&&(a.b=n[1]),a}function Xe(e){var t=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter(function(e){return""!==e}),e="error";return e=t.length?t[0]:e}function Qe(e,t){return e>=Number(S.uiTimeInputStartHr)&&e<t}function et(e){var t=function(e){var t,n,a,r,s=function(e){var t={charArr:[],type:"error"},n=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter(function(e){return""!==e}),a=e.split(/[^0-9]/).filter(function(e){return""!==e}),r=n.length;return 2!==(e=a.length)&&4!==e&&8!==e||(2===r&&8===e&&(a.splice(0,0,n[0]),a.splice(5,0,n[1]),t.type="1"),1===r&&(4===e&&(t.type="2"),2===e&&(t.type="3"),a.unshift(n[0])),t.charArr=a),t}(e),e=s.charArr[2];if("error"===s.type)return s;if("3"===s.type&&"00"===e)return s.type="klinichour",s;"00"===e&&(t=Number(s.charArr[3])-Number(s.charArr[1]),"50"===s.charArr[4]&&("2"===s.type&&(1===t&&(s.type="twohour"),2===t&&(s.type="threehour")),"1"===s.type&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],0===t&&0===r&&"00"===n&&"50"===a&&(s.type="onehour"))),"15"===s.charArr[4]&&"1"===s.type&&1===t&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],1===r&&(s.type="ninety")));"30"===e&&"1"===s.type&&(t=Number(s.charArr[3])-Number(s.charArr[1]),"45"===s.charArr[4]&&1===t&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],1===r&&(s.type="ninety")));return s}(e),n=!1,e=Number(S.uiTimeInputStartHr)+Number(S.uiScheduleNumOfHrsPerDay),e={onehour:e,ninety:e-1,twohour:e-1,threehour:e-2,klinichour:e};if("error"!==t.type&&(n=Qe(Number(t.charArr[1]),e[t.type]),"klinichour"!==t.type&&(n=Qe(Number(t.charArr[3]),e[t.type]),"twohour"!==t.type&&"threehour"!==t.type&&(n=Qe(Number(t.charArr[6]),e[t.type])&&Qe(Number(t.charArr[8]),e[t.type])))),!0!==n)throw new Error("Unexpected day/time values");return t}function tt(e,t){var n=[];return n[0]=Boolean(!1),n[1]=Boolean(!1),"15"===e&&(n[0]=Boolean(!0)),"15"===t&&(n[1]=Boolean(!0)),n}function nt(e){var t="";return"error"!==e.type&&(t+=e.charArr[0]+""+e.charArr[1]+":"+e.charArr[2],"klinichour"!==e.type&&("twohour"!==e.type&&"threehour"!==e.type||(t+="-"+e.charArr[3]+":"+e.charArr[4]),"onehour"!==e.type&&"ninety"!==e.type||(t+=","+e.charArr[5]+e.charArr[6]+":"+e.charArr[7]))),t}function at(e){var t={"월":0,"화":1,"수":2,"목":3,"금":4,"토":5},n=[[],[]],a=Number(S.uiTimeInputStartHr);if("error"!==e.type&&(n[0][0]=t[e.charArr[0]],n[0][1]=Number(e.charArr[1])-a,"klinichour"!==e.type&&("twohour"!==e.type&&"threehour"!==e.type||(n[1][0]=t[e.charArr[0]],n[1][1]=Number(e.charArr[3])-a),"onehour"!==e.type&&"ninety"!==e.type||(n[1][0]=t[e.charArr[5]],n[1][1]=Number(e.charArr[6])-a)),"klinichour"===e.type&&(n[1][0]=t[e.charArr[0]],n[1][1]=Number(e.charArr[1])-a),n[0][0]===n[1][0]&&n[0][1]===n[1][1]&&(e.type="error")),"error"===e.type)throw new Error("Unexpected day/time values");return n}function rt(e){!function(e){var t,n,a=O("tchredt"+e),r=document.createDocumentFragment(),s=document.createElement("option"),i=L.teachers.length;if(k(a),s.value="",s.textContent="select teacher",r.appendChild(s),i)for(n=0;n<i;n++)(t=document.createElement("option")).value=""+L.teachers[n].en,t.textContent=t.value,r.appendChild(t);if(a.appendChild(r),a.options[0].disabled=!0,I[e].hasOwnProperty("tchr")&&""!==I[e].tchr)for(n=1;n<a.options.length;n++)if(I[e].tchr===a.options[n].value){a.selectedIndex=n;break}}(e),sn("tchrsee"+e),dn("tchrchg"+e)}function st(e){var t=O("tchrset"+e);"unassigned"!==t.textContent&&(t.textContent="unassigned",I[e].tchr="",it(e))}function it(e){(""!==I[e].tchr&&I[e].hasOwnProperty("tchr")?dn:sn)("tchrclr"+e)}function dt(){var e,t,n=L.indexData.schedules.length;for(O("showteachers").removeEventListener("click",dt,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",ot,{capture:!1,passive:!0}),O("showteachers").textContent="Hide",t=0;t<n;t++)it(e=L.indexData.schedules[t]),on(e),dn("tchrsee"+e)}function ot(){var e,t,n,a=L.indexData.schedules.length;for(O("showteachers").removeEventListener("click",ot,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",dt,{capture:!1,passive:!0}),O("showteachers").textContent="Show",t=0;t<a;t++)sn("tchrsee"+(e=L.indexData.schedules[t])),O(n=e).className=D(O(n).className,"show-teacher"),sn("tchrchg"+e)}function ct(e){var t,n=!1,a=L.teachers.length;if(a)for(t=0;t<a;t++)if(L.teachers[t].en.toLowerCase()===e.toLowerCase()){n=!0;break}return n}function lt(){var e,t,n=L.indexData.schedules.length;for(!function(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("alltchrs")),r=0;r<L.teachers.length;r++)e=document.createElement("div"),t=document.createElement("input"),n=document.createElement("input"),a=document.createElement("span"),e.id="prsn"+[r],t.type="text",t.id="prsnnm"+[r],t.className="inputstyle",t.value=L.teachers[r].en,t.maxLength=32,n.type="text",n.id="prsnKR"+[r],n.className="inputstyle",n.value=L.teachers[r].kor,n.maxLength=32,n.placeholder="csv name",a.id="prsndel"+[r],a.className="btn btn-xs btn-danger deletex pull-right",a.textContent="✖",e.appendChild(t),e.appendChild(n),e.appendChild(a),s.appendChild(e);O("alltchrs").appendChild(s)}(),sn("displayOverrides"),sn("left"),sn("right"),O("exit-tchrs").addEventListener("click",ut,{capture:!1,passive:!0}),O("save-tchrs").addEventListener("click",ht,{capture:!1,passive:!0}),O("alltchrs").addEventListener("click",$n,{capture:!1,passive:!0}),O("tchrs-file").addEventListener("change",Je,{capture:!1,passive:!0}),O("tchradd").addEventListener("click",pt,{capture:!1,passive:!0}),dn("tchrs-section"),t=0;t<n;t++)O(e=L.indexData.schedules[t]).classList.contains("show-teacher")&&(dn("tchrsee"+e),sn("tchrchg"+e))}function ut(){k(O("alltchrs")),sn("tchrs-section"),O("exit-tchrs").removeEventListener("click",ut,{capture:!1,passive:!0}),O("save-tchrs").removeEventListener("click",ht,{capture:!1,passive:!0}),O("alltchrs").removeEventListener("click",$n,{capture:!1,passive:!0}),O("tchrs-file").removeEventListener("change",Je,{capture:!1,passive:!0}),O("tchradd").removeEventListener("click",pt,{capture:!1,passive:!0}),dn("displayOverrides"),dn("left"),dn("right")}function pt(){an("","")}function ht(){var e,t,n,a,r=O("alltchrs").childNodes;for(L.teachers=[],a=0;a<r.length;a++)1==r[a].nodeType&&""!==r[a].childNodes[0].value&&void 0!==r[a].childNodes[0].value&&((e={}).en=r[a].childNodes[0].value,e.kor=r[a].childNodes[1].value,L.teachers.push(e));if(L.teachers.length){for(a=0;a<L.teachers.length;a++)L.teachers[a].en=x(y(L.teachers[a].en)),L.teachers[a].kor=x(y(L.teachers[a].kor));L.teachers.sort(function(e,t){return e.en.localeCompare(t.en)}),L.teachers=function(e,t){for(var n,a=[],r=e.length,s=0;s<r;s++){for(n=s+1;n<r;n++)e[s][t].toLowerCase()===e[n][t].toLowerCase()&&(n=++s);a.push(e[s])}return a}(L.teachers,"en")}for(t=L.indexData.schedules.length,a=0;a<t;a++)n=L.indexData.schedules[a],!I[n].hasOwnProperty("tchr")||""===I[n].tchr||L.teachers.length&&-1!==L.teachers.map(function(e){return e.en}).indexOf(I[n].tchr)||st(n);ut()}function mt(e){var t,n=!1,a=L.indexData.depts.length;if(a)for(t=0;t<a;t++)if(L.indexData.depts[t].shortcode===e){n=!0;break}return n}function ft(){nn("","")}function gt(e){for(var t,n=!0,a=L.indexData.courses.length,r=0;r<a;r++)if(t=L.indexData.courses[r],N[t].dept===e){n=!1;break}return n}function yt(){for(var e,t,n,a,r,s,i,d,o=O("deptEDIT").childNodes,c=[],l=[],u=o.length,p=0;p<u;p++)1==o[p].nodeType&&(e=g(o[p].childNodes[0].value),t=m(o[p].childNodes[1].value),n=L.indexData.depts.map(function(e){return e.shortcode}).indexOf(e),void 0!==e&&""!==e&&((a={}).shortcode=e,a.description=t,c.push(a),-1===n?L.indexData.depts.push(a):L.indexData.depts[n].description=t));for((u=L.indexData.depts.length)&&(L.indexData.depts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.indexData.depts=h(L.indexData.depts,"shortcode")),p=0;p<u;p++)s=L.indexData.depts[p].shortcode,-1===c.map(function(e){return e.shortcode}).indexOf(s)&&!0===gt(s)&&l.push(s);for(u=l.length,p=0;p<u;p++)for(i=L.indexData.depts.length-1;0<=i;i--)L.indexData.depts[i].shortcode===l[p]&&L.indexData.depts.splice(i,1);if(Zt(),(r=L.settings.deptGrps).length&&u)for(p=0;p<u;p++)for(i=0;i<r.length;i++)for(d=r[i].length-1;0<=d;d--)r[i][d]===l[p]&&r[i].splice(d,1);ve(),O("setting-section").classList.contains("nodisplay")?Xn():(Xt(),tn()),ya()}function vt(t){var e=L.indexData.depts.filter(function(e){return e.shortcode===t})[0];return null==e?"":e.description}function xt(e,t){var n=Number(O("newgroupid").dataset.grpindex),a=O(e),r=a.dataset.deptname,e=L.settings.deptGrps;if(!0===t)return a.style.backgroundColor="#3498db",a.style.color="#ffffff",a.style.borderColor="#3498db",e.length&&e[n]||L.settings.deptGrps.push([]),void(-1===e[n].indexOf(r)&&L.settings.deptGrps[n].push(r));a.style.backgroundColor="",a.style.color="",a.style.borderColor="",(e=L.settings.deptGrp)[n]&&e[n].length&&-1!==e[n].indexOf(r)&&L.settings.deptGrps[n].splice(L.settings.deptGrps[n].indexOf(r),1)}function wt(e){var t;e.target!==e.currentTarget&&"remove"==e.target.id.substring(0,6)&&(t=Number(e.target.id.substring(6)),L.settings.deptGrps[t]&&(t=t,L.settings.deptGrps.splice(t,1),O("newgroupid").dataset.grpindex=L.settings.deptGrps.length,tn())),e.stopPropagation()}function bt(){L.indexData.depts.length?(sn("displayOverrides"),O("left").style.visibility="hidden",O("right").style.visibility="hidden",O("exitklinicchanges").addEventListener("click",Dt,{capture:!1,passive:!0}),O("saveklinicchanges").addEventListener("click",qt,{capture:!1,passive:!0}),O("klinic-section").addEventListener("click",St,{capture:!1,passive:!0}),O("klinicadd").addEventListener("click",Qt,{capture:!1,passive:!0}),function(){var e,t,n,a,r,s,i,d,o,c,l,u,p,h;if(k(O("klinic-section")),L.indexData.klinics.length){for(e=document.createDocumentFragment(),t=L.indexData.klinics.length,p=0;p<t;p++){for(a=document.createElement("div"),r=document.createElement("input"),s=document.createElement("input"),i=document.createElement("select"),d=document.createElement("input"),o=document.createElement("span"),c=document.createElement("option"),n=L.indexData.klinics[p],o.id="kldel_"+p,o.className="btn btn-xs btn-danger deletex pull-right",o.textContent="✖",a.id="kl_"+p,r.id="klnm_"+p,r.type="text",r.className="btn-xs disabled",r.style.width="90px",r.style.verticalAlign="middle",r.style.padding="2px",r.value=n.name,s.id="klfn_"+p,s.type="text",s.className="inputStyle",s.style.width="160px",s.style.verticalAlign="middle",s.style.padding="2px",s.value=n.fullname,s.maxLength=32,s.placeholder="full .pdf name",i.id="kldp_"+p,i.className="select-styles",i.style.marginRight="1px",d.id="klrm_"+p,d.type="text",d.className="inputStyle",d.style.width="80px",d.style.verticalAlign="middle",d.style.padding="2px",d.value=n.rm.a,d.maxLength=8,d.placeholder="room",c.value="",c.textContent="dept",i.appendChild(c),h=0;h<L.indexData.depts.length;h++)(l=document.createElement("option")).value=L.indexData.depts[h].shortcode,l.textContent=l.value,i.appendChild(l);a.appendChild(r),a.appendChild(s),a.appendChild(i),a.appendChild(d),a.appendChild(o),e.appendChild(a)}for(O("klinic-section").appendChild(e),p=0;p<L.indexData.klinics.length;p++)for((u=O("kldp_"+p)).options[0].disabled=!0,h=1;h<u.options.length;h++)if(L.indexData.klinics[p].dept===u.options[h].value){u.selectedIndex=h;break}}}(),dn("defineklinics")):window.mscAlert({title:"",subtitle:"Please define at least one department first.\n(New course or category -> Edit departments)"})}function Dt(){sn("defineklinics"),O("exitklinicchanges").removeEventListener("click",Dt,{capture:!1,passive:!0}),O("saveklinicchanges").removeEventListener("click",qt,{capture:!1,passive:!0}),O("klinic-section").removeEventListener("click",St,{capture:!1,passive:!0}),O("klinicadd").removeEventListener("click",Qt,{capture:!1,passive:!0}),He(),O("left").style.visibility="visible",O("right").style.visibility="visible",dn("displayOverrides")}function Ct(e,t){var n;if(!0===t)for(n=0;n<e.length;n++)e[n]=e[n].toLowerCase();return e.length!==v(e).length}function Nt(){O("klinicHold").checked?L.tempKlinic.isHeld=!0:L.tempKlinic.isHeld=!1}function kt(e){O("klinicHold").checked="on"===e,Nt()}function Et(e,t){var n,a,r=function(e,t){var n,a,r=Ln(e),s="c1";if(4!==r.length)return;if(0!==r[1])return;n=[],e=[r[2],r[3]],n.push(e,e),L.indexData.courses.length&&(s="c"+(Number(L.indexData.courses[L.indexData.courses.length-1].substring(1))+1));if(t=L.indexData.klinics.map(function(e){return e.name}).indexOf(t),!L.indexData.klinics.length)return;if(-1===t)return;for(t=L.indexData.klinics[t],L.indexData.courses.push(s),N[s]={},N[s].cat="CLINIC",N[s].dept=t.dept,N[s].rm={},N[s].rm.a=t.rm.a,N[s].dayhr=n,N[s].name=t.name,N[s].fullname=t.fullname,N[s].times=function(e){return""+S.monToSatKr[e[0]]+("0"+(e[1]+Number(S.uiTimeInputStartHr))).slice(-2)+":00"}(e),N[s].duration="klinichour",N[s].assgn="",a=0;a<L.catData.length;a++)if(L.catData[a][0]===N[s].cat){L.catData[a][1]+=1,L.catData[a][2][N[s].dayhr[0][0]][N[s].dayhr[0][1]]+=1;break}!1===L.tempKlinic.isHeld&&(L.tempKlinic.kbtn="");return[r[0],s]}(e,t),s=L.catData.length;if(null!=r){for(a=0;a<s;a++)if(L.catData[a][0]===N[r[1]].cat){n=a+1;break}_t(r[1],n),ce(r[0],r[1])}}function St(e){e.target!==e.currentTarget&&"kldel_"===e.target.id.substring(0,6)&&(O("klnm_"+(e=(e=e.target.id).substring(6))).value="",O("klfn_"+e).value="",sn("kl_"+e))}function Lt(){var e=window.localStorage.getItem("lastStats"),t=window.localStorage.getItem("lastCourseData"),n=window.localStorage.getItem("lastScheduleData"),a=window.localStorage.getItem("lastCsvStrs"),r=window.localStorage.getItem("lastCfg");null!==e&&null!==t&&null!==n&&null!==r?(n="["+e+","+t+","+n,n+=null!==a?","+a:",{}",Ve(n+=","+r+"]",!1,1)):window.mscAlert({title:"",subtitle:"No previous session available."})}function It(){var e,t,n;if(!o(L)&&L.hasOwnProperty("catData")){if(L.catData.length){for(n=L.catData.length-1;0<=n;n--)"$deleted"===L.catData[n][0].substring(0,8)&&L.catData.splice(n,1);for(e=0,L.indexData.schedules.length>L.indexData.courses.length/(L.settings.maxHours/2)&&(e=L.indexData.schedules.length-Math.round(L.indexData.courses.length/(L.settings.maxHours/2))),n=L.indexData.schedules.length-1;0<=n;n--)if(!I[L.indexData.schedules[n]].cRef.length&&6===I[L.indexData.schedules[n]].dayOff){if(--e<=0)break;delete I[L.indexData.schedules[n]],L.indexData.schedules.splice(n,1)}}(t={}).uiTimeInputStartHr=S.uiTimeInputStartHr,t.uiScheduleNumOfHrsPerDay=S.uiScheduleNumOfHrsPerDay,window.localStorage.clear(),window.localStorage.setItem("lastStats",JSON.stringify(L)),window.localStorage.setItem("lastCourseData",JSON.stringify(N)),window.localStorage.setItem("lastScheduleData",JSON.stringify(I)),window.localStorage.setItem("lastCsvStrs",JSON.stringify(l)),window.localStorage.setItem("lastCfg",JSON.stringify(t))}}function Ot(e){L={},N={},I={},l={courseCat:d("courseCat"),courseNum:d("courseNum"),courseTime:d("courseTime"),courseRm:d("courseRm"),courseTchr:d("courseTchr"),oldNum:d("oldNum"),newNum:d("newNum")},xa(),O("inputJSON").reset(),O("settingsOnly").checked=!1,O("configStartHr").disabled=!1,O("configNumOfHrsPerDay").disabled=!1,dn("parsing"),window.mscAlert({title:"",subtitle:["The JSON file you have supplied cannot be used.","The last saved session is unusable and has been deleted."][e]}),1===e&&window.localStorage.clear()}function Pt(e,t,n){e=e+"_"+P((new Date).toDateString())+"."+t,n="csv"===t?window.Papa.unparse(n):n,t=new Blob([n],{type:S.uriTypes[t]});window.saveAs(t,e)}function Ht(e,t){var n={fields:[],data:[]};n.fields=e,n.data=t,Pt("CSV_ERRORS","csv",n)}function Tt(e,t){return("0"+(e+Number(S.uiTimeInputStartHr)+t).toString()).slice(-2)}function At(t){var e,n,a,r,s;if(!t.hasOwnProperty("settings"))throw new Error("Prop 'settings' is undefined.");if(!t.settings.hasOwnProperty("overrides"))throw new Error("Prop 'overrides' is undefined.");if("day"!==t.settings.deptGrpsSetBy&&"week"!==t.settings.deptGrpsSetBy||(L.settings.deptGrpsSetBy=t.settings.deptGrpsSetBy),t.settings.maxHours<=5*S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHours=t.settings.maxHours),t.settings.maxHrsPerDay<=S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHrsPerDay=t.settings.maxHrsPerDay),2!==t.settings.maxSeqHrs&&3!==t.settings.maxSeqHrs||(L.settings.maxSeqHrs=t.settings.maxSeqHrs),Object.keys(t.settings.overrides).forEach(function(e){"boolean"==typeof t.settings.overrides[e]&&void 0!==L.settings.overrides[e]&&(L.settings.overrides[e]=t.settings.overrides[e])}),t.settings.hasOwnProperty("deptGrps")&&t.settings.deptGrps.length)for(r=0;r<t.settings.deptGrps.length;r++)if((a=t.settings.deptGrps[r].map(g).filter(function(e){return""!==e})).length){for(e=-1,s=0;s<L.settings.deptGrps.length;s++)if(a.identical(L.settings.deptGrps[s])){e=1;break}1!==e&&(function(e){var t,n,a=e.length;if(a&&L.hasOwnProperty("indexData")&&L.indexData.hasOwnProperty("depts"))for(n=0;n<e.length;n++)!0!==mt(t=e[n])&&L.indexData.depts.push({shortcode:t,description:""})}(a),L.settings.deptGrps.push(a))}if(t.hasOwnProperty("teachers")&&t.teachers.length)for(r=0;r<t.teachers.length;r++){if(!t.teachers[r].hasOwnProperty("en"))throw new Error("Prop 'en' is undefined.");t.teachers[r].en=y(t.teachers[r].en),""!==(n=t.teachers[r]).en&&(!1!==ct(n.en)?L.teachers[e].kor=n.kor||L.teachers[e].kor:L.teachers.push(n))}if(t.hasOwnProperty("indexData")){if(t.indexData.hasOwnProperty("klinics")&&t.indexData.klinics.length)for(r=0;r<t.indexData.klinics.length;r++){if(!t.indexData.klinics[r].hasOwnProperty("name"))throw new Error("Prop 'name' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("fullname"))throw new Error("Prop 'fullname' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("dept"))throw new Error("Prop 'dept' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("rm"))throw new Error("Prop 'rm' is undefined.");if(!t.indexData.klinics[r].rm.hasOwnProperty("a"))throw new Error("Prop 'rm.a' is undefined.");if(t.indexData.klinics[r].dept=g(t.indexData.klinics[r].dept),t.indexData.klinics[r].rm.a=w(f(t.indexData.klinics[r].rm.a)),""===t.indexData.klinics[r].dept)throw new Error("Value of 'dept' is an empty string.");if(""===t.indexData.klinics[r].rm.a)throw new Error("Value of 'rm.a' is an empty string.");n=t.indexData.klinics[r],-1===(e=L.indexData.klinics.map(function(e){return e.name}).indexOf(n.name))?(t.indexData.hasOwnProperty("depts")&&!1===mt(t.indexData.klinics[r].dept)&&t.indexData.depts.push(t.indexData.klinics[r].dept),L.indexData.klinics.push(n)):(L.indexData.klinics[e].fullname=n.fullname,L.indexData.klinics[e].dept=n.dept,L.indexData.klinics[e].rm={},L.indexData.klinics[e].rm.a=n.rm.a)}if(t.indexData.hasOwnProperty("depts")&&t.indexData.depts.length)for(r=0;r<t.indexData.depts.length;r++){if(!t.indexData.depts[r].hasOwnProperty("shortcode"))throw new Error("Prop 'shortcode' is undefined.");t.indexData.depts[r].shortcode=g(t.indexData.depts[r].shortcode),""!==(n=t.indexData.depts[r]).shortcode&&(!1!==mt(n.shortcode)?L.indexData.depts[e].description=n.description||L.indexData.depts[e].description:L.indexData.depts.push(n))}}}function Rt(e,t){t=["Please choose a "+S.courseNameNumLength+" digit course name greater than zero.","A course named : "+t+" already exists.\nPlease choose a different name.","Please define all parameters.","Classes cannot have overlapping times!","Both classes cannot start at the same time!"];window.mscAlert({title:"",subtitle:t[e]})}function Ft(){var e,t,n,a,r,s,i,d,o=O("durationninety").checked?"ninety":O("durationtwo").checked?"twohour":O("durationthree").checked?"threehour":"onehour",c=(n=o,i={},r="",a=O("newhrsone").selectedIndex,s=O("newcourseroomB").value,i.newName=O("newcoursename").value,i.newRm={},i.newRm.a=O("newcourseroom").value,i.newCat=O("newcoursecat").options[O("newcoursecat").selectedIndex].value,i.newDept=O("newcoursedept").options[O("newcoursedept").selectedIndex].value,r+=""+O("newdayone").options[O("newdayone").selectedIndex].value+O("newhrsone").options[a].value,"twohour"!==n&&"threehour"!==n&&(r+=","+O("newdaytwo").options[O("newdaytwo").selectedIndex].value+O("newhrstwo").options[O("newhrstwo").selectedIndex].value),"twohour"===n&&(r+="-"+(a+10)+":50"),"threehour"===n&&(r+="-"+(a+11)+":50"),i.newTimes=r,i.newName=E(i.newName),i.newRm.a=b(i.newRm.a),""!==(s=b(s))&&s!==i.newRm.a&&(i.newRm.b=s),i),t=(e=o,t=[],n=[[0,0],[0,0]],a=O("newhrsone").selectedIndex,r=O("newhrstwo").selectedIndex,s=O("newdayone").selectedIndex,i=O("newdaytwo").selectedIndex,n[0][0]=s,"ninety"===e?(n[1][0]=i,a%2==1?(n[0][1]=(a-1)/2,t.push(Boolean(!1))):(n[0][1]=a/2,t.push(Boolean(!0))),r%2==1?(n[1][1]=(r-1)/2,t.push(Boolean(!1))):(n[1][1]=r/2,t.push(Boolean(!0)))):(n[0][1]=a,"twohour"===e?(n[1][0]=s,n[1][1]=a+1):"threehour"===e?(n[1][0]=s,n[1][1]=a+2):(n[1][0]=i,n[1][1]=r)),[n,t]),l="c1",u=L.indexData.courses.length;if(u&&(l="c"+(Number(L.indexData.courses[u-1].substring(1))+1)),c.newName.length!==S.courseNameNumLength||Number(c.newName)<1||Number.isNaN(Number(c.newName)))return Rt(0),"nada";for(d=0;d<u;d++)if(N[L.indexData.courses[d]].name===c.newName)return Rt(1,c.newName),"nada";if(""===c.newName||""===c.newCat||""===c.newDept||""===c.newRm.a)return Rt(2),"nada";if("ninety"==o&&t[0][0][0]===t[0][1][0])if(t[0][0][1]+1===t[0][1][1]){if(!0!==t[1][0]||!0===t[1][0]&&!1!==t[1][1])return Rt(3),"nada"}else if(t[0][0][1]===t[0][1][1]+1&&(!0!==t[1][1]||!0===t[1][1]&&!1!==t[1][0]))return Rt(3),"nada";if(t[0][0].identical(t[0][1]))return Rt(4),"nada";for(L.indexData.courses.push(l),N[l]={},N[l].cat=c.newCat,N[l].dept=c.newDept,N[l].rm={},N[l].rm.a=c.newRm.a,c.newRm.hasOwnProperty("b")&&(N[l].rm.b=c.newRm.b),N[l].dayhr=t[0],N[l].name=c.newName,N[l].times=c.newTimes,N[l].duration=o,N[l].assgn="",t[1].length&&(N[l].allowFollow=t[1]),d=0;d<L.catData.length;d++)if(L.catData[d][0]===N[l].cat){L.catData[d][1]+=1,L.catData[d][2][N[l].dayhr[0][0]][N[l].dayhr[0][1]]+=1,L.catData[d][2][N[l].dayhr[1][0]][N[l].dayhr[1][1]]+=1,"threehour"===N[l].duration&&(L.catData[d][2][N[l].dayhr[0][0]][N[l].dayhr[0][1]+1]+=1);break}return l}function Gt(e){var t,n,a,r,s,i,d=0;if(!function(){var e,t=L.newDepts.length;if(t){for(e=0;e<t;e++)L.indexData.depts.push(L.newDepts[e]);1<L.indexData.depts.length&&L.indexData.depts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.newDepts=[]}delete L.newDepts}(),!0===e)for(s=L.overwriteCourses.length-1;0<=s;s--)for(i=L.indexData.courses.length-1;0<=s;i--)if(t=L.overwriteCourses[s],n=N[L.indexData.courses[i]],t.name===n.name){t.cat!==n.cat&&(L.newCourses.push(t),L.overwriteCourses.splice(s,1),ee(L.indexData.courses[i]));break}if(L.indexData.courses.length&&(d=Number(L.indexData.courses[L.indexData.courses.length-1].substring(1))),L.newCourses.length)for(s=0;s<L.newCourses.length;s++)Te((n=L.newCourses[s]).cat)||Z(!1,n.cat),function(e,t){var n;for(L.indexData.courses.push(e),N[e]={},N[e].cat=t.cat,N[e].dept=t.dept,N[e].rm={},N[e].rm.a=t.rm.a,t.rm.hasOwnProperty("b")&&(N[e].rm.b=t.rm.b),N[e].dayhr=t.dayhr,N[e].name=t.name,N[e].times=t.times,N[e].duration=t.duration,N[e].assgn="",t.hasOwnProperty("allowFollow")&&(N[e].allowFollow=t.allowFollow),n=0;n<L.catData.length;n++)if(L.catData[n][0]===N[e].cat){L.catData[n][1]+=1,L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]]+=1,L.catData[n][2][N[e].dayhr[1][0]][N[e].dayhr[1][1]]+=1,"threehour"===N[e].duration&&(L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]+1]+=1);break}}("c"+ ++d,n);if(!function(){var e,t=L.newKlinicDefs.length;if(t){for(Te("CLINIC")||Z(!1,"CLINIC"),e=0;e<t;e++)-1===L.indexData.klinics.map(function(e){return e.name}).indexOf(L.newKlinicDefs[e].name)&&L.indexData.klinics.push(L.newKlinicDefs[e]);L.indexData.klinics.sort(function(e,t){return e.name.localeCompare(t.name)}),L.newKlinicDefs=[]}delete L.newKlinicDefs}(),!0===e)for(s=0;s<L.overwriteCourses.length;s++)a=function(e,t){for(var n in t)if(t[n].name===e)return n;return!1}((t=L.overwriteCourses[s]).name,N),(r=""+(n=N[a]).assgn)&&oe(r,a),n.dept=t.dept,n.rm={},n.rm.a=t.rm.a,t.rm.hasOwnProperty("b")&&(n.rm.b=t.rm.b),n.dayhr=t.dayhr,n.times=t.times,n.duration=t.duration,t.hasOwnProperty("allowFollow")&&(n.allowFollow=t.allowFollow),r&&($(r,a),q(r,a)||(Wn(r,a,"on"),Mn(r),me(r)));o(I)?(L.indexData.schedules=[],Ne(!0)):Ne(!1),X(),jt(),ge(!0),ea()}function Bt(e){for(var t,n,a,r,s,i,d=0;d<L.indexData.courses.length;d++)t=L.indexData.courses[d],"CLINIC"===(i=N[t]).cat&&i.name===e.name&&(i.fullname=e.fullname,i.dept=e.dept,i.rm={},i.rm.a=e.rm.a,i=s=r=a=n=void 0,n=N[t=t],a=""+n.assgn+t+"d"+n.dayhr[0][0]+"t"+n.dayhr[0][1],r=document.createDocumentFragment(),s=document.createElement("span"),i="",O(a).textContent=n.name+"("+n.dept+")",k(O("ref"+t)),i=n.name+" - "+n.dept+n.rm.a+" - "+n.times,i=document.createTextNode(i),s.id="sSgn"+t,s.className="sSgnd",r.appendChild(i),r.appendChild(s),O("ref"+t).appendChild(r),O("sSgn"+t).textContent=""+n.assgn)}function Kt(e){window.mscAlert({title:"",subtitle:["Each nickname can contain only English or Korean characters.","Please complete each full name with an appropriate description.","Please select the department.","Please check that each nickname is unique","Please check that each definition is unique."][e]})}function qt(){for(var e,t,n,a,r,s,i=O("klinic-section").childNodes,d=[],o=[],c=0;c<i.length;c++)1==(t=i[c]).nodeType&&((e={}).name=y(t.childNodes[0].value).replace(/\s/g,""),e.fullname=f(t.childNodes[1].value),e.dept=t.childNodes[2].value,e.rm={},e.rm.a=b(t.childNodes[3].value),d.push(e));if(d.length){for(n=[],a=[],c=d.length-1;0<=c;c--)if(""===d[c].name&&""===d[c].fullname)d.splice(c,1);else{if(""===d[c].name)return void Kt(0);if(""===d[c].fullname)return void Kt(1);if(""===d[c].dept)return void Kt(2);n.push(d[c].name),a.push(""+d[c].fullname+d[c].dept+d[c].rm.a)}if(!0===Ct(n,!1))return void Kt(3);if(!0===Ct(a,!0))return void Kt(4)}for(1<d.length&&d.sort(function(e,t){return e.name.localeCompare(t.name)}),c=0;c<L.indexData.klinics.length;c++)-1===(r=d.map(function(e){return e.name}).indexOf(L.indexData.klinics[c].name))?o.push(L.indexData.klinics[c].name):Bt(d[r]);if(o.length)for(c=o.length-1;0<=c;c--)for(s=L.indexData.courses.length-1;0<=s;s--)e=L.indexData.courses[s],"CLINIC"===N[e].cat&&N[e].name===o[c]&&ee(e);for(L.indexData.klinics=[],c=0;c<d.length;c++)L.indexData.klinics.push(d[c]);Dt()}function _t(e,t){var n=document.createDocumentFragment(),a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div"),d=document.createElement("span"),o=document.createElement("span"),c=document.createElement("span"),l=document.createElement("span"),u=N[e].name+" - "+N[e].dept+N[e].rm.a;N[e].rm.hasOwnProperty("b")&&(u+="/"+N[e].dept+N[e].rm.b),u+=" - "+N[e].times,"ninety"===N[e].duration&&(u+=" - (90분)"),u=document.createTextNode(u),a.id="contain"+e,a.className="row",r.className="col-lg-12",s.id="ref"+e,s.className="whitecircle",i.id="edredit-"+e,i.className="nodisplay",d.id="edrinit-"+e,d.className="btn-xs btn-warning pull-left nodisplay",d.textContent="Edit",o.id="edrsave-"+e,o.className="btn-xs btn-primary pull-left nodisplay",o.textContent="Save",c.id="sSgn"+e,c.className="sSgnd",l.id="edrdel-"+e,l.className="btn btn-xs btn-danger pull-right nodisplay",l.textContent="✖","CLINIC"===N[e].cat&&(i.className+=" disabled",d.className+=" disabled",o.className+=" disabled",l.className+=" disabled"),s.appendChild(u),s.appendChild(c),r.appendChild(d),r.appendChild(o),r.appendChild(s),r.appendChild(i),r.appendChild(l),a.appendChild(r),n.appendChild(a),O("courselist"+t).appendChild(n),Yn()}function Jt(e){var t=["A course with that name already exists!","Please choose a "+S.courseNameNumLength+" digit course name greater than zero.","Both classes cannot start at the same time!","Please define all parameters with appropriate values"];window.mscAlert({title:"",subtitle:t[e]})}function Mt(e){var t,n,a,r=((a={}).name=O("edrname-"+(t=e)).value,a.dept=O("edrdept-"+t).value,a.rmA=O("edrrm-"+t).value,a.rmB=null!==O("edrrmB-"+t)?O("edrrmB-"+t).value:"",a.timeDay1=""+O("edrday1-"+t).value+O("edrstart1-"+t).value,a.timeDay2=""+O("edrday2-"+t).value+O("edrstart2-"+t).value,a.idxDay1=O("edrday1-"+t).selectedIndex,a.idxStart1=O("edrstart1-"+t).selectedIndex,a.idxDay2=O("edrday2-"+t).selectedIndex,a.idxStart2=O("edrstart2-"+t).selectedIndex,a),s=N[e],i="";"CLINIC"!==s.cat&&(r.name=E(r.name),n=c(r.name),r.rmA=f(r.rmA),r.rmB=f(r.rmB),void 0===n||n===e?r.name.length!==S.courseNameNumLength||Number(r.name)<1||Number.isNaN(Number(r.name))?Jt(1):"twohour"!==(a=N[t=e]).duration&&"threehour"!==a.duration&&((n=[[],[]])[0].push(O("edrday1-"+t).selectedIndex),n[1].push(O("edrday2-"+t).selectedIndex),"ninety"===a.duration?(n[0].push(Math.floor(O("edrstart1-"+t).selectedIndex)/2),n[1].push(Math.floor(O("edrstart2-"+t).selectedIndex)/2)):(n[0].push(O("edrstart1-"+t).selectedIndex),n[1].push(O("edrstart2-"+t).selectedIndex)),n[0].identical(n[1]))?Jt(2):""!==r.rmA&&""!==r.name?(""!==s.assgn&&oe(i=""+s.assgn,e),Zn(e,!1),function(e,t){var n,a,r=N[e];if("CLINIC"===r.cat)return;for(a=0;a<L.catData.length;a++)if(L.catData[a][0]===r.cat){n=a;break}r.name=t.name,r.dept=t.dept,r.rm.a=t.rmA,r.rm.hasOwnProperty("b")&&delete r.rm.b;""!==t.rmB&&t.rmB!==r.rm.a&&(r.rm.b=t.rmB);e=t.timeDay1,"twohour"!==r.duration&&"threehour"!==r.duration&&(e+=","+t.timeDay2);"threehour"===r.duration&&(e+="-"+(t.idxStart1+11)+":50");"twohour"===r.duration&&(e+="-"+(t.idxStart1+10)+":50");r.times=e,(e=[[],[]])[0].push(r.dayhr[0][0]),e[0].push(r.dayhr[0][1]),e[1].push(r.dayhr[1][0]),e[1].push(r.dayhr[1][1]),--L.catData[n][2][e[0][0]][e[0][1]],--L.catData[n][2][e[1][0]][e[1][1]],"threehour"===r.duration&&--L.catData[n][2][e[0][0]][e[0][1]+1];r.dayhr[0][0]=t.idxDay1,"ninety"===r.duration?(r.dayhr[1][0]=t.idxDay2,t.idxStart1%2==1?(r.dayhr[0][1]=(t.idxStart1-1)/2,r.allowFollow[0]=!1):(r.dayhr[0][1]=t.idxStart1/2,r.allowFollow[0]=!0),t.idxStart2%2==1?(r.dayhr[1][1]=(t.idxStart2-1)/2,r.allowFollow[1]=!1):(r.dayhr[1][1]=t.idxStart2/2,r.allowFollow[1]=!0)):(r.dayhr[0][1]=t.idxStart1,"twohour"===r.duration||"threehour"===r.duration?(r.dayhr[1][0]=t.idxDay1,"twohour"===r.duration&&(r.dayhr[1][1]=t.idxStart1+1),"threehour"===r.duration&&(r.dayhr[1][1]=t.idxStart1+2)):(r.dayhr[1][0]=t.idxDay2,r.dayhr[1][1]=t.idxStart2));L.catData[n][2][r.dayhr[0][0]][r.dayhr[0][1]]+=1,L.catData[n][2][r.dayhr[1][0]][r.dayhr[1][1]]+=1,"threehour"===r.duration&&(L.catData[n][2][r.dayhr[0][0]][r.dayhr[0][1]+1]+=1);return!0}(e,r)&&(rn(e),i=i,"CLINIC"!==N[e=e].cat&&""!==i&&($(i,e),q(i,e)||(Wn(i,e,"on"),Mn(i),me(i))))):Jt(3):Jt(0))}function jt(){var e=document.createDocumentFragment(),t=document.createDocumentFragment(),n=document.createElement("option"),a=document.createElement("option");k(O("schedule-instances")),k(O("references")),k(O("newcoursecat")),k(O("newcoursedept")),n.textContent="select",n.value="",a.textContent="select",a.value="",e.appendChild(n),t.appendChild(a),O("newcoursecat").appendChild(e),O("newcoursedept").appendChild(t),O("newcoursecat").options[0].disabled=!0,O("newcoursedept").options[0].disabled=!0}function Wt(){for(var e,t={arr:[],lastEl:""},n=S.uiScheduleNumOfHrsPerDay-1,a=0;a<n;a++)e=("0"+(S.uiTimeInputStartHr+a)).slice(-2),t.arr.push(e+":00"),t.arr.push(e+":30");return t.lastEl+=S.uiTimeInputStartHr+(S.uiScheduleNumOfHrsPerDay-1)+":00",t}function $t(e){var t,n,a,r,s,i,d,o=Wt(),c=o.arr,l=c.length,u=document.createDocumentFragment(),p=document.createDocumentFragment();if(k(O("newhrsone")),k(O("newhrstwo")),"ninety"===e)for(d=0;d<l;d++)i=c[d],t=document.createElement("option"),n=document.createElement("option"),t.value=i,t.textContent=i,n.value=i,n.textContent=i,u.appendChild(t),p.appendChild(n);else{for(d=0;d<l;d+=2)i=c[d],a=document.createElement("option"),r=document.createElement("option"),a.value=i,a.textContent=i,r.value=i,r.textContent=i,u.appendChild(a),p.appendChild(r);"threehour"===e&&u.removeChild(u.lastChild),"onehour"===e&&(s=document.createElement("option"),e=document.createElement("option"),s.value=o.lastEl,s.textContent=o.lastEl,e.value=o.lastEl,e.textContent=o.lastEl,u.appendChild(s),p.appendChild(e))}O("newhrsone").appendChild(u),O("newhrstwo").appendChild(p)}function Vt(e){var t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span");k(O("catcontain"+e)),k(O("catref"+e)),k(O("courselist"+e)),n.id="catedt"+e,n.className="catedt btn-xs btn-warning pull-left nodisplay",n.textContent="Edit",n.style.display="none",a.id="bldr"+e,a.className="autobuilder pull-right icon-flash nodisplay",a.style.display="none",r.id="recycle"+e,r.className="pull-right recycler icon-recycle",r.style.display="none",t.appendChild(n),t.appendChild(a),t.appendChild(r),O("catref"+e).appendChild(t),O("list"+e).style.display="none",O("catcontain"+e).style.display="none",O("catref"+e).style.display="none",O("courselist"+e).style.display="none"}function zt(e,t){var n,a,r=T(0),s=S.monToSatEn.slice(),i="p16c",d=document.createDocumentFragment(),o=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),g=document.createElement("span"),y=document.createElement("span"),v=document.createElement("span"),x=document.createElement("span"),w=document.createElement("span"),b=document.createElement("select"),D=document.createElement("option");for("Sat"!==t&&(r.pop(),s.pop(),i="p20c"),o.id=""+e,o.className="col-lg-3 col-md-3 col-sm-3 col-xs-3 bordered",c.className="row text-center",c.style.paddingLeft="43px",c.textContent=I[e].display,g.id="del"+e,g.className="btn btn-xs btn-danger pull-right",g.textContent="✖",y.id="reset"+e,y.className="btn btn-xs icon-recycle pull-right",l.className="row text-center",u.id="tchrsee"+e,u.className="tchrsee nodisplay",v.id="tchrclr"+e,v.className="btn-xs btn-warning pull-left",v.textContent="Clear",x.id="tchrset"+e,x.className="btn-xs btn-whiteBlue tchrset",x.textContent="unassigned",p.id="tchrchg"+e,p.className="tchrchg nodisplay",w.id="tchrsve"+e,w.className="btn btn-xs btn-primary pull-left",w.textContent="Save",b.id="tchredt"+e,b.className="select-styles tchredt",D.value="",D.textContent="select teacher",h.id="catlist"+e,h.className="row text-center cat-list",m.className="row text-center dayofweek "+i,f.className="row text-center "+i,c.appendChild(g),c.appendChild(y),u.appendChild(v),u.appendChild(x),b.appendChild(D),p.appendChild(w),p.appendChild(b),l.appendChild(u),l.appendChild(p),n=0;n<s.length;n++){var C=document.createElement("div");C.textContent=s[n],m.appendChild(C)}for(o.appendChild(c),o.appendChild(l),o.appendChild(h),o.appendChild(m),n=0;n<r[0].length;n++){var N=document.createElement("div");for(N.className="row text-center "+i,a=0;a<r.length;a++){var k=document.createElement("div");k.id=e+"c0d"+[a]+"t"+[n],k.textContent="0",N.appendChild(k)}o.appendChild(N)}for(n=0;n<s.length;n++){var E=document.createElement("div");E.id="off"+[n]+e,E.className="dayoff",E.textContent="▲",f.appendChild(E)}o.appendChild(f),d.appendChild(o),O("schedule-instances").appendChild(d),O("tchredt"+e).options[0].disabled=!0,L.indexData.schedules.length&&O(L.indexData.schedules[0]).classList.contains("show-teacher")&&(dn("tchrsee"+e),on(e),it(e))}function Ut(e){var t=document.createDocumentFragment(),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("span"),d=document.createElement("span"),o=document.createElement("span"),c=document.createElement("span"),l=document.createElement("span"),u=document.createElement("input"),p=L.catData[e-1][0],h=document.createTextNode(p);n.id="list"+e,n.className=jn(p,!0)+"courselist",a.id="catcontain"+e,a.className="nodisplay",r.id="catref"+e,s.id="courselist"+e,s.className="hide",i.id="catsve"+e,i.className="btn btn-xs btn-primary pull-left",i.textContent="Rename",u.type="text",u.id="catchg"+e,u.className="inputstyle btn-xs","CLINIC"===p&&(u.className+=" disabled",i.textContent="Delete only"),u.value=p,d.id="catdel"+e,d.className="btn btn-xs btn-danger pull-right",d.textContent="✖",o.id="catedt"+e,o.className="catedt btn-xs btn-warning pull-left nodisplay",o.textContent="Edit",c.id="bldr"+e,c.className="autobuilder pull-right icon-flash nodisplay",l.id="recycle"+e,l.className="pull-right recycler icon-recycle",a.appendChild(i),a.appendChild(u),a.appendChild(d),r.appendChild(o),r.appendChild(h),r.appendChild(c),r.appendChild(l),n.appendChild(a),n.appendChild(r),t.appendChild(n),t.appendChild(s),O("references").appendChild(t)}function Yt(){var e,t,n,a=document.createDocumentFragment(),r=document.createElement("option");for(k(O("newcoursecat")),r.value="",r.textContent="select",a.appendChild(r),n=0;n<L.catData.length;n++)"CLINIC"!==(t=L.catData[n][0])&&"$deleted"!==t.substring(0,8)&&((e=document.createElement("option")).value=""+t,e.textContent=t,a.appendChild(e));O("newcoursecat").appendChild(a),O("newcoursecat").options[0].disabled=!0,O("newcoursecat").options[0].selected=!0}function Zt(){var e,t,n=document.createDocumentFragment(),a=document.createElement("option");for(k(O("newcoursedept")),a.value="",a.textContent="select",n.appendChild(a),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("option")).value=""+L.indexData.depts[t].shortcode,e.textContent=e.value,n.appendChild(e);O("newcoursedept").appendChild(n),O("newcoursedept").options[0].disabled=!0,O("newcoursedept").options[0].selected=!0}function Xt(){var e,t,n=document.createDocumentFragment();for(k(O("alldepartments")),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("span")).id="opt"+[t+1],e.dataset.deptname=""+L.indexData.depts[t].shortcode,e.className="btn btn-xs btn-dept",e.textContent=L.indexData.depts[t].shortcode,n.appendChild(e);O("alldepartments").appendChild(n)}function Qt(){var e,t,n=O("klinic-section").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("select"),o=document.createElement("input"),c=document.createElement("span"),l=document.createElement("option");for(c.id="kldel_"+n,c.className="btn btn-xs btn-danger deletex pull-right",c.textContent="✖",r.id="kl_"+n,s.id="klnm_"+n,s.type="text",s.className="btn-xs",s.style.width="90px",s.style.verticalAlign="middle",s.style.padding="2px",s.value="",s.maxLength=8,s.placeholder="nickname",i.id="klfn_"+n,i.type="text",i.className="inputStyle",i.style.width="160px",i.style.verticalAlign="middle",i.style.padding="2px",i.value="",i.maxLength=32,i.placeholder="full .pdf name",d.id="kldp_"+n,d.className="select-styles",d.style.marginRight="1px",o.id="klrm_"+n,o.type="text",o.className="inputStyle",o.style.width="80px",o.style.verticalAlign="middle",o.style.padding="2px",o.value="",o.maxLength=8,o.placeholder="room",l.value="",l.textContent="dept",d.appendChild(l),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("option")).value=""+L.indexData.depts[t].shortcode,e.textContent=e.value,d.appendChild(e);r.appendChild(s),r.appendChild(i),r.appendChild(d),r.appendChild(o),r.appendChild(c),a.appendChild(r),O("klinic-section").appendChild(a),O("kldp_"+n).options[0].disabled=!0}function en(){var e,t,n,a;if(k(O("klinicscontainer")),L.tempKlinic.kbtn="",L.indexData.klinics.length){for(e=document.createDocumentFragment(),function(){var e,t=L.catData.length;if(t)for(e=0;e<t;e++)if("CLINIC"===L.catData[e][0])return;L.catData.push(["CLINIC",0,T(0)]),Ut(t=L.catData.length),O("courselist"+t).setAttribute("class","show")}(),a=0;a<L.indexData.klinics.length;a++)t=document.createElement("span"),n=L.indexData.klinics[a].name,t.id="kbtn_"+n,t.className="btn btn-xs btn-whiteBlue",t.textContent=n,t.style.marginRight="5px",e.appendChild(t);O("klinicscontainer").appendChild(e),dn("klinicHolder"),dn("klinicscontainer")}else sn("klinicHolder")}function tn(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("allgroups")),a=0;a<L.settings.deptGrps.length;a++){for(e=document.createElement("div"),(t=document.createElement("span")).id="remove"+a,t.className="btn btn-xs btn-danger",t.textContent="delete",e.textContent="(",n=L.settings.deptGrps[a],r=0;r<n.length-1;r++)e.textContent+=n[r]+", ";e.textContent+=n[n.length-1]+") ",e.appendChild(t),s.appendChild(e)}O("allgroups").appendChild(s)}function nn(e,t){var n=O("deptEDIT").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("span");r.id="dpts"+n,s.type="text",s.id="deptnm"+n,s.className="inputstylenarrow",s.value=e,s.maxLength=8,s.placeholder="shortcode",i.type="text",i.id="ddesc"+n,i.className="inputstyle",i.value=t,i.maxLength=32,i.placeholder="description",d.id="deptdel"+n,d.className="btn btn-xs btn-danger deletex",d.textContent="✖",r.appendChild(s),r.appendChild(i),r.appendChild(d),a.appendChild(r),O("deptEDIT").appendChild(a)}function an(e,t){var n=O("alltchrs").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("span");r.id="prsn"+n,s.type="text",s.id="prsnnm"+n,s.className="inputstyle",s.value=e,s.maxLength=32,s.placeholder="new teacher",i.type="text",i.id="prsnKR"+n,i.className="inputstyle",i.value=t,i.maxLength=32,i.placeholder="csv name",d.id="prsndel"+n,d.className="btn btn-xs btn-danger deletex",d.textContent="✖",r.appendChild(s),r.appendChild(i),r.appendChild(d),a.appendChild(r),O("alltchrs").appendChild(a)}function rn(e){var t=N[e],n=document.createDocumentFragment(),a=document.createElement("span"),r=t.name+" - "+t.dept+t.rm.a,s="ref"+e;t.rm.hasOwnProperty("b")&&(r+="/"+t.dept+t.rm.b),r+=" - "+t.times,k(O(s)),"ninety"===t.duration&&(r+=" - (90분)"),a.id="sSgn"+e,a.className="sSgnd",r=document.createTextNode(r),n.appendChild(r),n.appendChild(a),O(s).appendChild(n)}function sn(e){O(e).classList.contains("nodisplay")||(O(e).className+=" nodisplay")}function dn(e){O(e).className=O(e).className.replace(/(?:^|\s)nodisplay(?!\S)/g,"")}function on(e){O(e).classList.contains("show-teacher")||(O(e).className+=" show-teacher")}function cn(e){e=O("courselist"+e.substring(6));"hide"!==e.getAttribute("class")?e.setAttribute("class","hide"):e.setAttribute("class","show")}function ln(e){var t=O(e),n=t.classList.contains("btn-warning");!0===t.classList.contains("btn-primary")?sa(!1,e):!0===n&&sa(!0,e)}function un(){ln("updateHdrsA")}function pn(){ln("updateHdrsB")}function hn(){var e,t;O("deptEDIT").removeEventListener("click",ta,{capture:!1,passive:!0}),O("deptEDIT-file").removeEventListener("change",Me,{capture:!1,passive:!0}),O("deptopenR").removeEventListener("click",ga,{capture:!1,passive:!0}),O("save-deptEDIT").removeEventListener("click",yt,{capture:!1,passive:!0}),O("deptEDITadd").removeEventListener("click",ft,{capture:!1,passive:!0}),O("exit-deptEDIT").removeEventListener("click",ya,{capture:!1,passive:!0}),O("jsonSettings-file").removeEventListener("change",We,{capture:!1,passive:!0}),O("alldepartments").removeEventListener("click",aa,{capture:!1,passive:!0}),O("newgroupid").removeEventListener("click",na,{capture:!1,passive:!0}),O("allgroups").removeEventListener("click",wt,{capture:!1,passive:!0}),O("seqHrsTwo").removeEventListener("click",n,{capture:!1,passive:!0}),O("seqHrsThree").removeEventListener("click",a,{capture:!1,passive:!0}),O("hrsPerSchedule").removeEventListener("input",ia,{capture:!1,passive:!0}),O("hrsPerDay").removeEventListener("input",da,{capture:!1,passive:!0}),O("save-settings").removeEventListener("click",hn,{capture:!1,passive:!0}),e=Number(O("hrsPerSchedule").value),t=Number(O("hrsPerDay").value),1<=e&&e<=5*S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHours=e),1<=t&&t<=S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHrsPerDay=t),ve(),Qn(),sn("setting-section"),dn("displayOverrides"),dn("left"),dn("right")}function mn(){dn("information"),sn("parsing")}function fn(){sn("information"),dn("parsing")}function gn(){dn("information"),sn("displayOverrides"),sn("left"),sn("right")}function yn(){sn("information"),dn("displayOverrides"),dn("left"),dn("right")}function vn(){O("exit-stats").removeEventListener("click",vn,{capture:!1,passive:!0}),sn("statistics"),dn("displayOverrides"),dn("left"),dn("right")}function xn(){sn("displayOverrides"),O("left").style.visibility="hidden",O("right").style.visibility="hidden",O("deptEDIT").addEventListener("click",ta,{capture:!1,passive:!0}),O("deptEDIT-file").addEventListener("change",Me,{capture:!1,passive:!0}),O("csv-freshfile").addEventListener("change",_e,{capture:!1,passive:!0}),O("deptopenL").addEventListener("click",ga,{capture:!1,passive:!0}),O("save-deptEDIT").addEventListener("click",yt,{capture:!1,passive:!0}),O("deptEDITadd").addEventListener("click",ft,{capture:!1,passive:!0}),O("exit-deptEDIT").addEventListener("click",ya,{capture:!1,passive:!0}),O("newcourseform").addEventListener("click",Bn,{capture:!1,passive:!0}),O("newcoursename").addEventListener("input",oa,{capture:!1,passive:!0}),O("newcourseroom").addEventListener("input",ca,{capture:!1,passive:!0}),O("durationone").addEventListener("click",Dn,{capture:!1,passive:!0}),O("durationninety").addEventListener("click",Cn,{capture:!1,passive:!0}),O("durationtwo").addEventListener("click",Nn,{capture:!1,passive:!0}),O("durationthree").addEventListener("click",kn,{capture:!1,passive:!0}),dn("newcoursemodal")}function wn(e,t){if(!0===L.settings.overrides[e])return L.settings.overrides[e]=!1,void(O(t).className=D(O(t).className,"bypass"));L.settings.overrides[e]=!0,O(t).className+=" bypass"}function bn(e){O("select-styleF").style.visibility=e,O("select-styleG").style.visibility=e,O("newcourseroomB").style.visibility=e}function Dn(){$t("onehour"),bn("visible")}function Cn(){$t("ninety"),bn("visible")}function Nn(){$t("twohour"),bn("hidden")}function kn(){$t("threehour"),bn("hidden")}function En(){dn("chooseexistingcats"),sn("choosenewcat")}function Sn(e){dn("catref"+e),sn("catcontain"+e)}function Ln(e){e=e.split(/[scdt]/).map(Number);return e.shift(),e}function In(e,t){var n,a,r=t.substring(3);""!==(a=N[""+t.substring(3)].assgn)&&(O(a).scrollIntoView({behavior:"smooth",block:"center"}),O(a).className+=" highlight",n=window.setTimeout(function(){O(a).className=D(O(a).className,"highlight"),window.clearTimeout(n)},3e3)),Kn(e)&&("CLINIC"!==N[r].cat?qn(e)?(L.tempCparam=""+r,O(t).style.backgroundColor="#2c3e50",O(t).style.color="#ffffff"):""!==N[t=r].assgn&&oe(N[t].assgn,t):ee(r))}function On(e){var t,n=e.substring(0,8),a=e.substring(8);"edrinit-"!==n?"edrsave-"!==n?"edrdel-"===e.substring(0,7)&&(t=e.substring(7),window.mscConfirm({title:"Delete course?",subtitle:"Are you sure you want to delete this course?\nThis action cannot be undone!",onOk:function(){ee(t)},onCancel:function(){}})):Mt(a):function(e){var t,n,a,r,s,i,d,o,c,l,u,p,h,m,f,g,y,v,x,w,b,D,C;if("CLINIC"!==N[e].cat){for(n=(t=Wt()).arr,a=S.monToSatKr.slice(),r=document.createDocumentFragment(),s=document.createElement("input"),i=document.createElement("input"),o=document.createElement("select"),c=document.createElement("select"),l=document.createElement("select"),u=document.createElement("select"),p=document.createElement("select"),h=document.createElement("span"),k(O("edredit-"+e)),s.id="edrname-"+e,s.type="number",s.className="btn-xs",s.style.width="60px",s.style.verticalAlign="middle",s.style.padding="2px",s.value=N[e].name,s.maxLength=S.courseNameNumLength,s.minLength=S.courseNameNumLength,s.min=Math.pow(10,S.courseNameNumLength-1).toString().split("").reverse().join(""),s.max=""+(Math.pow(10,S.courseNameNumLength)-1),o.id="edrdept-"+e,o.className="select-styles",o.style.marginRight="1px",i.id="edrrm-"+e,i.type="text",i.className="inputStyle",i.style.width="80px",i.style.verticalAlign="middle",i.style.padding="2px",i.value=N[e].rm.a,"onehour"!==N[e].duration&&"ninety"!==N[e].duration||((d=document.createElement("input")).id="edrrmB-"+e,d.type="text",d.className="inputStyle",d.style.width="80px",d.style.verticalAlign="middle",d.style.padding="2px",d.value=N[e].rm.b||N[e].rm.a),c.id="edrday1-"+e,c.className="select-styles",l.id="edrday2-"+e,l.className="select-styles",u.id="edrstart1-"+e,u.className="select-styles",p.id="edrstart2-"+e,p.className="select-styles",h.id="edrduration-"+e,"ninety"===N[e].duration&&(h.textContent=" 90분(2)"),"twohour"===N[e].duration&&(h.textContent=" 2시간(1)"),"threehour"===N[e].duration&&(h.textContent=" 3시간(1)"),"onehour"===N[e].duration&&(h.textContent=" 1시간(2)"),C=0;C<L.indexData.depts.length;C++)(m=document.createElement("option")).value=L.indexData.depts[C].shortcode,m.textContent=m.value,o.appendChild(m);for(C=0;C<a.length;C++)f=document.createElement("option"),g=document.createElement("option"),f.value=a[C],f.textContent=f.value,g.value=f.value,g.textContent=f.value,c.appendChild(f),l.appendChild(g);if("ninety"===N[e].duration)for(C=0;C<n.length;C++)y=document.createElement("option"),v=document.createElement("option"),y.value=n[C],y.textContent=y.value,v.value=y.value,v.textContent=v.value,u.appendChild(y),p.appendChild(v);else{for(C=0;C<n.length;C+=2)x=document.createElement("option"),w=document.createElement("option"),x.value=n[C],x.textContent=x.value,w.value=x.value,w.textContent=x.value,u.appendChild(x),p.appendChild(w);"threehour"===N[e].duration&&u.removeChild(u.lastChild),"onehour"===N[e].duration&&(b=document.createElement("option"),D=document.createElement("option"),b.value=t.lastEl,b.textContent=t.lastEl,D.value=t.lastEl,D.textContent=t.lastEl,u.appendChild(b),p.appendChild(D))}r.appendChild(s),r.appendChild(o),r.appendChild(i),"onehour"!==N[e].duration&&"ninety"!==N[e].duration||r.appendChild(d),r.appendChild(c),r.appendChild(u),r.appendChild(l),r.appendChild(p),r.appendChild(h),O("edredit-"+e).appendChild(r),fe(e)}}(a)}function Pn(e){var t,n=e.substring(0,6),a=e.substring(6);switch(n){case"catedt":sn("catref"+(t=a)),dn("catcontain"+t);break;case"catsve":!function(e){var t,n,a,r,s,i,d,o=Number(e)-1,c=C(m(O("catchg"+e).value)),l=L.indexData.courses.length;if(""!==c){if(null!=L.catData[o]&&!Number.isNaN(Number(o)))if(L.catData[o][0]!==c){for(d=0;d<L.catData.length;d++)if(L.catData[d][0]===c&&o!==d)return"clinic"===c.toLowerCase()?ne(1):window.mscConfirm({title:"Merge!",subtitle:'This action will move courses from: "'+L.catData[o][0]+'" and place them under: "'+L.catData[d][0]+'".\nThe category "'+L.catData[o][0]+'" will be deleted.\nThis action cannot be undone. Proceed?',onOk:function(){te(L.catData[d][0],L.catData[o][0])},onCancel:function(){}});for(d=0;d<l;d++)(i=N[L.indexData.courses[d]]).cat===L.catData[o][0]&&(i.cat=""+c);L.catData[o][0]=""+c,k(O("catref"+e)),t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span"),s=document.createTextNode(L.catData[o][0]),n.id="catedt"+e,n.className="catedt btn-xs btn-warning pull-left nodisplay",n.textContent="Edit",a.id="bldr"+e,a.className="autobuilder pull-right icon-flash nodisplay",r.id="recycle"+e,r.className="pull-right recycler icon-recycle",t.appendChild(n),t.appendChild(s),t.appendChild(a),t.appendChild(r),O("catref"+e).appendChild(t),6<Number(L.catData[o][1])&&dn("bldr"+e),O("catchg"+e).value=c,Sn(e),ae(c)}else Sn(e)}else ne(0)}(a);break;case"catdel":re(a);break;case"catref":cn(e);break;default:return}}function Hn(e){var t;if(""!==L.tempCparam&&(O("ref"+L.tempCparam).style.backgroundColor="",O("ref"+L.tempCparam).style.color=""),kt("off"),""!==L.tempKlinic.kbtn&&(Tn(null,"off"),L.tempKlinic.kbtn=""),e.target!==e.currentTarget)switch((t=e.target.id).substring(0,3)){case"rec":!function(e){var t,n,a=Number(e.substring(7))-1,r=L.catData[a][0];if(!0===Te(r)){for(t=[],O("courselist"+e.substring(7)).setAttribute("class","hide"),n=L.indexData.courses.length-1;0<=n;n--)N[L.indexData.courses[n]].cat===r&&""!==N[L.indexData.courses[n]].assgn&&(t.push(N[L.indexData.courses[n]].assgn),"CLINIC"===r?ee(L.indexData.courses[n]):oe(N[L.indexData.courses[n]].assgn,L.indexData.courses[n]));if(t.length)for(t=v(t),n=0;n<t.length;n++)0===I[t[n]].cRef.length&&he("reset"+t[n])}}(t);break;case"bld":Fe(t);break;case"ref":In(e,t);break;case"cat":Pn(t);break;case"edr":On(t);break;default:return}e.stopPropagation()}function Tn(e,t){var n,a,r=O("klinicscontainer");if(r.hasChildNodes())for(n=r.childNodes,a=0;a<n.length;a++)n[a].className=D(n[a].className,"active");"on"===t&&(O("kbtn_"+e).className+=" active")}function An(e,t){var n,a,r=Ln(t);4===r.length&&(a="c0",0!==r[1]&&(a="c"+r[1]),0===r[1]?""===L.tempKlinic.kbtn?Kn(e)&&qn(e)&&""!==L.tempCparam?"CLINIC"!==N[L.tempCparam].cat&&(ce(r[0],L.tempCparam),L.tempCparam=""):_n(e.target.id,r):(n=""+L.tempKlinic.kbtn,Et(e.target.id,n),!1===L.tempKlinic.isHeld&&(L.tempKlinic.kbtn="")):"CLINIC"!==N[a].cat?Kn(e)?(n="s"+(t=r)[0],0!==t[1]&&(t="c"+t[1],-1!==I[n].cRef.indexOf(t)&&oe(n,t))):_n(e.target.id,r):(Tn(null,"off"),L.tempKlinic.kbtn="",ee(a)))}function Rn(e){var t,n,a,r;""!==L.tempCparam&&(O("ref"+L.tempCparam).style.backgroundColor="",O("ref"+L.tempCparam).style.color=""),""!==L.tempKlinic.kbtn&&!1===L.tempKlinic.isHeld&&Tn(null,"off"),""===L.tempKlinic.kbtn&&!1!==L.tempKlinic.isHeld&&(kt("off"),Tn(null,"off")),e.target!==e.currentTarget&&("s"===(t=e.target.id).substring(0,1)?An(e,t):"del"===(n=t.substring(0,3))?(r=t.substring(3),window.mscConfirm({title:"Delete schedule?",subtitle:"Are you sure you want to delete this schedule?\nThis action cannot be undone!",onOk:function(){ue(r)},onCancel:function(){}})):"off"===n?Kn(e)?(a=(n=t).substring(4),(n=Number(n.substring(3,4)))===I[a].dayOff&&(O("off"+n+a).style.color="",I[a].dayOff=6)):ie(t):"tchr"===(a=t.substring(0,4))?function(e){var t=e.substring(4,7),n=e.substring(7);switch(t){case"set":rt(n);break;case"clr":st(n);break;case"sve":!function(e){var t,n,a;if(L.teachers.length){var r=O("tchredt"+e).options[O("tchredt"+e).selectedIndex].value;if(""!==r){for(n=L.indexData.schedules.length,a=0;a<n;a++)if(t=L.indexData.schedules[a],I[t].hasOwnProperty("tchr")&&t!==e&&I[t].tchr===r)return window.mscAlert({title:"",subtitle:r+" has already been assigned to schedule "+t}),st(e),sn("tchrchg"+e),dn("tchrsee"+e),0;O("tchrset"+e).textContent=r}else O("tchrset"+e).textContent="unassigned";I[e].tchr=r}sn("tchrchg"+e),it(e),dn("tchrsee"+e)}(n);break;default:;}}(t):"rese"===a&&he(t),e.stopPropagation())}function Fn(e){if(e.target!==e.currentTarget){var t=e.target.id;if("kbtn_"===t.substring(0,5))n=t,!(Kn(e)?(L.tempKlinic.kbtn="",Tn(null,"off"),0):(L.tempKlinic.kbtn=n.substring(5),void Tn(L.tempKlinic.kbtn,"on")));else switch(t){case"addnewcourse":xn();break;case"renamer":!function(){var e,t,n=L.indexData.courses.length;for(sn("renamer"),t=0;t<n;t++)e=L.indexData.courses[t],"CLINIC"!==N[e].cat&&(O("edredit-"+e).hasChildNodes&&k(O("edredit-"+e)),O("edrinit-"+e).style.display="none",O("edrsave-"+e).style.display="none",O("edrdel-"+e).style.display="none",O("ref"+e).style.display="none",O("edredit-"+e).style.display="inline-block",function(e){var t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("input"),r=document.createTextNode(" -> ");n.textContent=N[e].name,n.style.paddingLeft="60px",a.id="newName-"+e,a.type="number",a.className="btn-xs",a.style.width="60px",a.style.verticalAlign="middle",a.style.padding="2px",a.value="",a.maxLength=S.courseNameNumLength,a.minLength=S.courseNameNumLength,a.min=Math.pow(10,S.courseNameNumLength-1).toString().split("").reverse().join(""),a.max=""+(Math.pow(10,S.courseNameNumLength)-1),t.appendChild(n),t.appendChild(r),t.appendChild(a),O("edredit-"+e).appendChild(t)}(e));for(t=0;t<L.catData.length;t++)cn("catref"+[t+1]),sn("catedt"+[t+1]);dn("newCNames"),sn("purger"),sn("addnewcourse"),sn("openklinics")}();break;case"purger":se();break;case"openklinics":bt();break;case"coursefinder":la();break;case"savenewCNames":be();break;case"exitnewCNames":ra();break;default:return}}var n;e.stopPropagation()}function Gn(e){if(e.target!==e.currentTarget){var t=e.target.id;switch(t){case"deptgrpsbyps":wn("deptGrps","deptgrpsbyps");break;case"dayhrsbyps":case"dayhrsset":wn("maxHrsPerDay","dayhrsbyps");break;case"downloadjson":!function(){var e,t=0,n=JSON.parse(JSON.stringify(L)),a=JSON.parse(JSON.stringify(I)),r={uiTimeInputStartHr:S.uiTimeInputStartHr,uiScheduleNumOfHrsPerDay:S.uiScheduleNumOfHrsPerDay},s=[];if(n.catData.length)for(e=n.catData.length-1;0<=e;e--)"$deleted"===n.catData[e][0].substring(0,8)&&n.catData.splice(e,1);for(n.indexData.schedules.length>n.indexData.courses.length/(n.settings.maxHours/2)&&(t=n.indexData.schedules.length-Math.round(n.indexData.courses.length/(n.settings.maxHours/2))),e=n.indexData.schedules.length-1;0<=e;e--)if(!a[n.indexData.schedules[e]].cRef.length&&6===a[n.indexData.schedules[e]].dayOff){if(--t<=0)break;delete a[n.indexData.schedules[e]],n.indexData.schedules.splice(e,1)}s.push(n),s.push(N),s.push(a),s.push(l),s.push(r),Pt("Schedules_","json",JSON.stringify(s))}();break;case"downloadcsv":!function(){for(var e,t,n={fields:[l.courseCat,l.courseNum,l.courseTchr,"대상학과",l.courseTime,l.courseRm],data:[]},a=["월","화","수","목","금","토"],r=L.indexData.courses.length,s={},i=[],d=0;d<r;d++)t=N[L.indexData.courses[d]],s.tmeStr="",s.rmStr="",s.numStr="00",i=[t.cat,t.name,"","","",""],s.krDay0=a[t.dayhr[0][0]],s.krDay1=a[t.dayhr[1][0]],s.dyhr01=t.dayhr[0][1],s.dyhr11=t.dayhr[1][1],s.sRef=I[t.assgn],""!==t.assgn&&s.sRef.hasOwnProperty("tchr")&&(-1!==(e=L.teachers.map(function(e){return e.en}).indexOf(s.sRef.tchr))&&""!==L.teachers[e].kor?i[2]=L.teachers[e].kor:i[2]=s.sRef.tchr),"onehour"===t.duration&&(s.numStr=Tt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼"+s.numStr+":50) ",s.numStr=Tt(s.dyhr11,0),s.tmeStr+=s.krDay1+"("+s.numStr+":00∼"+s.numStr+":50)"),"twohour"!==t.duration&&"threehour"!==t.duration||(s.numStr=Tt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼","twohour"===t.duration&&(s.numStr=Tt(s.dyhr01,1)),"threehour"===t.duration&&(s.numStr=Tt(s.dyhr01,2)),s.tmeStr+=s.numStr+":50)"),"ninety"===t.duration&&(s.numStr=Tt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr,s.numStr=Tt(s.dyhr01,1),!0===t.allowFollow[0]&&(s.tmeStr+=":00∼"+s.numStr+":15) "),!1===t.allowFollow[0]&&(s.tmeStr+=":30∼"+s.numStr+":45) "),s.numStr=Tt(s.dyhr11,0),s.tmeStr+=s.krDay1+"("+s.numStr,s.numStr=Tt(s.dyhr11,1),!0===t.allowFollow[1]&&(s.tmeStr+=":00∼"+s.numStr+":15)"),!1===t.allowFollow[1]&&(s.tmeStr+=":30∼"+s.numStr+":45)")),"klinichour"===t.duration&&(s.numStr=Tt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼"+s.numStr+":50)"),i[4]=s.tmeStr,s.rmStr=t.dept+t.rm.a,t.rm.hasOwnProperty("b")&&t.rm.a!==t.rm.b&&(s.rmStr+=" "+t.dept+t.rm.b),i[5]=s.rmStr,n.data.push(i);Pt("AllCourseData_","csv",n)}();break;case"downloadpdf":case"dlklinicpdf":Ke(t);break;case"newmontofri":pe("MtoF"),O("pagebottom").scrollIntoView({behavior:"smooth"});break;case"newmontosat":pe("Sat"),O("pagebottom").scrollIntoView({behavior:"smooth"});break;case"schedhrsbyps":case"schedhrsset":wn("maxHours","schedhrsbyps");break;case"seqhrsbyps":case"seqhrsset":wn("maxSeqHrs","seqhrsbyps");break;case"open-settings":xe();break;case"updatenames":lt();break;default:return}}e.stopPropagation()}function Bn(e){if(e.target!==e.currentTarget)switch(e.target.id){case"newcoursecatmake":sn("chooseexistingcats"),dn("choosenewcat");break;case"savenewcat":Z(!0,O("definenewcat").value);break;case"savecoursechanges":!function(){var e,t,n,a=L.catData.length;if(a){if("nada"!==(t=Ft())){for(O("newcoursename").value="",O("newcourseroom").value="",O("newcourseroomB").value="",O("newcoursecat").selectedIndex=0,O("newcoursedept").selectedIndex=0,O("newdayone").selectedIndex=0,O("newhrsone").selectedIndex=0,O("newdaytwo").selectedIndex=0,n=O("newhrstwo").selectedIndex=0;n<a;n++)if(L.catData[n][0]===N[t].cat){e=n+1;break}_t(t,e),window.mscConfirm({title:"Success!",subtitle:"Course: "+N[t].name+" has been created.\nCreate another?",cancelText:"Exit",onOk:function(){},onCancel:function(){ea(),Vn(t)}})}}else window.mscAlert({title:"",subtitle:"At least one category must be defined before a course can be created."})}();break;case"exitchoosenewcat":En();break;case"exitcoursechanges":ea();break;default:return}e.stopPropagation()}function Kn(e){return!!e.shiftKey}function qn(e){return!!e.altKey}function _n(e,t){var n,a,r="s"+t[0],s=[t[2],t[3]];0===t[1]&&("nada"!==(n=function(e,t){var n,a,r,s,i;for(Jn(),n="nada",a=L.indexData.courses.length,i=0;i<a;i++)if(r=L.indexData.courses[i],G(r)&&(s=de(r,t),!0===s&&!0===z(e,r)&&($(e,r),!q(e,r))))return n=r;return n}(r,s))?(Wn(r,n,"on"),Mn(r)):(O(e).textContent="X",a=window.setTimeout(function(){O(e).textContent="0",window.clearTimeout(a)},800))),0!==t[1]&&("nada"!==(t=function(e,t,n){var a,r,s;for(Jn(),a="nada",s=L.indexData.courses.indexOf(n);s<L.indexData.courses.length;s++)if(L.indexData.courses[s]!==n&&G(L.indexData.courses[s])&&(r=de(L.indexData.courses[s],t),!0===r&&!0===z(e,L.indexData.courses[s]))){if(oe(e,n),$(e,L.indexData.courses[s]),!q(e,L.indexData.courses[s]))return a=L.indexData.courses[s];$(e,n),Wn(e,n,"on")}return a}(r,s,s="c"+t[1]))?(Wn(r,t,"on"),Mn(r)):oe(r,s)),me(r)}function Jn(){L.indexData.klinics.length||(kt("off"),Tn(null,"off"),L.tempKlinic.kbtn="")}function Mn(e){O("catlist"+e).textContent=le(e)}function jn(e,t){for(var n=S.alphabet,a="",r=!0===t?e:N[e].cat,s=L.catData.length,i=0;i<s;i++)if(L.catData[i][0]===r){if(i>=n.length){a=n[i-n.length];break}a=n[i];break}return a}function Wn(e,t,n){var a,r,s,i,d,o,c=N[t];"off"===n?(a=""+e+t+"d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],r=""+e+t+"d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],d=e+"c0d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],o=e+"c0d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],"threehour"===c.duration&&(s=""+e+t+"d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1),i=e+"c0d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1)),O(a).setAttribute("id",d),O(d).className="",O(d).textContent="0","klinichour"!==c.duration&&(O(r).setAttribute("id",o),O(o).className="",O(o).textContent="0"),"threehour"===c.duration&&(O(s).setAttribute("id",i),O(i).className="",O(i).textContent="0")):(a=e+"c0d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],r=e+"c0d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],d=""+e+t+"d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],o=""+e+t+"d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],"threehour"===c.duration&&(s=e+"c0d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1),i=""+e+t+"d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1)),O(a).setAttribute("id",d),O(d).className="selected"+jn(t,!1),O(d).textContent=c.name+"("+c.dept+")","klinichour"!==c.duration&&(O(r).setAttribute("id",o),O(o).className="selected"+jn(t,!1),O(o).textContent=c.name+"("+c.dept+")"),"threehour"===c.duration&&(O(s).setAttribute("id",i),O(i).className="selected"+jn(t,!1),O(i).textContent=c.name+"("+c.dept+")")),"init"!==n&&Vn(t),zn(t)}function $n(e){var t;e.target!==e.currentTarget&&"prsndel"==e.target.id.substring(0,7)&&(O("prsnnm"+(t=e.target.id.substring(7))).value="",O("prsn"+t).style.display="none"),e.stopPropagation()}function Vn(e){"c0"!==e&&O("contain"+e).scrollIntoView({behavior:"smooth",block:"center"})}function zn(e){var t,n=O("ref"+e),a=O("sSgn"+e);if(""===N[e].assgn)return n.setAttribute("class","whitecircle"),void(a.textContent="");t="activecircle"+jn(e,!1),n.setAttribute("class",t),a.textContent=" "+N[e].assgn}function Un(){for(var e,t,n=[],a=L.catData.length,r=L.indexData.courses.length,s=0;s<a;s++)t=L.catData[s][0],Ut(s+1),n.push(t),"$deleted"===t.substring(0,8)&&Vt(s+1);for(s=0;s<r;s++)_t(e=L.indexData.courses[s],n.indexOf(N[e].cat)+1);Yn()}function Yn(){for(var e=0;e<L.catData.length;e++)"CLINIC"!==L.catData[e][0]&&Number(L.catData[e][1])>Number(L.settings.maxHours)/2&&dn("bldr"+[e+1])}function Zn(e,t){var n="none",a="inline-block",r=N[e];"CLINIC"!==r.cat&&(t||(a="none",n="inline-block"),O("ref"+e).style.display=n,O("edrinit-"+e).style.display=n,"twohour"!==r.duration&&"threehour"!==r.duration||(O("edrday2-"+e).style.display="none",O("edrstart2-"+e).style.display="none"),O("edrsave-"+e).style.display=a,O("edredit-"+e).style.display=a,O("edrdel-"+e).style.display=a)}function Xn(){var e;if(O("deptgroupsset").textContent="",!L.settings.deptGrps.length)return sn("deptgrpcontrol"),void dn("nodeptgrps");for(e=0;e<L.settings.deptGrps.length-1;e++)O("deptgroupsset").textContent+=" "+L.settings.deptGrps[e]+" -";O("deptgroupsset").textContent+=" "+L.settings.deptGrps[L.settings.deptGrps.length-1],dn("deptgrpcontrol"),sn("nodeptgrps")}function Qn(){O("schedhrsset").textContent=L.settings.maxHours,O("dayhrsset").textContent=L.settings.maxHrsPerDay,2===L.settings.maxSeqHrs?O("seqhrsset").textContent="2-2-3(3)":O("seqhrsset").textContent="3-4-3(6)",ha(L.settings.overrides.deptGrps,"deptgrpsbyps"),Xn(),dn("displayOverrides")}function ea(){sn("newcoursemodal"),O("deptEDIT").removeEventListener("click",ta,{capture:!1,passive:!0}),O("deptEDIT-file").removeEventListener("change",Me,{capture:!1,passive:!0}),O("csv-freshfile").removeEventListener("change",_e,{capture:!1,passive:!0}),O("deptopenL").removeEventListener("click",ga,{capture:!1,passive:!0}),O("save-deptEDIT").removeEventListener("click",yt,{capture:!1,passive:!0}),O("deptEDITadd").removeEventListener("click",ft,{capture:!1,passive:!0}),O("exit-deptEDIT").removeEventListener("click",ya,{capture:!1,passive:!0}),O("newcourseform").removeEventListener("click",Bn,{capture:!1,passive:!0}),O("newcoursename").removeEventListener("input",oa,{capture:!1,passive:!0}),O("newcourseroom").removeEventListener("input",ca,{capture:!1,passive:!0}),O("durationone").removeEventListener("click",Dn,{capture:!1,passive:!0}),O("durationninety").removeEventListener("click",Cn,{capture:!1,passive:!0}),O("durationtwo").removeEventListener("click",Nn,{capture:!1,passive:!0}),O("durationthree").removeEventListener("click",kn,{capture:!1,passive:!0}),He(),O("left").style.visibility="visible",O("right").style.visibility="visible",dn("displayOverrides")}function ta(e){var t,n,a,r;e.target!==e.currentTarget&&"deptdel"==e.target.id.substring(0,7)&&(t=e.target.id.substring(7),!0===(r=!0,""!==(a=g(O(a=n="deptnm"+t).value))&&!0===mt(a)&&!0!==gt(a)&&(r=!1,window.mscAlert({title:"",subtitle:"The department: "+a+" is currently assigned to one or more courses and cannot be deleted."})),r)&&(O(n).value="",O("dpts"+t).style.display="none")),e.stopPropagation()}function na(e){e.target!==e.currentTarget&&"makegroup"===e.target.id&&function(){var e,t,n,a,r=Number(O("newgroupid").dataset.grpindex),s=L.settings.deptGrps[r],i=O("alldepartments").childNodes;if(s&&s.length){for(e=document.createDocumentFragment(),t=document.createElement("div"),(n=document.createElement("span")).id="remove"+r,n.className="btn btn-xs btn-danger",n.textContent="delete",t.textContent="(",a=0;a<s.length-1;a++)t.textContent+=s[a]+", ";t.textContent+=s[s.length-1]+") ",t.appendChild(n),e.appendChild(t),O("allgroups").appendChild(e),O("newgroupid").dataset.grpindex=L.settings.deptGrps.length}for(a=0;a<i.length;a++)1==i[a].nodeType&&(i[a].style.backgroundColor="",i[a].style.color="",i[a].style.borderColor="")}(),e.stopPropagation()}function aa(e){e.target!==e.currentTarget&&"opt"==e.target.id.substring(0,3)&&(e.shiftKey?xt(e.target.id,!1):xt(e.target.id,!0)),e.stopPropagation()}function ra(){var e,t,n=L.indexData.courses.length;for(sn("newCNames"),t=0;t<n;t++)O("edredit-"+(e=L.indexData.courses[t])).style.display="none",O("edredit-"+e).hasChildNodes&&k(O("edredit-"+e)),O("ref"+e).style.display="inline-block","CLINIC"!==N[e].cat&&(O("edrinit-"+e).style.display="inline-block");for(t=0;t<L.catData.length;t++)cn("catref"+[t+1]),dn("catedt"+[t+1]);dn("renamer"),dn("purger"),dn("addnewcourse"),dn("openklinics")}function sa(e,t){for(var n,a,r,s=[],s="updateHdrsA"===t?["strHdr1","strHdr2","strHdr3","strHdr4"]:["strHdr5","strHdr6"],i=0;i<s.length;i++)n=s[i],r=a=void 0,a=C(m(O(n).value)),void 0!==(r={strHdr1:"courseCat",strHdr2:"courseRm",strHdr3:"courseTime",strHdr4:"courseNum",strHdr5:"oldNum",strHdr6:"newNum"}[n])&&a.length?l[r]=a:l[r]=d(r),O(n).placeholder=l[r],O(n).value=l[r],O(s[i]).disabled=!e;if(!1===e)return O(t).className=D(O(t).className,"btn-primary"),O(t).className+=" btn-warning",O(t).textContent="edit headers",void window.mscAlert({title:"",subtitle:"The csv headers have been updated."});O(t).className=D(O(t).className,"btn-warning"),O(t).className+=" btn-primary",O(t).textContent="update headers"}function ia(){var e=Number(O("hrsPerSchedule").value),t="";5*S.uiScheduleNumOfHrsPerDay<e&&(t="#d62c1a"),O("hrsPerSchedule").style.color=t}function da(){var e=Number(O("hrsPerDay").value),t="";S.uiScheduleNumOfHrsPerDay<e&&(t="#d62c1a"),O("hrsPerDay").style.color=t}function oa(){var e=O("newcoursename"),t="^([0-9]{"+S.courseNameNumLength+"})$";e.style.color=H(e.value,t)}function ca(){var e=O("newcourseroom");e.style.color=H(e.value,"^([a-zA-Z0-9\\-\\u3130-\\u318F\\uAC00-\\uD7AF])")}function la(){var e,t,n=O("searchcourses");return new RegExp("^([0-9]{"+S.courseNameNumLength+"})$","g").test(n.value)?(n.style.color="",null==(e=c(n.value))?(ua(),void(n.style.color="#d62c1a")):(t=e,ua(),O("contain"+t).className+=" arrow-pointer",L.lastSearchItem=t,void Vn(e))):(ua(),void(n.style.color="#d62c1a"))}function ua(){var e=L.lastSearchItem,t="contain"+e;""!==e&&void 0!==N[e]&&(O(t).className=D(O(t).className,"arrow-pointer"),L.lastSearchItem="")}function pa(e){for(var t,n=L.indexData.schedules.length,a=0;a<n;a++)t=L.indexData.schedules[a],I[t].display="s"+(L.indexData.schedules.indexOf(t)+1);if(!0===e)for(a=0;a<n;a++)t=L.indexData.schedules[a],document.getElementById(t).childNodes[0].childNodes[0].textContent=I[t].display}function ha(e,t){!0!==e?O(t).className=D(O(t).className,"bypass"):O(t).className+=" bypass"}function ma(){ha(L.settings.overrides.deptGrps,"deptgrpsbyps"),ha(L.settings.overrides.maxHours,"schedhrsbyps"),ha(L.settings.overrides.maxHrsPerDay,"dayhrsbyps"),ha(L.settings.overrides.maxSeqHrs,"seqhrsbyps"),"week"===L.settings.deptGrpsSetBy?O("deptGrpsWeekly").checked=!0:O("deptGrpsDaily").checked=!0,!0===L.settings.overrides.multiCats?O("mlticatsyes").checked=!0:O("mlticatsno").checked=!0}function fa(){O("hrsPerSchedule").value=L.settings.maxHours,O("hrsPerDay").value=L.settings.maxHrsPerDay,2===L.settings.maxSeqHrs?O("seqHrsTwo").checked=!0:O("seqHrsThree").checked=!0}function ga(){!function(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("deptEDIT")),r=0;r<L.indexData.depts.length;r++)e=document.createElement("div"),t=document.createElement("input"),n=document.createElement("input"),a=document.createElement("span"),e.id="dpts"+[r],t.type="text",t.id="deptnm"+[r],t.className="inputstylenarrow disabled",t.value=L.indexData.depts[r].shortcode,t.maxLength=8,t.placeholder="shortcode",n.type="text",n.id="ddesc"+[r],n.className="inputstyle",n.value=L.indexData.depts[r].description,n.maxLength=32,n.placeholder="description",a.id="deptdel"+[r],a.className="btn btn-xs btn-danger deletex pull-right",a.textContent="✖",e.appendChild(t),e.appendChild(n),e.appendChild(a),s.appendChild(e);O("deptEDIT").appendChild(s)}(),O("setting-section").className+=" disabled",O("newcourseform").className+=" disabled",sn("hiddendeptopenL"),sn("hiddendeptopenR"),dn("departments")}function ya(){sn("departments"),dn("hiddendeptopenR"),dn("hiddendeptopenL"),O("setting-section").className=D(O("setting-section").className,"disabled"),O("newcourseform").className=D(O("newcourseform").className,"disabled"),k(O("deptEDIT"))}function va(){var e,t,n=O("configStartHr"),a=O("configNumOfHrsPerDay"),n=Number(n.options[n.selectedIndex].value),r=document.createDocumentFragment();for(k(a),t=n;t<23;t++)(e=document.createElement("OPTION")).value=t+1,e.textContent=("0"+e.value).slice(-2)+":00",r.appendChild(e);a.appendChild(r),(n=a.options.length)<S.uiScheduleNumOfHrsPerDay?a.options[n-1].selected=!0:a.options[S.uiScheduleNumOfHrsPerDay-1].selected=!0}function xa(){var e=Number(O("configStartHr").value),t=Number(O("configNumOfHrsPerDay").value);S.uiTimeInputStartHr=+e,S.uiScheduleNumOfHrsPerDay=t-e,9!==S.uiTimeInputStartHr&&(S.pdfBlankHr=""),O("configStartHr").disabled=!0,O("configNumOfHrsPerDay").disabled=!0}Array.prototype.identical=function(e){var t;if(this.length!==e.length)return!1;for(t=0;t<e.length;t++)if(this[t].identical){if(!this[t].identical(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},"serviceWorker"in navigator&&navigator.serviceWorker.register("/schedules/serviceWorker.js"),"onpagehide"in window?window.addEventListener("pagehide",It,!1):window.addEventListener("beforeunload",It,!1),e=65+S.scheduleRowPixelHeight*(S.uiScheduleNumOfHrsPerDay+1),t=65+S.scheduleRowPixelHeight*(S.uiScheduleNumOfHrsPerDay+1)+25,e="#schedule-instances>div{min-height:"+e+"px;height:"+e+"px;max-height:"+e+"px;} #schedule-instances>div.show-teacher{min-height:"+t+"px;height:"+t+"px;max-height:"+t+"px;}",(t=document.createElement("style")).type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t),O("hrsPerSchedule").value=""+S.maxHours,O("hrsPerSchedule").max=""+5*S.uiScheduleNumOfHrsPerDay,O("hrsPerDay").value=""+S.maxHrsPerDay,O("hrsPerDay").max=""+S.uiScheduleNumOfHrsPerDay,O("updateHdrsA").addEventListener("click",un,{capture:!1,passive:!0}),O("updateHdrsB").addEventListener("click",pn,{capture:!1,passive:!0}),O("csv-file").addEventListener("change",qe,{capture:!1,passive:!0}),O("json-file").addEventListener("change",ze,{capture:!1,passive:!0}),O("configStartHr").addEventListener("change",va,{capture:!1,passive:!0}),O("savedsession").addEventListener("click",Lt,{capture:!1,passive:!0}),O("newsession").addEventListener("click",R,{capture:!1,passive:!0}),O("helpfileA").addEventListener("click",mn,{capture:!1,passive:!0}),O("helpfile1").addEventListener("click",fn,{capture:!1,passive:!0})}()});