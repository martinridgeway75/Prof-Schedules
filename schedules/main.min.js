window.addEventListener("load",function(){!function(){"use strict";var e,t,n,a,S={notes:"App assumes that there are either MonToFri or MonToSat schedules.\nApp assumes that courses are: 2x1 hour blocks, 2x90 minute blocks, 2 hour blocks, 3 hour blocks or 1 hour clinics.\nApp assumes all courses start on the hour.",uriTypes:{csv:"data:text/csv;charset=utf-8,%EF%BB%BF",json:"data:application/json;charset=utf-8",txt:"data:text/plain;charset=utf-8"},maxHrsPerDay:4,maxHours:12,uiTimeInputStartHr:9,uiScheduleNumOfHrsPerDay:9,courseNameNumLength:4,csvStr:{courseCat:"교과목명",courseNum:"수강 번호",courseTime:"시간",courseRm:"강의실",courseTchr:"강사명",oldNum:"수강 번호1",newNum:"수강 번호2"},alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],monToSatKr:["월","화","수","목","금","토"],monToSatEn:["M","T","W","Th","F","S"],pdfBlankHr:"7:50-8:40",pdfCourseColors:["","blue","crimson","green","purple","darkorange"],scheduleRowPixelHeight:18},L={},N={},I={},l={courseCat:S.csvStr.courseCat,courseNum:S.csvStr.courseNum,courseTime:S.csvStr.courseTime,courseRm:S.csvStr.courseRm,courseTchr:S.csvStr.courseTchr,oldNum:S.csvStr.oldNum,newNum:S.csvStr.newNum};function O(e){return document.getElementById(e)}function s(){L={catData:[],indexData:{courses:[],schedules:[],klinics:[],depts:[]},settings:{deptGrps:[],deptGrpsSetBy:"day",maxHours:S.maxHours,maxHrsPerDay:S.maxHrsPerDay,maxSeqHrs:3,overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},teachers:[],tempCparam:"",tempKlinic:{kbtn:"",isHeld:!1},lastSearchItem:""}}function o(e){return null===e||("object"!=typeof e||0===Object.keys(e).length)}function k(e){for(;e.hasChildNodes();){for(;e.lastChild.hasChildNodes();)e.lastChild.removeChild(e.lastChild.lastChild);e.removeChild(e.lastChild)}}function y(e){for(var t,n=[],a=e.length,r=0;r<a;r++){for(t=r+1;t<a;t++)e[r]===e[t]&&(t=++r);n.push(e[r])}return n}function h(e,t){for(var n,a=[],r=e.length,s=0;s<r;s++){for(n=s+1;n<r;n++)e[s][t]===e[n][t]&&(n=++s);a.push(e[s])}return a}function d(e){return S.csvStr[e]}function p(e){for(var t,n,a=L.indexData.courses.length,r=0;r<a;r++)if(n=L.indexData.courses[r],N[n].name===e){t=n;break}return t}function r(){L.settings.maxSeqHrs=2}function i(){L.settings.maxSeqHrs=3}function c(){L.settings.deptGrpsSetBy="day"}function u(){L.settings.deptGrpsSetBy="week"}function m(){L.settings.overrides.multiCats=!0}function f(){L.settings.overrides.multiCats=!1}function g(e){return e.replace(/[,=<>$/'"&\t]/g,"")}function v(e){return e.replace(/[,=<>$/'"&\t\s]/g,"")}function x(e){return e.replace(/[^\u3130-\u318F\uAC00-\uD7AF]/gim,"")}function w(e){return e.replace(/[^a-zA-Z\-\u3130-\u318F\uAC00-\uD7AF\s]/gim,"")}function b(e){return e.replace(/[\s\t]+$/,"")}function D(e){return e.replace(/[\u3130-\u318F\uAC00-\uD7AF]/g,"")}function C(e){return e.replace(/[^a-zA-Z0-9\-]/gim,"")}function E(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g");return e.replace(n,"")}function P(e){return e.replace(/\s+/g," ")}function H(e){return e.replace(/[^0-9]/g,"")}function T(e){return e.replace(/\s/g,"_")}function A(e,t){var n="";return new RegExp(t,"g").test(e)||(n="#d62c1a"),n}function R(e){var t=new Array(S.uiScheduleNumOfHrsPerDay).fill(e);return JSON.parse(JSON.stringify(new Array(6).fill(t)))}function F(){O("csv-file").removeEventListener("change",Je,{capture:!1,passive:!0}),O("json-file").removeEventListener("change",Ye,{capture:!1,passive:!0}),O("configStartHr").removeEventListener("change",wa,{capture:!1,passive:!0}),O("savedsession").removeEventListener("click",Ot,{capture:!1,passive:!0}),O("newsession").removeEventListener("click",G,{capture:!1,passive:!0}),O("helpfileA").removeEventListener("click",gn,{capture:!1,passive:!0}),O("helpfile1").removeEventListener("click",vn,{capture:!1,passive:!0}),O("leftsidesettings").addEventListener("click",Bn,{capture:!1,passive:!0}),O("uploadnewCNames").addEventListener("change",Ze,{capture:!1,passive:!0}),O("rightsidesettings").addEventListener("click",Kn,{capture:!1,passive:!0}),O("schedule-instances").addEventListener("click",Gn,{capture:!1,passive:!0}),O("references").addEventListener("click",An,{capture:!1,passive:!0}),O("searchcourses").addEventListener("input",pa,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",ct,{capture:!1,passive:!0}),O("deptGrpsDaily").addEventListener("click",c,{capture:!1,passive:!0}),O("deptGrpsWeekly").addEventListener("click",u,{capture:!1,passive:!0}),O("mlticatsyes").addEventListener("click",m,{capture:!1,passive:!0}),O("mlticatsno").addEventListener("click",f,{capture:!1,passive:!0}),O("startedr").addEventListener("click",Te,{capture:!1,passive:!0}),O("helpfileB").addEventListener("click",yn,{capture:!1,passive:!0}),O("helpfile1").addEventListener("click",xn,{capture:!1,passive:!0}),O("view-stats").addEventListener("click",He,{capture:!1,passive:!0}),O("klinicHold").addEventListener("click",Et,{capture:!1,passive:!0})}function G(){ba(),s(),ye(!1),F()}function B(e,t,n){var a,r,s=N[I[e].cRef[n]],i=N[t];return i.hasOwnProperty("allowFollow")?s.hasOwnProperty("allowFollow")?function(e,t,n){for(var a=N[I[e].cRef[n]],r=N[t],s=[[r.dayhr[0][0],r.dayhr[0][1]+1],[r.dayhr[1][0],r.dayhr[1][1]+1]],i=[[a.dayhr[0][0],a.dayhr[0][1]+1],[a.dayhr[1][0],a.dayhr[1][1]+1]],d=0;d<2;d++){if(s[d].identical(a.dayhr[0]))return!0===r.allowFollow[d]&&!1===a.allowFollow[0];if(s[d].identical(a.dayhr[1]))return!0===r.allowFollow[d]&&!1===a.allowFollow[1];if(i[d].identical(r.dayhr[0]))return!0===a.allowFollow[d]&&!1===r.allowFollow[0];if(i[d].identical(r.dayhr[1]))return!0===a.allowFollow[d]&&!1===r.allowFollow[1]}return 1}(e,t,n):(r=[[i.dayhr[0][0],i.dayhr[0][1]+1],[i.dayhr[1][0],i.dayhr[1][1]+1]])[0].identical(s.dayhr[0])||r[1].identical(s.dayhr[1])||r[1].identical(s.dayhr[0])||r[0].identical(s.dayhr[1])?void 0:1:!s.hasOwnProperty("allowFollow")||(a=[[s.dayhr[0][0],s.dayhr[0][1]+1],[s.dayhr[1][0],s.dayhr[1][1]+1]],i.dayhr[0].identical(a[0])||i.dayhr[1].identical(a[1])||i.dayhr[1].identical(a[0])||i.dayhr[0].identical(a[1])?void 0:1)}function K(e){return""===N[e].assgn}function q(e,t){return N[t].dayhr[0][0]!==I[e].dayOff&&N[t].dayhr[1][0]!==I[e].dayOff}function _(e){for(var t,n=0,a=I[e].cRef.length,r=0;r<a;r++)"CLINIC"!==(t=N[I[e].cRef[r]]).cat&&("ninety"===t.duration||"threehour"===t.duration?n+=1.5:n+=1);return 2*n}function J(e,t){return-1===I[e].cRef.indexOf(t)}function M(e){return e>Number(L.settings.maxHrsPerDay)}function j(e,t){var n,a,r,s,i,d,o,c,l,u,p=R(0),h=!1,m=!1;if(!0===L.settings.overrides.maxSeqHrs)return!0;if("CLINIC"===N[t].cat)return!0;for(a=N[t].dayhr[0][0],r=N[t].dayhr[1][0],s=N[t].dayhr[0][1],i=N[t].dayhr[1][1],u=0;u<I[e].cRef.length;u++)"CLINIC"!==(n=N[I[e].cRef[u]]).cat&&(d=n.dayhr[0][0],o=n.dayhr[1][0],c=n.dayhr[0][1],l=n.dayhr[1][1],a!==d&&a!==o&&r!==d&&r!==o||(p[d][c]+=1,p[o][l]+=1,"threehour"===n.duration&&(p[d][c+1]+=1)));return p[a][s]+=1,p[r][i]+=1,"twohour"===n.duration&&(h=!0),"threehour"===n.duration&&(p[a][s+1]+=1,m=h=!0),function(e,t,n){var a,r,s,i=!0,d=e.length;if(2===L.settings.maxSeqHrs)if(n){for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-2;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]){i=!1;break}}else for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-1;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]){i=!1;break}if(3===L.settings.maxSeqHrs)if(t){for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-3;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]&&a[s+3]===a[s+4]){i=!1;break}}else for(r=0;r<d;r++)for(a=e[r],s=0;s<a.length-2;s++)if(1===a[s]&&a[s]===a[s+1]&&a[s+1]===a[s+2]&&a[s+2]===a[s+3]){i=!1;break}return i}(p,h,m)}function W(e,t){var n=N[t];return!!I[e].hasOwnProperty("isSat")||5!==n.dayhr[0][0]&&5!==n.dayhr[1][0]&&!I[e].hasOwnProperty("isSat")}function $(e,t){var n,a,r,s,i,d,o,c,l,u,p;if(!L.settings.deptGrps.length)return 1;if(!0===L.settings.overrides.deptGrps)return 1;if("CLINIC"===N[t].cat)return 1;for(n=function(e){for(var t,n=[],a=L.settings.deptGrps.length,r=0;r<a;r++)-1!==(t=L.settings.deptGrps[r]).indexOf(e)&&n.push(t);return n}(N[t].dept),a=[],s=I[e].cRef.length,u=0;u<s;u++)"CLINIC"!==(r=N[I[e].cRef[u]]).cat&&("week"===L.settings.deptGrpsSetBy&&a.push(r.dept),"day"===L.settings.deptGrpsSetBy&&(d=r.dayhr[0][0],o=r.dayhr[1][0],c=N[t].dayhr[0][0],l=N[t].dayhr[1][0],d!==c&&d!==l&&o!==c&&o!==l||a.push(r.dept)));for(a.push(N[t].dept),y(a),u=0;u<n.length;u++){for(p=i=0;p<a.length;p++)n[u].includes(a[p])&&i++;if(i===a.length)return 1}}function V(e,t){I[e].cRef.push(t),N[t].assgn=e}function z(e,t){var n,a,r,s,i,d,o,c,l,u,p;if(I[e].cRef.length){if(!1!==J(e,t)&&!1!==K(t)&&!1!=(s=e,i=t,d=Number(L.settings.maxHours),o=2,!0===L.settings.overrides.maxHours||"CLINIC"===N[i].cat||("ninety"!==N[i].duration&&"threehour"!==N[i].duration||(o=3),_(s)+o<=d))&&!1!==q(e,t)&&!1!==function(e,t){var n,a,r,s,i,d,o,c;if(!0===L.settings.overrides.maxHrsPerDay)return!0;if("CLINIC"===N[t].cat)return!0;for(n=[0,0,0,0,0,0],r=I[e].cRef,s=N[t].dayhr[0][0],i=N[t].dayhr[1][0],c=0;c<r.length;c++)"CLINIC"!==(a=N[r[c]]).cat&&(d=a.dayhr[0][0],o=a.dayhr[1][0],s!==d&&s!==o&&i!==d&&i!==o||(n[d]+=1,n[o]+=1,"threehour"===a.duration&&(n[d]+=1)));return n[s]+=1,n[i]+=1,"threehour"===a.duration&&(n[s]+=1),!n.some(M)}(e,t)&&!1!==j(e,t)&&!1!==W(e,t)){for(n=0,a=I[e].cRef.length,r=0;r<a&&(c=t,l=r,p=u=void 0,u=N[I[e].cRef[l]],p=N[c],!(u.dayhr[0].identical(p.dayhr[0])||u.dayhr[1].identical(p.dayhr[1])||u.dayhr[1].identical(p.dayhr[0])||u.dayhr[0].identical(p.dayhr[1]))&&B(e,t,r)&&function(e,t,n){var a=N[I[e].cRef[n]],r=N[t],s=[];if("threehour"===r.duration){if(s.push(r.dayhr[0][0]),s.push(r.dayhr[0][1]+1),a.dayhr[0].identical(s)||a.dayhr[1].identical(s))return}else if(s.push(a.dayhr[0][0]),s.push(a.dayhr[0][1]+1),"threehour"===a.duration&&(r.dayhr[0].identical(s)||r.dayhr[1].identical(s)))return;return 1}(e,t,r));r++)n++;n===a&&$(e,t)&&V(e,t)}}else K(t)&&q(e,t)&&W(e,t)&&V(e,t)}function U(e,t){if(!I[e].cRef.length)throw new Error("Internal error: Attempted to remove an assignment that was never made: s"+e+", c"+t);var n,a;N[t].assgn===e&&-1!==I[e].cRef.indexOf(t)&&(n=e,N[a=t].assgn="",I[n].cRef.splice(I[n].cRef.indexOf(a),1))}function Y(e,t){var n,a,r=I[e].cRef,s=!1;if(!0===L.settings.overrides.multiCats)return!0;if("CLINIC"===N[t].cat)return!0;if(!r.length)return!0;for(a=n=0;a<r.length;a++)if("CLINIC"!==N[r[a]].cat){if(N[r[a]].cat===N[t].cat){s=!0;break}}else n++;return n===r.length&&(s=!0),s}function Z(e){var t="s1",n=L.indexData.schedules.length;return(n||0<n)&&(t="s"+(Number(L.indexData.schedules[n-1].substring(1))+1)),I[t]={},I[t].cRef=[],I[t].dayOff=6,I[t].display="","Sat"===e&&(I[t].isSat="yes"),L.indexData.schedules.push(t),ma(!1),t}function X(e,t){var n=["Please enter an appropriate name.",'"CLINIC" is a reserved category name!',"The name: "+t+" already exists.\nPlease choose a unique name."];window.mscAlert({title:"",subtitle:n[e]})}function Q(e,t){var n,a;if(!0===e){if(""===(t=P(g(t))))return void X(0);if("clinic"===t.toLowerCase())return void X(1);if(L.catData.length)for(a=0;a<L.catData.length;a++)if(L.catData[a][0]===t)return void X(2,t)}n=[t,0,R(0)],L.catData.push(n),Zt(L.catData.length),!0===e&&(window.mscAlert({title:"",subtitle:t+" has been added to the list of categories."}),O("definenewcat").value="",Ln()),Xt()}function ee(){L.newDepts=[],L.newKlinicDefs=[],L.newCourses=[],L.overwriteCourses=[],delete L.newDepts,delete L.newKlinicDefs,delete L.newCourses,delete L.overwriteCourses}function te(){var e,t;for(!function(){var e,t,n=L.newCourses.length;for(t=0;t<n;t++)null!=L.newCourses[t]&&-1===L.indexData.depts.map(function(e){return e.shortcode}).indexOf(L.newCourses[t].dept)&&((e={}).shortcode=L.newCourses[t].dept,e.description="",L.newDepts.push(e));1<L.newDepts.length&&(L.newDepts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.newDepts=h(L.newDepts,"shortcode"))}(),e=L.newCourses.length-1;0<=e;e--)for(t=0;t<L.indexData.courses.length;t++)if(L.newCourses[e].name===N[L.indexData.courses[t]].name){L.overwriteCourses.push(L.newCourses[e]),L.newCourses.splice(e,1);break}L.overwriteCourses.length?window.mscConfirm({title:"Overwrite courses?",subtitle:'Some of the courses you are attempting to upload have names (IDs) that currently exist. Choose: "Ok" to overwrite the existing courses, or cancel this action.',onOk:function(){Kt(!0)},onCancel:function(){ee()}}):Kt(!1)}function ne(e){var t,n;for(K(e)||le(N[e].assgn,e),L.indexData.courses.splice(L.indexData.courses.indexOf(e),1),k(t=O("contain"+e)),t.parentNode.removeChild(t),n=0;n<L.catData.length;n++)if(L.catData[n][0]===N[e].cat){--L.catData[n][1],--L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]],"CLINIC"!==N[e].cat&&--L.catData[n][2][N[e].dayhr[1][0]][N[e].dayhr[1][1]],"threehour"===N[e].duration&&--L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]+1];break}delete N[e]}function ae(e,t){for(var n,a,r,s,i=L.indexData.courses.length,d=0;d<i;d++)(r=N[L.indexData.courses[d]]).cat===t&&(r.cat=e);for(d=0;d<L.catData.length;d++)L.catData[d][0]===e?n=d:L.catData[d][0]===t&&(a=d);if(null==n)throw new Error("Internal error: Attempting to read a category that doesn't exist!");if(null==a)throw new Error("Internal error: Attempting to read a category that doesn't exist!");for(L.catData[n][1]+=L.catData[a][1],d=0;d<L.catData[n][2].length;d++)for(s=0;s<L.catData[n][2][d].length;s++)L.catData[n][2][d][s]+=L.catData[a][2][d][s];for(L.catData[a][0]="$deleted"+[a+1],function(){var e,t,n,a=L.indexData.courses.length;for(xe(),k(O("references")),Zn(),n=0;n<a;n++)t=L.indexData.courses[n],""!==(e=N[t]).assgn&&(Vn(e.assgn,t,"off"),Vn(e.assgn,t,"on")),"CLINIC"!==e.cat&&(O("edrinit-"+t).style.display="inline-block",O("ref"+t).style.display="inline-block")}(),se(e),d=0;d<L.catData.length;d++)cn("catedt"+[d+1]);un("catref"+(n+1))}function re(e){window.mscAlert({title:"",subtitle:["Please choose an appropriate name!",'"CLINIC" is a reserved category name!'][e]})}function se(e){for(var t,n=L.indexData.courses.length,a=0;a<n;a++)(t=N[L.indexData.courses[a]]).cat===e&&""!==t.assgn&&Wn(t.assgn)}function ie(e){var t=Number(e)-1;window.mscConfirm({title:"Warning",subtitle:"This action will also delete all courses under the category:\n"+L.catData[t][0]+".\nThis action cannot be undone. Proceed?",onOk:function(){!function(e){var t,n=L.catData[e][0];if(null==L.catData[e]||Number.isNaN(Number(e)))return;for(t=L.indexData.courses.length-1;0<=t&&0<L.catData[e][1];t--)N[L.indexData.courses[t]].cat===n&&ne(L.indexData.courses[t]);"CLINIC"===n&&(L.indexData.klinics=[]);L.catData[e][0]="$deleted"+[e+1],Ut(e+1)}(t)},onCancel:function(){}})}function de(){window.mscConfirm({title:"Purge?",subtitle:"This action will remove all courses and categories.\nSettings, teachers, departments, groups and clinic definitions will all remain intact.\nThis action cannot be undone! Proceed?",onOk:function(){!function(){var e,t=L.indexData.schedules.length;if(t)for(e=0;e<t;e++)fe("reset"+L.indexData.schedules[e]);k(O("references")),N={},L.catData=[],L.indexData.courses=[]}()},onCancel:function(){}})}function oe(e){var t,n=function(e){var t,n=e.substring(4);for(t=0;t<5;t++)O("off"+t+n).style.color="";I[n].hasOwnProperty("isSat")&&(O("off5"+n).style.color="");return O(e).style.color="#2c3e50",n}(e),a=function(e,t){var n,a,r=I[e].cRef;if(I[e].dayOff=Number(t),!r.length)return[];for(n=[],a=0;a<r.length;a++)q(e,r[a])||n.push(r[a]);for(a=0;a<n.length;a++)U(e,n[a]);return n}(n,Number(e.substring(3,4)));if(a.length)for(t=a.length-1;0<=t;t--)Vn(n,a[t],"off"),"CLINIC"===N[a[t]].cat&&ne(a[t]);Wn(n),ge(n)}function ce(e,t){var n=!1,a=N[e];return"threehour"===a.duration&&[a.dayhr[0][0],a.dayhr[0][1]+1].identical(t)&&(n=!0),(a.dayhr[0].identical(t)||a.dayhr[1].identical(t))&&(n=!0),n}function le(e,t){U(e,t),Vn(e,t,"off"),Wn(e),ge(e)}function ue(e,t){var n,a,r="s"+e,s=(n=r,!!K(a=t)&&!0===Y(n,a)&&(z(n,a),!J(n,a)));!0==s&&(Vn(r,t,"on"),Wn(r),ge(r)),!1==s&&"CLINIC"===N[t].cat&&ne(t),L.tempCparam=""}function pe(e){var t,n,a,r="",s=[],i=I[e].cRef;if(!i.length)return"";for(a=0;a<i.length;a++)"CLINIC"!==(t=N[i[a]]).cat&&s.push(t.cat);if(!s.length)return"";for(s.sort(),r+=(n=y(s))[0],a=1;a<n.length;a++)r+=", "+n[a];return r}function he(e){var t,n=I[e].cRef.slice(),a=O(""+e);for(k(a),a.parentElement.removeChild(a),function(e){var t;if(I[e].cRef.length)for(t=I[e].cRef.length-1;0<=t;t--)U(e,I[e].cRef[t]);L.indexData.schedules.splice(L.indexData.schedules.indexOf(e),1),delete I[e],ma(!0)}(e),t=0;t<n.length;t++)Yn(n[t])}function me(e){var t=Z(e);Yt(t,e),ge(t)}function fe(e){var t,n=e.substring(5);if(I[n].cRef.length)for(t=I[n].cRef.length-1;0<=t;t--)"CLINIC"===N[I[n].cRef[t]].cat?ne(I[n].cRef[t]):le(n,I[n].cRef[t]);for(I[n].dayOff=6,t=0;t<5;t++)O("off"+t+n).style.color="";I[n].hasOwnProperty("isSat")&&(O("off5"+n).style.color=""),I[n].hasOwnProperty("tchr")&&""!==I[n].tchr&&dt(n)}function ge(e){var t=O(""+e);if(!I[e].cRef.length)return t.style.borderColor="#3498db",t.style.color="#3498db",void(t.firstChild.style.fontWeight="700");_(e)<L.settings.maxHours-1?(t.style.borderColor="#3498db",t.style.color="#3498db"):(t.style.borderColor="",t.style.color=""),t.firstChild.style.fontWeight="700"}function ve(e){var t,n,a=N[e];if("CLINIC"!==a.cat){for(t=O("edrdept-"+e),n=0;n<t.options.length;n++)if(a.dept===t.options[n].value){t.selectedIndex=n;break}O("edrday1-"+e).selectedIndex=a.dayhr[0][0],O("edrday2-"+e).selectedIndex=a.dayhr[1][0],"ninety"===a.duration?(!1===a.allowFollow[0]?O("edrstart1-"+e).options.length>2*a.dayhr[0][1]+1?O("edrstart1-"+e).selectedIndex=2*a.dayhr[0][1]+1:O("edrstart1-"+e).selectedIndex=O("edrstart1-"+e).options.length-1:O("edrstart1-"+e).selectedIndex=2*a.dayhr[0][1],!1===a.allowFollow[1]?O("edrstart2-"+e).options.length>2*a.dayhr[1][1]+1?O("edrstart2-"+e).selectedIndex=2*a.dayhr[1][1]+1:O("edrstart2-"+e).selectedIndex=O("edrstart2-"+e).options.length-1:O("edrstart2-"+e).selectedIndex=2*a.dayhr[1][1]):(O("edrstart1-"+e).selectedIndex=a.dayhr[0][1],O("edrstart2-"+e).selectedIndex=a.dayhr[1][1]),Qn(e,!0)}}function ye(e){var t,n,a;for(on("parsing"),ta(),xe(),Zn(),Oe("stats-grid","g_d"),Oe("klinics-grid","gk_d"),a=0;a<L.indexData.schedules.length;a++)t=L.indexData.schedules[a],(n=I[t]).hasOwnProperty("isSat")?Yt(t,"Sat"):Yt(t,"MtoF");if(!0===e){for(a=0;a<L.indexData.courses.length;a++)t=L.indexData.courses[a],""!==(n=N[t]).assgn&&Vn(n.assgn,t,"init");for(a=0;a<L.indexData.schedules.length;a++)t=L.indexData.schedules[a],n=I[t],Wn(t),6!==n.dayOff&&(O("off"+n.dayOff+t).style.color="#2c3e50"),n.hasOwnProperty("tchr")&&""!==n.tchr&&(O("tchrset"+t).textContent=n.tchr);va(),ga()}for(a=0;a<L.indexData.schedules.length;a++)ge(L.indexData.schedules[a]);nn()}function xe(){Xt(),Qt(),zt("onehour")}function we(){var e,t;if(L.settings.deptGrps.length){for(e=[],t=0;t<L.indexData.depts.length;t++)e.push(L.indexData.depts[t].shortcode);for(t=L.settings.deptGrps.length-1;0<=t;t--)(o(L.settings.deptGrps[t])||e.identical(L.settings.deptGrps[t].sort()))&&L.settings.deptGrps.splice(t,1)}L.settings.deptGrps.length?L.settings.overrides.deptGrps=!1:L.settings.overrides.deptGrps=!0,O("newgroupid").dataset.grpindex=L.settings.deptGrps.length}function be(){en(),an(),on("displayOverrides"),on("left"),on("right"),O("deptEDIT").addEventListener("click",aa,{capture:!1,passive:!0}),O("deptEDIT-file").addEventListener("change",We,{capture:!1,passive:!0}),O("deptopenR").addEventListener("click",ya,{capture:!1,passive:!0}),O("save-deptEDIT").addEventListener("click",xt,{capture:!1,passive:!0}),O("deptEDITadd").addEventListener("click",vt,{capture:!1,passive:!0}),O("exit-deptEDIT").addEventListener("click",xa,{capture:!1,passive:!0}),O("jsonSettings-file").addEventListener("change",Ve,{capture:!1,passive:!0}),O("alldepartments").addEventListener("click",sa,{capture:!1,passive:!0}),O("newgroupid").addEventListener("click",ra,{capture:!1,passive:!0}),O("allgroups").addEventListener("click",Dt,{capture:!1,passive:!0}),O("seqHrsTwo").addEventListener("click",r,{capture:!1,passive:!0}),O("seqHrsThree").addEventListener("click",i,{capture:!1,passive:!0}),O("hrsPerSchedule").addEventListener("input",oa,{capture:!1,passive:!0}),O("hrsPerDay").addEventListener("input",ca,{capture:!1,passive:!0}),O("save-settings").addEventListener("click",fn,{capture:!1,passive:!0}),cn("setting-section")}function De(e,t){var n=["The new name for course: "+t+" must be a four digit number.","The course name: "+t+"\nbelongs to another existing course!\nNew course names cannot be duplicates of existing course names.","Please check that each course has a new unique name.\nSome new course names are being duplicated."];window.mscAlert({title:"",subtitle:n[e]})}function Ce(){for(var e,t,n,a=!1,r=[],s=L.indexData.courses.length,i=0;i<s;i++)if(e=L.indexData.courses[i],"CLINIC"!==N[e].cat)if(""===(t=O("newName-"+e).value))a=!0;else{if(""!==t&&(t.length!==S.courseNameNumLength||Number(t)<1||Number.isNaN(Number(t))))return void De(0,N[e].name);if(!0!==function(e){for(var t,n=L.indexData.courses.length,a=0;a<n;a++)if(t=L.indexData.courses[a],e===N[t].name&&""===O("newName-"+t).value)return!1;return!0}(t))return void De(1,t);r.push(t)}r.sort(),n=y(r),r.length===n.length?!0===a?window.mscConfirm({title:"",subtitle:"Some fields have been left blank.\nCourses with blank fields will not be renamed.\nContinue?",cancelText:"Cancel",onOk:function(){Ne()},onCancel:function(){}}):Ne():De(2)}function Ne(){for(var e,t,n,a=L.indexData.courses.length,r=0;r<a;r++)t=L.indexData.courses[r],"CLINIC"!==(e=N[t]).cat&&""!==(n=O("newName-"+t).value)&&(e.name=n,""!==e.assgn&&(Vn(e.assgn,t,"off"),Vn(e.assgn,t,"on")),dn(t));ia()}function ke(){for(var e,t=0,n=0,a=L.indexData.schedules.length,r=0;r<a;r++)e=L.indexData.schedules[r],I[e].hasOwnProperty("isSat")?n++:t++;return[t,n]}function Ee(e){for(var t,n,a,r,s=0,i=0,d=[],o=0;o<L.catData.length;o++)s+=L.catData[o][1],i+=L.catData[o][2][5].reduce(function(e,t){return e+t},0);if(a=s,r=i,d=[a=Math.ceil((Math.ceil(a)-Math.ceil(r))/(Number(L.settings.maxHours)/2))+1,r=Math.ceil(r/(Number(L.settings.maxHours)/2))+1],!0!==e){if(n=d[1]-1-ke[0],0<(t=d[0]-1-ke[0]))for(o=0;o<t;o++)Z("MtoF");if(0<n)for(o=0;o<n;o++)Z("Sat")}else{if(0<d[0])for(o=0;o<d[0];o++)Z("MtoF");if(0<d[1])for(o=0;o<d[1];o++)Z("Sat")}}function Se(e,t,n){var a;L.catData=(a=e).map(function(e,t){return t%3==0?a.slice(t,t+3):null}).filter(function(e){return e}),L.indexData={},L.indexData.courses=t,L.indexData.schedules=[],L.indexData.depts=function(){for(var e,t=[],n=[],a=L.indexData.courses.length,r=0;r<a;r++)e=L.indexData.courses[r],t.push(N[e].dept);for(t.sort(),t=y(t),r=0;r<t.length;r++)n.push({shortcode:t[r],description:""});return n}(),!0===Array.isArray(n)?L.indexData.klinics=n:L.indexData.klinics=[],L.teachers=[],L.tempCparam="",L.tempKlinic={kbtn:"",isHeld:!1},L.lastSearchItem="",L.settings={maxHours:S.maxHours,maxHrsPerDay:S.maxHrsPerDay,maxSeqHrs:3,deptGrps:[[]],deptGrpsSetBy:"day",overrides:{maxHours:!1,maxHrsPerDay:!1,maxSeqHrs:!1,deptGrps:!0,multiCats:!1}},L.settings.deptGrps=[]}function Le(){var t,n,a=[],r=[],e=function(){var e,t,n,a=[],r=[],s=0,i=Object.keys(N);for(n=0;n<i.length;n++)"CLINIC"===(e=N[i[n]]).cat?(s+=1,(t={}).name=e.name,t.fullname=e.name,t.dept=e.dept,t.rm={},t.rm.a=e.rm.a,r.push(t)):a.push(e.name);if(a.sort(),a=y(a),i.length-s!==a.length)return L={},N={},I={},$t(),window.mscAlert({title:"",subtitle:"Please check that each course has a unique name (ID).\nSome new course names are duplicates."}),!1;if(r.length&&0<s)return r.sort(function(e,t){return e.name.localeCompare(t.name)}),r=h(r,"name");return!0}();if(!1!==e){try{Object.keys(N).forEach(function(e){r.push(""+e),t=N[e],-1===a.indexOf(t.cat)?(a.push(t.cat),a.push(1),n=R(0),a.push(n)):a[a.indexOf(t.cat)+1]+=1,a[a.indexOf(t.cat)+2][t.dayhr[0][0]][t.dayhr[0][1]]+=1,"CLINIC"!==t.cat&&(a[a.indexOf(t.cat)+2][t.dayhr[1][0]][t.dayhr[1][1]]+=1),"threehour"===t.duration&&(a[a.indexOf(t.cat)+2][t.dayhr[0][0]][t.dayhr[0][1]+1]+=1)}),Se(a,r,e),Ee(!0),ye(!1)}catch(e){return L={},N={},I={},$t(),void window.mscAlert({title:"Error",subtitle:"The .csv file you have supplied contains unexpected formatting and/or data."})}F()}}function Ie(){for(var e,t,n=function(){for(var e,t,n,a,r=L.catData.length,s=R(0),i=R(0),d=R(0),o=0;o<r;o++)if("CLINIC"!==(t=L.catData[o])[0]&&"$deleted"!==t[0].substring(0,8)){for(n=0;n<t[2].length;n++)for(a=0;a<t[2][n].length;a++)s[n][a]+=t[2][n][a];for(n=0;n<L.indexData.courses.length;n++)(e=N[L.indexData.courses[n]]).cat===t[0]&&""===e.assgn&&(d[e.dayhr[0][0]][e.dayhr[0][1]]+=1,d[e.dayhr[1][0]][e.dayhr[1][1]]+=1,"threehour"===e.duration&&(d[e.dayhr[1][0]][e.dayhr[1][1]+1]+=1))}for(o=0;o<i.length;o++)for(n=0;n<i[o].length;n++)i[o][n]=s[o][n]-d[o][n];return[i,d]}(),a=function(){for(var e,t,n,a=L.catData.length,r=R(0),s=0;s<a;s++)if("CLINIC"===(e=L.catData[s])[0])for(t=0;t<e[2].length;t++)for(n=0;n<e[2][t].length;n++)r[t][n]+=e[2][t][n];return r}(),r=0;r<n[0].length;r++)for(t=0;t<n[0][r].length;t++)O(e="g_d"+r+"t"+t).textContent=n[0][r][t],0<n[1][r][t]&&(O(e).textContent+=" ("+n[1][r][t]+")");for(r=0;r<a.length;r++)for(t=0;t<a[r].length;t++)O(e="gk_d"+r+"t"+t).textContent=a[r][t]}function Oe(e,t){var n,a,r,s,i=function(){for(var e,t=[],n=S.uiScheduleNumOfHrsPerDay,a=0;a<n;a++)e=S.uiTimeInputStartHr+a,t.push(e+":00");return t}(),d=S.monToSatKr,o=O(e),c=document.createDocumentFragment(),l=document.createElement("TABLE"),u=document.createElement("THEAD"),p=document.createElement("TBODY"),h=document.createElement("TR"),m=document.createElement("TD");for(k(o),l.className="table table-bordered table-condensed",h.className="unbordered",h.appendChild(m),r=0;r<d.length;r++)(a=document.createElement("TD")).textContent=d[r],h.appendChild(a);for(p.appendChild(h),r=0;r<i.length;r++){for(n=document.createElement("TR"),s=0;s<=d.length;s++)a=document.createElement("TD"),0===s?(a.className="unbordered text-right",a.textContent=i[r]+"  "):a.id=""+t+(s-1)+"t"+r,n.appendChild(a);p.appendChild(n)}l.appendChild(u),l.appendChild(p),c.appendChild(l),o.appendChild(c)}function Pe(){for(var e="",t=L.catData.length,n=0;n<t;n++)"$deleted"!==L.catData[n][0].substring(0,8)&&"CLINIC"!==L.catData[n][0]&&(e+=function(e){for(var t,n=0,a=0,r="",s=L.indexData.courses.length,i=0;i<s;i++)e===(t=N[L.indexData.courses[i]]).cat&&(""!==t.assgn&&n++,a++);return r+=0<a-n?e+": "+n+" ("+(a-n)+")\n":e+": "+n+"\n"}(L.catData[n][0]));O("coursesByCat").textContent=e,O("coursesByDef").textContent=function(){for(var e,t,n,a=[],r="",s=L.indexData.courses.length,i=L.indexData.klinics.length,d=0;d<i;d++)(t={}).name=L.indexData.klinics[d].name,t.count=0,a.push(t);for(d=0;d<s;d++)"CLINIC"===(e=N[L.indexData.courses[d]]).cat&&-1!==(n=a.map(function(e){return e.name}).indexOf(e.name))&&(a[n].count+=1);for(d=0;d<a.length;d++)r+=a[d].name+": "+a[d].count+"\n";return r}()||""}function He(){Ie(),Pe(),O("exit-stats").addEventListener("click",wn,{capture:!1,passive:!0}),cn("statistics"),on("displayOverrides"),on("left"),on("right")}function Te(){!function(){var e,t,n=L.indexData.courses.length;for(O("left").style.width="40%",O("right").style.width="60%",O("rightsidesettings").style.width="60%",O("leftsidesettings").style.width="40%",O("right").className+=" disabled",O("rightsidesettings").className+=" disabled",t=0;t<n;t++)e=L.indexData.courses[t],"CLINIC"!==N[e].cat&&(O("edrinit-"+e).style.display="inline-block",O("ref"+e).style.display="inline-block");for(t=0;t<L.catData.length;t++)cn("catedt"+[t+1])}(),O("startedr").removeEventListener("click",Te,{capture:!1,passive:!0}),O("startedr").addEventListener("click",Ae,{capture:!1,passive:!0}),O("startedr").textContent="Close",cn("addnewcourse"),cn("renamer"),cn("purger"),cn("openklinics"),on("klinicscontainer"),on("klinicHolder")}function Ae(){!function(){var e,t,n=L.indexData.courses.length;for(O("left").style.width="",O("right").style.width="",O("rightsidesettings").style.width="",O("leftsidesettings").style.width="",O("right").className=E(O("right").className,"disabled"),O("rightsidesettings").className=E(O("rightsidesettings").className,"disabled"),t=0;t<n;t++)O("edredit-"+(e=L.indexData.courses[t])).hasChildNodes&&k(O("edredit-"+e)),O("edrinit-"+e).style.display="none",O("edrsave-"+e).style.display="none",O("edredit-"+e).style.display="none",O("edrdel-"+e).style.display="none",O("ref"+e).style.display="block";for(t=0;t<L.catData.length;t++)on("catcontain"+[t+1]),on("catedt"+[t+1]),cn("catref"+[t+1])}(),O("startedr").removeEventListener("click",Ae,{capture:!1,passive:!0}),O("startedr").addEventListener("click",Te,{capture:!1,passive:!0}),O("startedr").textContent="",on("renamer"),on("newCNames"),on("addnewcourse"),on("purger"),on("openklinics"),nn(),Re("CLINIC")&&cn("klinicscontainer")}function Re(e){for(var t=!1,n=0;n<L.catData.length;n++)if(L.catData[n][0]===e){t=!0;break}return t}function Fe(){for(var e,t=[],n=L.indexData.schedules.length,a=0;a<n;a++)(e=I[L.indexData.schedules[a]]).cRef.length||6!==e.dayOff||t.push(L.indexData.schedules[a]);return t}function Ge(e){var t,n,a,r,s,i={},d=[];try{i=new Worker("autoBldr_14.min.js")}catch(e){return}n=Fe(),a=function(e){for(var t,n={},a=L.indexData.courses.length,r=0;r<a;r++)(t=N[L.indexData.courses[r]]).cat===e&&""===t.assgn&&(n[L.indexData.courses[r]]=t);return n}(e),r=L.settings,s=""+S.uiScheduleNumOfHrsPerDay,d.push(n,a,r,s),t=JSON.stringify(d),i.onmessage=function(e){!function(e){var t,n,a,r,s,i,d=JSON.parse(e.data),o=Object.keys(d),c=o.length;for(s=0;s<c;s++){for(a=o[s],n=d[a],t=n.cRef.length,i=0;i<t;i++)r=n.cRef[i],z(a,r),Vn(a,r,"on");I[a].dayOff=n.dayOff,O("off"+n.dayOff+a).style.color="#2c3e50",Wn(a),ge(a)}}(e)},i.postMessage(t)}function Be(e){var t=Number(e.substring(4))-1,n=L.catData[t][0];!0===function(e){var t,n,a=0,r=Fe(),s=!0,i=L.indexData.courses.length;!1===Re(e)&&(s=!1);"CLINIC"===e&&(s=!1);for(n=0;n<i;n++)(t=N[L.indexData.courses[n]]).cat===e&&""===t.assgn&&a++;!0===L.settings.overrides.maxHours?(window.mscAlert({title:"",subtitle:"Please turn off the override for MAX. HOURS!"}),s=!1):a<L.settings.maxHours/2?(window.mscAlert({title:"",subtitle:"Too few unassigned courses left to justify this action!"}),s=!1):r.length||(window.mscAlert({title:"",subtitle:"No empty schedules are available."}),s=!1);return s}(n)&&Ge(n)}function Ke(e,t){var n={text:" "+t,color:S.pdfCourseColors[e.indexOf(t)]||""};return e.length&&t!==e[e.length-1]&&(n.text=" "+t+", "),n}function qe(){var e,t,n,a=function(){for(var e,t=L.indexData.courses.map(function(e){if("CLINIC"===N[e].cat&&""!==N[e].assgn)return N[e]}).filter(function(e){return void 0!==e}),n=t.length,a=0;a<n;a++)(e=t[a]).tchr="unassigned",I[e.assgn].hasOwnProperty("tchr")&&""!==I[e.assgn].tchr&&(e.tchr=I[e.assgn].tchr);return t}(),r=L.indexData.klinics.map(function(e){return e.name}),s=[];for(y(r),n=0;n<r.length;n++)(e=a.filter(function(e){return e.name===r[n]})).length&&((t={}).def=r[n],t.inst=e,s.push(t));return s}function _e(t){var n,e={},a=T((new Date).toDateString()),r="dlklinicpdf"===t?(n="PrintClinics_"+a+".pdf",function(){var e,t,n,a,r,s,i,d,o,c=qe(),l={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},u=c.length;for(i=0;i<u;i++)if(c[i].inst.length){var p=c[i].inst[0].fullname,h=wt(c[i].inst[0].dept);for(""===p&&(p=c[i].def),e={text:p+" clinic - "+c[i].inst[0].rm.a+" "+h+"\n\n"},t={style:"default",table:{widths:[],body:[]}},n=R(""),(t={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),t.table.body.push([S.pdfBlankHr,"","","","",""]),d=0;d<n[0].length;d++)r="\n"+(S.uiTimeInputStartHr+d)+":00-"+(S.uiTimeInputStartHr+d)+":50",r+="\n("+(d+1)+")",t.table.body.push([r]);for(a={pageBreak:"after",text:[]},d=0;d<c[i].inst.length;d++)(s={text:"\n"}).text+=""+c[i].inst[d].tchr,"unassigned"===c[i].inst[d].tchr&&(s.color=S.pdfCourseColors[2]),n[c[i].inst[d].dayhr[0][0]][c[i].inst[d].dayhr[0][1]].hasOwnProperty("text")&&(s.color=S.pdfCourseColors[1],s.text+=n[c[i].inst[d].dayhr[0][0]][c[i].inst[d].dayhr[0][1]].text),n[c[i].inst[d].dayhr[0][0]][c[i].inst[d].dayhr[0][1]]=s;for(c[i].inst.hasOwnProperty("isSat")?(t.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],t.table.body[0].push("Saturday"),t.table.body[1].push("")):t.table.widths=["15%","17%","17%","17%","17%","17%"],d=2;d<t.table.body.length;d++)for(o=0;o<t.table.widths.length-1;o++)t.table.body[d].push(n[o][d-2]);l.content.push(e),l.content.push(t),l.content.push(a)}return JSON.stringify(l)}()):(n="PrintSchedules_"+a+".pdf",function(){var e,t,n,a,r,s,i,d,o,c,l,u,p,h,m,f,g={pageSize:"A4",content:[],styles:{default:{fontSize:10,alignment:"center"}}},v=L.indexData.schedules.length;for(h=0;h<v;h++)if(o=L.indexData.schedules[h],(c=I[o]).cRef.length){for(u=pe(o).split(", "),(n={text:[]}).text.push(c.display+" - "),m=0;m<u.length;m++)n.text.push(Ke(u,u[m]));for(n.text.push("\n"),a=R(""),(e={style:"default",table:{widths:[],body:[]}}).table.body.push(["","Monday","Tuesday","Wednesday","Thursday","Friday"]),e.table.body.push([S.pdfBlankHr,"","","","",""]),m=0;m<a[0].length;m++)p="\n"+(S.uiTimeInputStartHr+m)+":00-"+(S.uiTimeInputStartHr+m)+":50",p+="\n("+(m+1)+")",e.table.body.push([p]);for(t={pageBreak:"after",text:[]},m=0;m<c.cRef.length;m++)l=N[I[o].cRef[m]],r=""+l.name,s=""+l.name,i=Ke(u,l.cat),"CLINIC"===l.cat&&(s=""+l.fullname),s+="\n"+l.cat+"\n"+l.dept+l.rm.a,r+="\n"+l.cat+"\n"+l.dept,l.rm.hasOwnProperty("b")?r+=""+l.rm.b:r+=""+l.rm.a,l.hasOwnProperty("allowFollow")&&(d=function(e){var t={},n=e.split(/[^(0-9)]/g).filter(function(e){return""!==e});return t.a=n[0]+":"+n[1]+"-"+(Number(n[0])+1)+":"+(Number(n[1])+15),t.b=n[2]+":"+n[3]+"-"+(Number(n[2])+1)+":"+(Number(n[3])+15),t}(l.times),s+="\n("+d.a+")",r+="\n("+d.b+")"),a[l.dayhr[0][0]][l.dayhr[0][1]]={text:s,color:i.color},l.rm.hasOwnProperty("b")?a[l.dayhr[1][0]][l.dayhr[1][1]]={text:r,color:i.color}:a[l.dayhr[1][0]][l.dayhr[1][1]]={text:s,color:i.color},"threehour"===l.duration&&(a[l.dayhr[0][0]][l.dayhr[0][1]+1]={text:s,color:i.color});for(c.hasOwnProperty("tchr")&&""!==c.tchr&&n.text.push("Instructor: "+c.tchr),n.text.push("\n\n"),c.hasOwnProperty("isSat")?(e.table.widths=["15%","14.166%","14.166%","14.166%","14.166%","14.166%","14.166%"],e.table.body[0].push("Saturday"),e.table.body[1].push("")):e.table.widths=["15%","17%","17%","17%","17%","17%"],m=2;m<e.table.body.length;m++)for(f=0;f<e.table.widths.length-1;f++)e.table.body[m].push(a[f][m-2]);t.text=function(e){var t,n,a=[],r=I[e].cRef,s=r.length;for(n=0;n<s;n++)a.push(N[r[n]].dept);for(a.sort(),t=y(a),s=t.length,n=0;n<s;n++)t[n]="\n"+t[n]+" = "+wt(t[n]);return t}(o),g.content.push(n),g.content.push(e),g.content.push(t)}return JSON.stringify(g)}());O(t).className+=" disabled";try{e=new Worker("pdfWorker.js")}catch(e){return}e.onmessage=function(e){window.saveAs(e.data.pdfBlob,n),O(t).className=E(O(t).className,"disabled")},e.postMessage(r)}function Je(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return O("inputFile").reset(),void window.mscAlert({title:"Error",subtitle:"File is not .csv!"});window.Papa.parse(t,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){for(var t=[l.courseCat,l.courseNum,l.courseTime,l.courseRm],n=[!1,""],a=0;a<t.length;a++)if(-1===e.meta.fields.indexOf(t[a])){n[0]=!0,n[1]=t[a];break}!0===n[0]?(N={},window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+n[1]+'"'})):function(t,e){var n,a,r,s,i,d=t.length,o=[];for(ba(),i=0;i<d;i++)if("CLINIC"!==(r=t[i])[l.courseCat])try{if(n="c"+(i+1),s={assgn:""},a=nt(r[l.courseTime]),s.dayhr=st(a),s.times=rt(a),s.duration=a.type,"ninety"===s.duration&&(s.allowFollow=at(a.charArr[4],a.charArr[9])),s.cat=P(g(r[l.courseCat])),s.dept=et(r[l.courseRm]),s.name=H(r[l.courseNum]),s.rm=Qe(r[l.courseRm],a.type,s.dept),""===s.cat||""===s.dept||""===s.name||""===s.rm.a)throw new Error("Parsed value is empty string");N[n]=s}catch(e){o.push(t[i]);continue}o.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),At(e,o));Xe(N,!0)}(e.data,e.meta.fields),O("inputFile").reset(),on("parsing")}})}function Me(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return O("freshFile").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file."});window.Papa.parse(t,{worker:!0,header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t,n=[l.courseCat,l.courseNum,l.courseTime,l.courseRm],a=[!1,""],r=!1;for(L.newDepts=[],L.newKlinicDefs=[],L.newCourses=[],L.overwriteCourses=[],t=0;t<n.length;t++)if(-1===e.meta.fields.indexOf(n[t])){a[0]=!0,a[1]=n[t];break}!0===a[0]?(ee(),window.mscAlert({title:"Error",subtitle:'Your file is missing the required header: "'+a[1]+'"'})):(-1!==e.meta.fields.indexOf(l.courseTchr)&&(r=!0),function(t,e,n){var a,r,s,i,d=t.length,o=L.teachers,c=[];for(i=0;i<d;i++)if("CLINIC"===(s=t[i])[l.courseCat])try{if((a={cat:"CLINIC"}).name=s[l.courseNum],a.fullname=a.name,a.rm={},a.rm.a=D(v(s[l.courseRm])),a.dept=et(x(s[l.courseRm])),""===a.dept||""===a.name||""===a.rm.a)throw new Error("Parsed value is empty string");L.newKlinicDefs.push(JSON.parse(JSON.stringify(a)))}catch(e){c.push(s[l.courseCat]);continue}else try{if(a={assgn:""},r=nt(s[l.courseTime]),a.dayhr=st(r),a.times=rt(r),a.duration=r.type,"ninety"===a.duration&&(a.allowFollow=at(r.charArr[4],r.charArr[9])),a.cat=P(g(s[l.courseCat])),a.dept=et(s[l.courseRm]),a.name=H(s[l.courseNum]),a.rm=Qe(s[l.courseRm],r.type,a.dept),""===a.cat||""===a.dept||""===a.name||""===a.rm.a)throw new Error("Parsed value is empty string");!0===n&&null==o.filter(function(e){return e.en===s[l.courseTchr]||e.kor===s[l.courseTchr]})[0]&&""!==s[l.courseTchr]&&L.teachers.push({en:s[l.courseTchr],kor:s[l.courseTchr]}),L.newCourses.push(a)}catch(e){c.push(t[i]);continue}c.length&&(window.mscAlert({title:"",subtitle:'Some courses contain exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),At(e,c));Xe(L.newCourses,!1)}(e.data,e.meta.fields,r)),O("freshFile").reset(),on("parsing")}})}function je(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return O("inputTCHRS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(t,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var t;if(!e.data[0].hasOwnProperty("teachers"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "teachers"\n("강사명" is an optional ADMIN .csv display name).'});for(t=0;t<e.data.length;t++){var n,a=w(b(e.data[t].teachers)),r=w(b(e.data[t]["강사명"]))||"";""!==a&&(!0===ut(a)?""!==r&&(n=L.teachers.map(function(e){return e.en}).indexOf(a),L.teachers[n].kor=r):sn(a,r))}}O("inputTCHRS").reset()}})}function We(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return O("inputDEPTS").reset(),void window.mscAlert({title:"Error",subtitle:"Not a valid .csv file!"});window.Papa.parse(t,{header:!0,worker:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){if(e.data.length){var t;if(!e.data[0].hasOwnProperty("shortcode"))return void window.mscAlert({title:"",subtitle:'File is missing the required header: "shortcode"\n("description" is an optional header.)'});for(t=0;t<e.data.length;t++){var n,a=x(b(e.data[t].shortcode)),r=g(b(e.data[t].description))||"";""!==a&&(!0===gt(a)?""!==r&&(n=L.indexData.depts.map(function(e){return e.shortcode}).indexOf(a),L.indexData.depts[n].description=r):rn(a,r))}}O("inputDEPTS").reset()}})}function $e(e){var t;try{t=JSON.parse(e)[0],window.localStorage.setItem("statsBkUp",JSON.stringify(L)),Ft(t)}catch(e){return window.mscAlert({title:"Error",subtitle:"The JSON file you have supplied cannot be used."}),void function(){var e=JSON.parse(window.localStorage.getItem("statsBkUp"));L={},o(e)||(L=e);window.localStorage.removeItem("statsBkUp")}()}va(),ga(),nn(),fn(),window.mscAlert({title:"Success!",subtitle:"Settings, departments, groups, teachers and clinic definitions have been loaded from file."})}function Ve(e){var t,n=e.target.files[0];if("json"!==n.name.substring(n.name.length-4))return O("uploadJSON").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(t=new window.FileReader).onload=function(){$e(t.result)},t.readAsText(n),O("uploadJSON").reset()}function ze(){var e,t,n,a,r,s={},i=[],d=JSON.parse(JSON.stringify(L.settings));for(d.overrides.maxHours=!1,r=0;r<L.catData.length;r++)"CLINIC"!==L.catData[r][0]&&(s=new Worker("autoBldr_14.min.js"),t=L.indexData.schedules,n=function(e){for(var t,n={},a=L.indexData.courses.length,r=0;r<a;r++)(t=N[L.indexData.courses[r]]).cat===e&&(n[L.indexData.courses[r]]={},n[L.indexData.courses[r]].assign="",n[L.indexData.courses[r]].cat=t.cat,n[L.indexData.courses[r]].dayhr=t.dayhr,n[L.indexData.courses[r]].dept=t.dept,n[L.indexData.courses[r]].duration=t.duration,n[L.indexData.courses[r]].name=t.name,n[L.indexData.courses[r]].rm=t.rm,n[L.indexData.courses[r]].times=t.times,"ninety"===t.duration&&(n[L.indexData.courses[r]].allowFollow=t.allowFollow));return n}(L.catData[r][0]),a=""+S.uiScheduleNumOfHrsPerDay,(i=[]).push(t,n,d,a),e=JSON.stringify(i),s.onmessage=function(e){},s.onerror=function(e){throw e.preventDefault(),new Error("Cannot autoBld with this JSON.")},s.postMessage(e))}function Ue(e,t,n){var a,r;try{a=JSON.parse(e),!0===t?(N={},I={},s(),Ft(a[0])):(L=a[0],N=a[1],I=a[2],r=a[3],Object.keys(r).forEach(function(e){"string"==typeof r[e]&&""!==r[e]&&void 0!==l[e]&&(l[e]=r[e])}),S.uiTimeInputStartHr=a[4].uiTimeInputStartHr,S.uiScheduleNumOfHrsPerDay=a[4].uiScheduleNumOfHrsPerDay,ze())}catch(e){return void Ht(n)}try{ye(!0)}catch(e){return Ht(n),void $t()}F()}function Ye(e){var t,n=e.target.files[0],a=O("settingsOnly").checked;if("json"!==n.name.substring(n.name.length-4))return O("inputJSON").reset(),O("settingsOnly").checked=!1,void window.mscAlert({title:"Error",subtitle:"Not a .json file!"});(t=new window.FileReader).onload=function(){Ue(t.result,a,0)},t.readAsText(n),O("inputJSON").reset(),O("settingsOnly").checked=!1}function Ze(e){var t=e.target.files[0];if("csv"!==t.name.substring(t.name.length-3))return O("inputRENAME").reset(),void window.mscAlert({title:"Error",subtitle:"Not a .csv file!"});window.Papa.parse(t,{header:!0,dynamicTyping:!1,encoding:"",skipEmptyLines:!0,complete:function(e){var t=[];if(e.data.length){if(!e.data[0].hasOwnProperty(l.oldNum)||!e.data[0].hasOwnProperty(l.newNum))return void window.mscAlert({title:"",subtitle:'File is missing the required headers: "'+l.oldNum+'" and "'+l.newNum+'".'});for(var n=0;n<e.data.length;n++)t.push([H(b(e.data[n][l.oldNum])),H(b(e.data[n][l.newNum]))])}!function(e){for(var t,n=e.length-1;0<=n;n--)null!=(t=p(e[n][0]))&&(e[n][0]=t);for(n=0;n<e.length;n++)try{O("newName-"+e[n][0]).value=e[n][1]}catch(e){continue}}(t),O("inputRENAME").reset()}})}function Xe(e,t){var n=function(e,t){var n,a,r,s=0,i=Object.keys(e),d=["assgn","cat","dayhr","dept","duration","name","rm","times"],o=d.length;!0===t&&(i=i.map(function(e){return Number(e)}));for(a=i.length-1;0<=a;a--){for(n=!0,r=0;r<o;r++)(function(e,t){if(!t.hasOwnProperty(e))return!1;if("assgn"!==e&&""===t[e])return!1;if("name"===e&&(t[e].length!==S.courseNameNumLength||Number(t[e])<1||Number.isNaN(Number(t[e]))))return!1;if("dayhr"===e&&t[e][0].identical(t[e][1]))return!1;return!0})(d[r],e[i[a]])||(n=!1);!1===n&&(s+=1,!0===t?e.splice(a,1):delete e[i[a]])}return s}(e,void 0);0<n&&window.mscAlert({title:"",subtitle:n+' course(s) contain(s) exceptions and cannot be imported.\nPlease refer to the "CSV_ERRORS" file download for details.'}),(!0!==t?te:Le)()}function Qe(e,t,n){var a={},r=v(e).split(n).filter(function(e){return""!==e});return a.a=r[0],1<r.length&&("onehour"===t||"ninety"===t)&&(a.b=r[1]),a}function et(e){var t=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter(function(e){return""!==e}),n="error";return t.length&&(n=t[0]),n}function tt(e,t){return e>=Number(S.uiTimeInputStartHr)&&e<t}function nt(e){var t=function(e){var t,n,a,r,s=function(e){var t={charArr:[],type:"error"},n=e.split(/[^\u3130-\u318F\uAC00-\uD7AF]/).filter(function(e){return""!==e}),a=e.split(/[^0-9]/).filter(function(e){return""!==e}),r=n.length,s=a.length;return 2!==s&&4!==s&&8!==s||(2===r&&8===s&&(a.splice(0,0,n[0]),a.splice(5,0,n[1]),t.type="1"),1===r&&(4===s&&(t.type="2"),2===s&&(t.type="3"),a.unshift(n[0])),t.charArr=a),t}(e),i=s.charArr[2];if("error"===s.type)return s;if("3"===s.type&&"00"===i)return s.type="klinichour",s;"00"===i&&(t=Number(s.charArr[3])-Number(s.charArr[1]),"50"===s.charArr[4]&&("2"===s.type&&(1===t&&(s.type="twohour"),2===t&&(s.type="threehour")),"1"===s.type&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],0===t&&0===r&&"00"===n&&"50"===a&&(s.type="onehour"))),"15"===s.charArr[4]&&"1"===s.type&&1===t&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],1===r&&(s.type="ninety")));"30"===i&&"1"===s.type&&(t=Number(s.charArr[3])-Number(s.charArr[1]),"45"===s.charArr[4]&&1===t&&(r=Number(s.charArr[8])-Number(s.charArr[6]),n=s.charArr[7],a=s.charArr[9],1===r&&(s.type="ninety")));return s}(e),n=!1,a=Number(S.uiTimeInputStartHr)+Number(S.uiScheduleNumOfHrsPerDay),r={onehour:a,ninety:a-1,twohour:a-1,threehour:a-2,klinichour:a};if("error"!==t.type&&(n=tt(Number(t.charArr[1]),r[t.type]),"klinichour"!==t.type&&(n=tt(Number(t.charArr[3]),r[t.type]),"twohour"!==t.type&&"threehour"!==t.type&&(n=tt(Number(t.charArr[6]),r[t.type])&&tt(Number(t.charArr[8]),r[t.type])))),!0!==n)throw new Error("Unexpected day/time values");return t}function at(e,t){var n=[];return n[0]=Boolean(!1),n[1]=Boolean(!1),"15"===e&&(n[0]=Boolean(!0)),"15"===t&&(n[1]=Boolean(!0)),n}function rt(e){var t="";return"error"!==e.type&&(t+=e.charArr[0]+""+e.charArr[1]+":"+e.charArr[2],"klinichour"!==e.type&&("twohour"!==e.type&&"threehour"!==e.type||(t+="-"+e.charArr[3]+":"+e.charArr[4]),"onehour"!==e.type&&"ninety"!==e.type||(t+=","+e.charArr[5]+e.charArr[6]+":"+e.charArr[7]))),t}function st(e){var t={"월":0,"화":1,"수":2,"목":3,"금":4,"토":5},n=[[],[]],a=Number(S.uiTimeInputStartHr);if("error"!==e.type&&(n[0][0]=t[e.charArr[0]],n[0][1]=Number(e.charArr[1])-a,"klinichour"!==e.type&&("twohour"!==e.type&&"threehour"!==e.type||(n[1][0]=t[e.charArr[0]],n[1][1]=Number(e.charArr[3])-a),"onehour"!==e.type&&"ninety"!==e.type||(n[1][0]=t[e.charArr[5]],n[1][1]=Number(e.charArr[6])-a)),"klinichour"===e.type&&(n[1][0]=t[e.charArr[0]],n[1][1]=Number(e.charArr[1])-a),n[0][0]===n[1][0]&&n[0][1]===n[1][1]&&(e.type="error")),"error"===e.type)throw new Error("Unexpected day/time values");return n}function it(e){!function(e){var t,n,a=O("tchredt"+e),r=document.createDocumentFragment(),s=document.createElement("option"),i=L.teachers.length;if(k(a),s.value="",s.textContent="select teacher",r.appendChild(s),i)for(n=0;n<i;n++)(t=document.createElement("option")).value=""+L.teachers[n].en,t.textContent=t.value,r.appendChild(t);if(a.appendChild(r),a.options[0].disabled=!0,I[e].hasOwnProperty("tchr")&&""!==I[e].tchr)for(n=1;n<a.options.length;n++)if(I[e].tchr===a.options[n].value){a.selectedIndex=n;break}}(e),on("tchrsee"+e),cn("tchrchg"+e)}function dt(e){var t=O("tchrset"+e);"unassigned"!==t.textContent&&(t.textContent="unassigned",I[e].tchr="",ot(e))}function ot(e){(""!==I[e].tchr&&I[e].hasOwnProperty("tchr")?cn:on)("tchrclr"+e)}function ct(){var e,t,n=L.indexData.schedules.length;for(O("showteachers").removeEventListener("click",ct,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",lt,{capture:!1,passive:!0}),O("showteachers").textContent="Hide",t=0;t<n;t++)ot(e=L.indexData.schedules[t]),ln(e),cn("tchrsee"+e)}function lt(){var e,t,n,a=L.indexData.schedules.length;for(O("showteachers").removeEventListener("click",lt,{capture:!1,passive:!0}),O("showteachers").addEventListener("click",ct,{capture:!1,passive:!0}),O("showteachers").textContent="Show",t=0;t<a;t++)on("tchrsee"+(e=L.indexData.schedules[t])),O(n=e).className=E(O(n).className,"show-teacher"),on("tchrchg"+e)}function ut(e){var t,n=!1,a=L.teachers.length;if(a)for(t=0;t<a;t++)if(L.teachers[t].en.toLowerCase()===e.toLowerCase()){n=!0;break}return n}function pt(){var e,t,n=L.indexData.schedules.length;for(!function(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("alltchrs")),r=0;r<L.teachers.length;r++)e=document.createElement("div"),t=document.createElement("input"),n=document.createElement("input"),a=document.createElement("span"),e.id="prsn"+[r],t.type="text",t.id="prsnnm"+[r],t.className="inputstyle",t.value=L.teachers[r].en,t.maxLength=32,n.type="text",n.id="prsnKR"+[r],n.className="inputstyle",n.value=L.teachers[r].kor,n.maxLength=32,n.placeholder="csv name",a.id="prsndel"+[r],a.className="btn btn-xs btn-danger deletex pull-right",a.textContent="✖",e.appendChild(t),e.appendChild(n),e.appendChild(a),s.appendChild(e);O("alltchrs").appendChild(s)}(),on("displayOverrides"),on("left"),on("right"),O("exit-tchrs").addEventListener("click",ht,{capture:!1,passive:!0}),O("save-tchrs").addEventListener("click",ft,{capture:!1,passive:!0}),O("alltchrs").addEventListener("click",zn,{capture:!1,passive:!0}),O("tchrs-file").addEventListener("change",je,{capture:!1,passive:!0}),O("tchradd").addEventListener("click",mt,{capture:!1,passive:!0}),cn("tchrs-section"),t=0;t<n;t++)O(e=L.indexData.schedules[t]).classList.contains("show-teacher")&&(cn("tchrsee"+e),on("tchrchg"+e))}function ht(){k(O("alltchrs")),on("tchrs-section"),O("exit-tchrs").removeEventListener("click",ht,{capture:!1,passive:!0}),O("save-tchrs").removeEventListener("click",ft,{capture:!1,passive:!0}),O("alltchrs").removeEventListener("click",zn,{capture:!1,passive:!0}),O("tchrs-file").removeEventListener("change",je,{capture:!1,passive:!0}),O("tchradd").removeEventListener("click",mt,{capture:!1,passive:!0}),cn("displayOverrides"),cn("left"),cn("right")}function mt(){sn("","")}function ft(){var e,t,n,a,r=O("alltchrs").childNodes;for(L.teachers=[],a=0;a<r.length;a++)1==r[a].nodeType&&""!==r[a].childNodes[0].value&&void 0!==r[a].childNodes[0].value&&((e={}).en=r[a].childNodes[0].value,e.kor=r[a].childNodes[1].value,L.teachers.push(e));if(L.teachers.length){for(a=0;a<L.teachers.length;a++)L.teachers[a].en=b(w(L.teachers[a].en)),L.teachers[a].kor=b(w(L.teachers[a].kor));L.teachers.sort(function(e,t){return e.en.localeCompare(t.en)}),L.teachers=function(e,t){for(var n,a=[],r=e.length,s=0;s<r;s++){for(n=s+1;n<r;n++)e[s][t].toLowerCase()===e[n][t].toLowerCase()&&(n=++s);a.push(e[s])}return a}(L.teachers,"en")}for(t=L.indexData.schedules.length,a=0;a<t;a++)n=L.indexData.schedules[a],!I[n].hasOwnProperty("tchr")||""===I[n].tchr||L.teachers.length&&-1!==L.teachers.map(function(e){return e.en}).indexOf(I[n].tchr)||dt(n);ht()}function gt(e){var t,n=!1,a=L.indexData.depts.length;if(a)for(t=0;t<a;t++)if(L.indexData.depts[t].shortcode===e){n=!0;break}return n}function vt(){rn("","")}function yt(e){for(var t,n=!0,a=L.indexData.courses.length,r=0;r<a;r++)if(t=L.indexData.courses[r],N[t].dept===e){n=!1;break}return n}function xt(){for(var e,t,n,a,r,s,i,d,o=O("deptEDIT").childNodes,c=[],l=[],u=o.length,p=0;p<u;p++)1==o[p].nodeType&&(e=x(o[p].childNodes[0].value),t=g(o[p].childNodes[1].value),n=L.indexData.depts.map(function(e){return e.shortcode}).indexOf(e),void 0!==e&&""!==e&&((a={}).shortcode=e,a.description=t,c.push(a),-1===n?L.indexData.depts.push(a):L.indexData.depts[n].description=t));for((u=L.indexData.depts.length)&&(L.indexData.depts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.indexData.depts=h(L.indexData.depts,"shortcode")),p=0;p<u;p++)s=L.indexData.depts[p].shortcode,-1===c.map(function(e){return e.shortcode}).indexOf(s)&&!0===yt(s)&&l.push(s);for(u=l.length,p=0;p<u;p++)for(i=L.indexData.depts.length-1;0<=i;i--)L.indexData.depts[i].shortcode===l[p]&&L.indexData.depts.splice(i,1);if(Qt(),(r=L.settings.deptGrps).length&&u)for(p=0;p<u;p++)for(i=0;i<r.length;i++)for(d=r[i].length-1;0<=d;d--)r[i][d]===l[p]&&r[i].splice(d,1);we(),O("setting-section").classList.contains("nodisplay")?ea():(en(),an()),xa()}function wt(t){var e=L.indexData.depts.filter(function(e){return e.shortcode===t})[0];return null==e?"":e.description}function bt(e,t){var n=Number(O("newgroupid").dataset.grpindex),a=O(e),r=a.dataset.deptname,s=L.settings.deptGrps;if(!0===t)return a.style.backgroundColor="#3498db",a.style.color="#ffffff",a.style.borderColor="#3498db",s.length&&s[n]||L.settings.deptGrps.push([]),void(-1===s[n].indexOf(r)&&L.settings.deptGrps[n].push(r));a.style.backgroundColor="",a.style.color="",a.style.borderColor="",(s=L.settings.deptGrp)[n]&&s[n].length&&-1!==s[n].indexOf(r)&&L.settings.deptGrps[n].splice(L.settings.deptGrps[n].indexOf(r),1)}function Dt(e){var t,n;e.target!==e.currentTarget&&"remove"==e.target.id.substring(0,6)&&(t=Number(e.target.id.substring(6)),L.settings.deptGrps[t]&&(n=t,L.settings.deptGrps.splice(n,1),O("newgroupid").dataset.grpindex=L.settings.deptGrps.length,an())),e.stopPropagation()}function Ct(){L.indexData.depts.length?(on("displayOverrides"),O("left").style.visibility="hidden",O("right").style.visibility="hidden",O("exitklinicchanges").addEventListener("click",Nt,{capture:!1,passive:!0}),O("saveklinicchanges").addEventListener("click",Jt,{capture:!1,passive:!0}),O("klinic-section").addEventListener("click",It,{capture:!1,passive:!0}),O("klinicadd").addEventListener("click",tn,{capture:!1,passive:!0}),function(){var e,t,n,a,r,s,i,d,o,c,l,u,p,h;if(k(O("klinic-section")),!L.indexData.klinics.length)return;for(e=document.createDocumentFragment(),t=L.indexData.klinics.length,p=0;p<t;p++){for(a=document.createElement("div"),r=document.createElement("input"),s=document.createElement("input"),i=document.createElement("select"),d=document.createElement("input"),o=document.createElement("span"),c=document.createElement("option"),n=L.indexData.klinics[p],o.id="kldel_"+p,o.className="btn btn-xs btn-danger deletex pull-right",o.textContent="✖",a.id="kl_"+p,r.id="klnm_"+p,r.type="text",r.className="btn-xs disabled",r.style.width="90px",r.style.verticalAlign="middle",r.style.padding="2px",r.value=n.name,s.id="klfn_"+p,s.type="text",s.className="inputStyle",s.style.width="160px",s.style.verticalAlign="middle",s.style.padding="2px",s.value=n.fullname,s.maxLength=32,s.placeholder="full .pdf name",i.id="kldp_"+p,i.className="select-styles",i.style.marginRight="1px",d.id="klrm_"+p,d.type="text",d.className="inputStyle",d.style.width="80px",d.style.verticalAlign="middle",d.style.padding="2px",d.value=n.rm.a,d.maxLength=8,d.placeholder="room",c.value="",c.textContent="dept",i.appendChild(c),h=0;h<L.indexData.depts.length;h++)(l=document.createElement("option")).value=L.indexData.depts[h].shortcode,l.textContent=l.value,i.appendChild(l);a.appendChild(r),a.appendChild(s),a.appendChild(i),a.appendChild(d),a.appendChild(o),e.appendChild(a)}for(O("klinic-section").appendChild(e),p=0;p<L.indexData.klinics.length;p++)for((u=O("kldp_"+p)).options[0].disabled=!0,h=1;h<u.options.length;h++)if(L.indexData.klinics[p].dept===u.options[h].value){u.selectedIndex=h;break}}(),cn("defineklinics")):window.mscAlert({title:"",subtitle:"Please define at least one department first.\n(New course or category -> Edit departments)"})}function Nt(){on("defineklinics"),O("exitklinicchanges").removeEventListener("click",Nt,{capture:!1,passive:!0}),O("saveklinicchanges").removeEventListener("click",Jt,{capture:!1,passive:!0}),O("klinic-section").removeEventListener("click",It,{capture:!1,passive:!0}),O("klinicadd").removeEventListener("click",tn,{capture:!1,passive:!0}),Ae(),O("left").style.visibility="visible",O("right").style.visibility="visible",cn("displayOverrides")}function kt(e,t){var n;if(!0===t)for(n=0;n<e.length;n++)e[n]=e[n].toLowerCase();return e.length!==y(e).length}function Et(){O("klinicHold").checked?L.tempKlinic.isHeld=!0:L.tempKlinic.isHeld=!1}function St(e){O("klinicHold").checked="on"===e,Et()}function Lt(e,t){var n,a,r=function(e,t){var n,a,r,s,i,d=On(e),o="c1";if(4!==d.length)return;if(0!==d[1])return;n=[],a=[d[2],d[3]],n.push(a,a),L.indexData.courses.length&&(o="c"+(Number(L.indexData.courses[L.indexData.courses.length-1].substring(1))+1));if(r=L.indexData.klinics.map(function(e){return e.name}).indexOf(t),!L.indexData.klinics.length)return;if(-1===r)return;for(s=L.indexData.klinics[r],L.indexData.courses.push(o),N[o]={},N[o].cat="CLINIC",N[o].dept=s.dept,N[o].rm={},N[o].rm.a=s.rm.a,N[o].dayhr=n,N[o].name=s.name,N[o].fullname=s.fullname,N[o].times=function(e){return""+S.monToSatKr[e[0]]+("0"+(e[1]+Number(S.uiTimeInputStartHr))).slice(-2)+":00"}(a),N[o].duration="klinichour",N[o].assgn="",i=0;i<L.catData.length;i++)if(L.catData[i][0]===N[o].cat){L.catData[i][1]+=1,L.catData[i][2][N[o].dayhr[0][0]][N[o].dayhr[0][1]]+=1;break}!1===L.tempKlinic.isHeld&&(L.tempKlinic.kbtn="");return[d[0],o]}(e,t),s=L.catData.length;if(null!=r){for(a=0;a<s;a++)if(L.catData[a][0]===N[r[1]].cat){n=a+1;break}Mt(r[1],n),ue(r[0],r[1])}}function It(e){var t,n;e.target!==e.currentTarget&&"kldel_"===e.target.id.substring(0,6)&&(t=e.target.id,O("klnm_"+(n=t.substring(6))).value="",O("klfn_"+n).value="",on("kl_"+n))}function Ot(){var e,t=window.localStorage.getItem("lastStats"),n=window.localStorage.getItem("lastCourseData"),a=window.localStorage.getItem("lastScheduleData"),r=window.localStorage.getItem("lastCsvStrs"),s=window.localStorage.getItem("lastCfg");null!==t&&null!==n&&null!==a&&null!==s?(e="["+t+","+n+","+a,e+=null!==r?","+r:",{}",Ue(e+=","+s+"]",!1,1)):window.mscAlert({title:"",subtitle:"No previous session available."})}function Pt(){var e,t,n;if(!o(L)&&L.hasOwnProperty("catData")){if(L.catData.length){for(n=L.catData.length-1;0<=n;n--)"$deleted"===L.catData[n][0].substring(0,8)&&L.catData.splice(n,1);for(e=0,L.indexData.schedules.length>L.indexData.courses.length/(L.settings.maxHours/2)&&(e=L.indexData.schedules.length-Math.round(L.indexData.courses.length/(L.settings.maxHours/2))),n=L.indexData.schedules.length-1;0<=n;n--)if(!I[L.indexData.schedules[n]].cRef.length&&6===I[L.indexData.schedules[n]].dayOff){if(--e<=0)break;delete I[L.indexData.schedules[n]],L.indexData.schedules.splice(n,1)}}(t={}).uiTimeInputStartHr=S.uiTimeInputStartHr,t.uiScheduleNumOfHrsPerDay=S.uiScheduleNumOfHrsPerDay,window.localStorage.clear(),window.localStorage.setItem("lastStats",JSON.stringify(L)),window.localStorage.setItem("lastCourseData",JSON.stringify(N)),window.localStorage.setItem("lastScheduleData",JSON.stringify(I)),window.localStorage.setItem("lastCsvStrs",JSON.stringify(l)),window.localStorage.setItem("lastCfg",JSON.stringify(t))}}function Ht(e){L={},N={},I={},l={courseCat:d("courseCat"),courseNum:d("courseNum"),courseTime:d("courseTime"),courseRm:d("courseRm"),courseTchr:d("courseTchr"),oldNum:d("oldNum"),newNum:d("newNum")},ba(),O("inputJSON").reset(),O("settingsOnly").checked=!1,O("configStartHr").disabled=!1,O("configNumOfHrsPerDay").disabled=!1,cn("parsing"),window.mscAlert({title:"",subtitle:["The JSON file you have supplied cannot be used.","The last saved session is unusable and has been deleted."][e]}),1===e&&window.localStorage.clear()}function Tt(e,t,n){var a=e+"_"+T((new Date).toDateString())+"."+t,r="csv"===t?window.Papa.unparse(n):n,s=new Blob([r],{type:S.uriTypes[t]});window.saveAs(s,a)}function At(e,t){var n={fields:[],data:[]};n.fields=e,n.data=t,Tt("CSV_ERRORS","csv",n)}function Rt(e,t){return("0"+(e+Number(S.uiTimeInputStartHr)+t).toString()).slice(-2)}function Ft(t){var e,n,a,r,s;if(!t.hasOwnProperty("settings"))throw new Error("Prop 'settings' is undefined.");if(!t.settings.hasOwnProperty("overrides"))throw new Error("Prop 'overrides' is undefined.");if("day"!==t.settings.deptGrpsSetBy&&"week"!==t.settings.deptGrpsSetBy||(L.settings.deptGrpsSetBy=t.settings.deptGrpsSetBy),t.settings.maxHours<=5*S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHours=t.settings.maxHours),t.settings.maxHrsPerDay<=S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHrsPerDay=t.settings.maxHrsPerDay),2!==t.settings.maxSeqHrs&&3!==t.settings.maxSeqHrs||(L.settings.maxSeqHrs=t.settings.maxSeqHrs),Object.keys(t.settings.overrides).forEach(function(e){"boolean"==typeof t.settings.overrides[e]&&void 0!==L.settings.overrides[e]&&(L.settings.overrides[e]=t.settings.overrides[e])}),t.settings.hasOwnProperty("deptGrps")&&t.settings.deptGrps.length)for(r=0;r<t.settings.deptGrps.length;r++)if((a=t.settings.deptGrps[r].map(x).filter(function(e){return""!==e})).length){for(e=-1,s=0;s<L.settings.deptGrps.length;s++)if(a.identical(L.settings.deptGrps[s])){e=1;break}1!==e&&(function(e){var t,n;if(e.length&&L.hasOwnProperty("indexData")&&L.indexData.hasOwnProperty("depts"))for(n=0;n<e.length;n++)!0!==gt(t=e[n])&&L.indexData.depts.push({shortcode:t,description:""})}(a),L.settings.deptGrps.push(a))}if(t.hasOwnProperty("teachers")&&t.teachers.length)for(r=0;r<t.teachers.length;r++){if(!t.teachers[r].hasOwnProperty("en"))throw new Error("Prop 'en' is undefined.");t.teachers[r].en=w(t.teachers[r].en),""!==(n=t.teachers[r]).en&&(!1!==ut(n.en)?L.teachers[e].kor=n.kor||L.teachers[e].kor:L.teachers.push(n))}if(t.hasOwnProperty("indexData")){if(t.indexData.hasOwnProperty("klinics")&&t.indexData.klinics.length)for(r=0;r<t.indexData.klinics.length;r++){if(!t.indexData.klinics[r].hasOwnProperty("name"))throw new Error("Prop 'name' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("fullname"))throw new Error("Prop 'fullname' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("dept"))throw new Error("Prop 'dept' is undefined.");if(!t.indexData.klinics[r].hasOwnProperty("rm"))throw new Error("Prop 'rm' is undefined.");if(!t.indexData.klinics[r].rm.hasOwnProperty("a"))throw new Error("Prop 'rm.a' is undefined.");if(t.indexData.klinics[r].dept=x(t.indexData.klinics[r].dept),t.indexData.klinics[r].rm.a=D(v(t.indexData.klinics[r].rm.a)),""===t.indexData.klinics[r].dept)throw new Error("Value of 'dept' is an empty string.");if(""===t.indexData.klinics[r].rm.a)throw new Error("Value of 'rm.a' is an empty string.");n=t.indexData.klinics[r],-1===(e=L.indexData.klinics.map(function(e){return e.name}).indexOf(n.name))?(t.indexData.hasOwnProperty("depts")&&!1===gt(t.indexData.klinics[r].dept)&&t.indexData.depts.push(t.indexData.klinics[r].dept),L.indexData.klinics.push(n)):(L.indexData.klinics[e].fullname=n.fullname,L.indexData.klinics[e].dept=n.dept,L.indexData.klinics[e].rm={},L.indexData.klinics[e].rm.a=n.rm.a)}if(t.indexData.hasOwnProperty("depts")&&t.indexData.depts.length)for(r=0;r<t.indexData.depts.length;r++){if(!t.indexData.depts[r].hasOwnProperty("shortcode"))throw new Error("Prop 'shortcode' is undefined.");t.indexData.depts[r].shortcode=x(t.indexData.depts[r].shortcode),""!==(n=t.indexData.depts[r]).shortcode&&(!1!==gt(n.shortcode)?L.indexData.depts[e].description=n.description||L.indexData.depts[e].description:L.indexData.depts.push(n))}}}function Gt(e,t){var n=["Please choose a "+S.courseNameNumLength+" digit course name greater than zero.","A course named : "+t+" already exists.\nPlease choose a different name.","Please define all parameters.","Classes cannot have overlapping times!","Both classes cannot start at the same time!"];window.mscAlert({title:"",subtitle:n[e]})}function Bt(){var e,t,n,a,r,s,i,d,o,c,l,u,p,h=O("durationninety").checked?"ninety":O("durationtwo").checked?"twohour":O("durationthree").checked?"threehour":"onehour",m=(e=h,t={},n="",a=O("newhrsone").selectedIndex,r=O("newcourseroomB").value,t.newName=O("newcoursename").value,t.newRm={},t.newRm.a=O("newcourseroom").value,t.newCat=O("newcoursecat").options[O("newcoursecat").selectedIndex].value,t.newDept=O("newcoursedept").options[O("newcoursedept").selectedIndex].value,n+=""+O("newdayone").options[O("newdayone").selectedIndex].value+O("newhrsone").options[a].value,"twohour"!==e&&"threehour"!==e&&(n+=","+O("newdaytwo").options[O("newdaytwo").selectedIndex].value+O("newhrstwo").options[O("newhrstwo").selectedIndex].value),"twohour"===e&&(n+="-"+(a+10)+":50"),"threehour"===e&&(n+="-"+(a+11)+":50"),t.newTimes=n,t.newName=H(t.newName),t.newRm.a=C(t.newRm.a),""!==(r=C(r))&&r!==t.newRm.a&&(t.newRm.b=r),t),f=(s=h,i=[],d=[[0,0],[0,0]],o=O("newhrsone").selectedIndex,c=O("newhrstwo").selectedIndex,l=O("newdayone").selectedIndex,u=O("newdaytwo").selectedIndex,d[0][0]=l,"ninety"===s?(d[1][0]=u,o%2==1?(d[0][1]=(o-1)/2,i.push(Boolean(!1))):(d[0][1]=o/2,i.push(Boolean(!0))),c%2==1?(d[1][1]=(c-1)/2,i.push(Boolean(!1))):(d[1][1]=c/2,i.push(Boolean(!0)))):(d[0][1]=o,"twohour"===s?(d[1][0]=l,d[1][1]=o+1):"threehour"===s?(d[1][0]=l,d[1][1]=o+2):(d[1][0]=u,d[1][1]=c)),[d,i]),g="c1",v=L.indexData.courses.length;if(v&&(g="c"+(Number(L.indexData.courses[v-1].substring(1))+1)),m.newName.length!==S.courseNameNumLength||Number(m.newName)<1||Number.isNaN(Number(m.newName)))return Gt(0),"nada";for(p=0;p<v;p++)if(N[L.indexData.courses[p]].name===m.newName)return Gt(1,m.newName),"nada";if(""===m.newName||""===m.newCat||""===m.newDept||""===m.newRm.a)return Gt(2),"nada";if("ninety"==h&&f[0][0][0]===f[0][1][0])if(f[0][0][1]+1===f[0][1][1]){if(!0!==f[1][0]||!0===f[1][0]&&!1!==f[1][1])return Gt(3),"nada"}else if(f[0][0][1]===f[0][1][1]+1&&(!0!==f[1][1]||!0===f[1][1]&&!1!==f[1][0]))return Gt(3),"nada";if(f[0][0].identical(f[0][1]))return Gt(4),"nada";for(L.indexData.courses.push(g),N[g]={},N[g].cat=m.newCat,N[g].dept=m.newDept,N[g].rm={},N[g].rm.a=m.newRm.a,m.newRm.hasOwnProperty("b")&&(N[g].rm.b=m.newRm.b),N[g].dayhr=f[0],N[g].name=m.newName,N[g].times=m.newTimes,N[g].duration=h,N[g].assgn="",f[1].length&&(N[g].allowFollow=f[1]),p=0;p<L.catData.length;p++)if(L.catData[p][0]===N[g].cat){L.catData[p][1]+=1,L.catData[p][2][N[g].dayhr[0][0]][N[g].dayhr[0][1]]+=1,L.catData[p][2][N[g].dayhr[1][0]][N[g].dayhr[1][1]]+=1,"threehour"===N[g].duration&&(L.catData[p][2][N[g].dayhr[0][0]][N[g].dayhr[0][1]+1]+=1);break}return g}function Kt(e){var t,n,a,r,s,i,d=0;if(!function(){var e,t=L.newDepts.length;if(t){for(e=0;e<t;e++)L.indexData.depts.push(L.newDepts[e]);1<L.indexData.depts.length&&L.indexData.depts.sort(function(e,t){return e.shortcode.localeCompare(t.shortcode)}),L.newDepts=[]}delete L.newDepts}(),!0===e)for(s=L.overwriteCourses.length-1;0<=s;s--)for(i=L.indexData.courses.length-1;0<=s;i--)if(t=L.overwriteCourses[s],n=N[L.indexData.courses[i]],t.name===n.name){t.cat!==n.cat&&(L.newCourses.push(t),L.overwriteCourses.splice(s,1),ne(L.indexData.courses[i]));break}if(L.indexData.courses.length&&(d=Number(L.indexData.courses[L.indexData.courses.length-1].substring(1))),L.newCourses.length)for(s=0;s<L.newCourses.length;s++)Re((n=L.newCourses[s]).cat)||Q(!1,n.cat),function(e,t){var n;for(L.indexData.courses.push(e),N[e]={},N[e].cat=t.cat,N[e].dept=t.dept,N[e].rm={},N[e].rm.a=t.rm.a,t.rm.hasOwnProperty("b")&&(N[e].rm.b=t.rm.b),N[e].dayhr=t.dayhr,N[e].name=t.name,N[e].times=t.times,N[e].duration=t.duration,N[e].assgn="",t.hasOwnProperty("allowFollow")&&(N[e].allowFollow=t.allowFollow),n=0;n<L.catData.length;n++)if(L.catData[n][0]===N[e].cat){L.catData[n][1]+=1,L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]]+=1,L.catData[n][2][N[e].dayhr[1][0]][N[e].dayhr[1][1]]+=1,"threehour"===N[e].duration&&(L.catData[n][2][N[e].dayhr[0][0]][N[e].dayhr[0][1]+1]+=1);break}}("c"+ ++d,n);if(!function(){var e,t=L.newKlinicDefs.length;if(t){for(Re("CLINIC")||Q(!1,"CLINIC"),e=0;e<t;e++)-1===L.indexData.klinics.map(function(e){return e.name}).indexOf(L.newKlinicDefs[e].name)&&L.indexData.klinics.push(L.newKlinicDefs[e]);L.indexData.klinics.sort(function(e,t){return e.name.localeCompare(t.name)}),L.newKlinicDefs=[]}delete L.newKlinicDefs}(),!0===e)for(s=0;s<L.overwriteCourses.length;s++)a=function(e,t){for(var n in t)if(t[n].name===e)return n;return!1}((t=L.overwriteCourses[s]).name,N),(r=""+(n=N[a]).assgn)&&le(r,a),n.dept=t.dept,n.rm={},n.rm.a=t.rm.a,t.rm.hasOwnProperty("b")&&(n.rm.b=t.rm.b),n.dayhr=t.dayhr,n.times=t.times,n.duration=t.duration,t.hasOwnProperty("allowFollow")&&(n.allowFollow=t.allowFollow),r&&(z(r,a),J(r,a)||(Vn(r,a,"on"),Wn(r),ge(r)));o(I)?(L.indexData.schedules=[],Ee(!0)):Ee(!1),ee(),$t(),ye(!0),na()}function qt(e){for(var t,n,a,r,s,i,d,o,c,l=0;l<L.indexData.courses.length;l++)t=L.indexData.courses[l],"CLINIC"===(n=N[t]).cat&&n.name===e.name&&(n.fullname=e.fullname,n.dept=e.dept,n.rm={},n.rm.a=e.rm.a,c=o=d=i=s=r=void 0,s=N[a=t],i=""+s.assgn+a+"d"+s.dayhr[0][0]+"t"+s.dayhr[0][1],d=document.createDocumentFragment(),o=document.createElement("span"),c="",O(i).textContent=s.name+"("+s.dept+")",k(O("ref"+a)),c=s.name+" - "+s.dept+s.rm.a+" - "+s.times,r=document.createTextNode(c),o.id="sSgn"+a,o.className="sSgnd",d.appendChild(r),d.appendChild(o),O("ref"+a).appendChild(d),O("sSgn"+a).textContent=""+s.assgn)}function _t(e){window.mscAlert({title:"",subtitle:["Each nickname can contain only English or Korean characters.","Please complete each full name with an appropriate description.","Please select the department.","Please check that each nickname is unique","Please check that each definition is unique."][e]})}function Jt(){for(var e,t,n,a,r,s,i=O("klinic-section").childNodes,d=[],o=[],c=0;c<i.length;c++)1==(t=i[c]).nodeType&&((e={}).name=w(t.childNodes[0].value).replace(/\s/g,""),e.fullname=v(t.childNodes[1].value),e.dept=t.childNodes[2].value,e.rm={},e.rm.a=C(t.childNodes[3].value),d.push(e));if(d.length){for(n=[],a=[],c=d.length-1;0<=c;c--)if(""===d[c].name&&""===d[c].fullname)d.splice(c,1);else{if(""===d[c].name)return void _t(0);if(""===d[c].fullname)return void _t(1);if(""===d[c].dept)return void _t(2);n.push(d[c].name),a.push(""+d[c].fullname+d[c].dept+d[c].rm.a)}if(!0===kt(n,!1))return void _t(3);if(!0===kt(a,!0))return void _t(4)}for(1<d.length&&d.sort(function(e,t){return e.name.localeCompare(t.name)}),c=0;c<L.indexData.klinics.length;c++)-1===(r=d.map(function(e){return e.name}).indexOf(L.indexData.klinics[c].name))?o.push(L.indexData.klinics[c].name):qt(d[r]);if(o.length)for(c=o.length-1;0<=c;c--)for(s=L.indexData.courses.length-1;0<=s;s--)e=L.indexData.courses[s],"CLINIC"===N[e].cat&&N[e].name===o[c]&&ne(e);for(L.indexData.klinics=[],c=0;c<d.length;c++)L.indexData.klinics.push(d[c]);Nt()}function Mt(e,t){var n,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),o=document.createElement("span"),c=document.createElement("span"),l=document.createElement("span"),u=document.createElement("span"),p=N[e].name+" - "+N[e].dept+N[e].rm.a;N[e].rm.hasOwnProperty("b")&&(p+="/"+N[e].dept+N[e].rm.b),p+=" - "+N[e].times,"ninety"===N[e].duration&&(p+=" - (90분)"),n=document.createTextNode(p),r.id="contain"+e,r.className="row",s.className="col-lg-12",i.id="ref"+e,i.className="whitecircle",d.id="edredit-"+e,d.className="nodisplay",o.id="edrinit-"+e,o.className="btn-xs btn-warning pull-left nodisplay",o.textContent="Edit",c.id="edrsave-"+e,c.className="btn-xs btn-primary pull-left nodisplay",c.textContent="Save",l.id="sSgn"+e,l.className="sSgnd",u.id="edrdel-"+e,u.className="btn btn-xs btn-danger pull-right nodisplay",u.textContent="✖","CLINIC"===N[e].cat&&(d.className+=" disabled",o.className+=" disabled",c.className+=" disabled",u.className+=" disabled"),i.appendChild(n),i.appendChild(l),s.appendChild(o),s.appendChild(c),s.appendChild(i),s.appendChild(d),s.appendChild(u),r.appendChild(s),a.appendChild(r),O("courselist"+t).appendChild(a),Xn()}function jt(e){var t=["A course with that name already exists!","Please choose a "+S.courseNameNumLength+" digit course name greater than zero.","Both classes cannot start at the same time!","Please define all parameters with appropriate values"];window.mscAlert({title:"",subtitle:t[e]})}function Wt(e){var t,n,a,r,s,i,d,o,c=((n={}).name=O("edrname-"+(t=e)).value,n.dept=O("edrdept-"+t).value,n.rmA=O("edrrm-"+t).value,n.rmB=null!==O("edrrmB-"+t)?O("edrrmB-"+t).value:"",n.timeDay1=""+O("edrday1-"+t).value+O("edrstart1-"+t).value,n.timeDay2=""+O("edrday2-"+t).value+O("edrstart2-"+t).value,n.idxDay1=O("edrday1-"+t).selectedIndex,n.idxStart1=O("edrstart1-"+t).selectedIndex,n.idxDay2=O("edrday2-"+t).selectedIndex,n.idxStart2=O("edrstart2-"+t).selectedIndex,n),l=N[e],u="";"CLINIC"!==l.cat&&(c.name=H(c.name),a=p(c.name),c.rmA=v(c.rmA),c.rmB=v(c.rmB),void 0===a||a===e?c.name.length!==S.courseNameNumLength||Number(c.name)<1||Number.isNaN(Number(c.name))?jt(1):"twohour"!==(i=N[r=e]).duration&&"threehour"!==i.duration&&((s=[[],[]])[0].push(O("edrday1-"+r).selectedIndex),s[1].push(O("edrday2-"+r).selectedIndex),"ninety"===i.duration?(s[0].push(Math.floor(O("edrstart1-"+r).selectedIndex)/2),s[1].push(Math.floor(O("edrstart2-"+r).selectedIndex)/2)):(s[0].push(O("edrstart1-"+r).selectedIndex),s[1].push(O("edrstart2-"+r).selectedIndex)),s[0].identical(s[1]))?jt(2):""!==c.rmA&&""!==c.name?(""!==l.assgn&&le(u=""+l.assgn,e),Qn(e,!1),function(e,t){var n,a,r,s,i=N[e];if("CLINIC"===i.cat)return;for(s=0;s<L.catData.length;s++)if(L.catData[s][0]===i.cat){r=s;break}i.name=t.name,i.dept=t.dept,i.rm.a=t.rmA,i.rm.hasOwnProperty("b")&&delete i.rm.b;""!==t.rmB&&t.rmB!==i.rm.a&&(i.rm.b=t.rmB);n=t.timeDay1,"twohour"!==i.duration&&"threehour"!==i.duration&&(n+=","+t.timeDay2);"threehour"===i.duration&&(n+="-"+(t.idxStart1+11)+":50");"twohour"===i.duration&&(n+="-"+(t.idxStart1+10)+":50");i.times=n,(a=[[],[]])[0].push(i.dayhr[0][0]),a[0].push(i.dayhr[0][1]),a[1].push(i.dayhr[1][0]),a[1].push(i.dayhr[1][1]),--L.catData[r][2][a[0][0]][a[0][1]],--L.catData[r][2][a[1][0]][a[1][1]],"threehour"===i.duration&&--L.catData[r][2][a[0][0]][a[0][1]+1];i.dayhr[0][0]=t.idxDay1,"ninety"===i.duration?(i.dayhr[1][0]=t.idxDay2,t.idxStart1%2==1?(i.dayhr[0][1]=(t.idxStart1-1)/2,i.allowFollow[0]=!1):(i.dayhr[0][1]=t.idxStart1/2,i.allowFollow[0]=!0),t.idxStart2%2==1?(i.dayhr[1][1]=(t.idxStart2-1)/2,i.allowFollow[1]=!1):(i.dayhr[1][1]=t.idxStart2/2,i.allowFollow[1]=!0)):(i.dayhr[0][1]=t.idxStart1,"twohour"===i.duration||"threehour"===i.duration?(i.dayhr[1][0]=t.idxDay1,"twohour"===i.duration&&(i.dayhr[1][1]=t.idxStart1+1),"threehour"===i.duration&&(i.dayhr[1][1]=t.idxStart1+2)):(i.dayhr[1][0]=t.idxDay2,i.dayhr[1][1]=t.idxStart2));L.catData[r][2][i.dayhr[0][0]][i.dayhr[0][1]]+=1,L.catData[r][2][i.dayhr[1][0]][i.dayhr[1][1]]+=1,"threehour"===i.duration&&(L.catData[r][2][i.dayhr[0][0]][i.dayhr[0][1]+1]+=1);return!0}(e,c)&&(dn(e),d=u,"CLINIC"!==N[o=e].cat&&""!==d&&(z(d,o),J(d,o)||(Vn(d,o,"on"),Wn(d),ge(d))))):jt(3):jt(0))}function $t(){var e=document.createDocumentFragment(),t=document.createDocumentFragment(),n=document.createElement("option"),a=document.createElement("option");k(O("schedule-instances")),k(O("references")),k(O("newcoursecat")),k(O("newcoursedept")),n.textContent="select",n.value="",a.textContent="select",a.value="",e.appendChild(n),t.appendChild(a),O("newcoursecat").appendChild(e),O("newcoursedept").appendChild(t),O("newcoursecat").options[0].disabled=!0,O("newcoursedept").options[0].disabled=!0}function Vt(){for(var e,t={arr:[],lastEl:""},n=S.uiScheduleNumOfHrsPerDay-1,a=0;a<n;a++)e=("0"+(S.uiTimeInputStartHr+a)).slice(-2),t.arr.push(e+":00"),t.arr.push(e+":30");return t.lastEl+=S.uiTimeInputStartHr+(S.uiScheduleNumOfHrsPerDay-1)+":00",t}function zt(e){var t,n,a,r,s,i,d,o,c=Vt(),l=c.arr,u=l.length,p=document.createDocumentFragment(),h=document.createDocumentFragment();if(k(O("newhrsone")),k(O("newhrstwo")),"ninety"===e)for(o=0;o<u;o++)d=l[o],t=document.createElement("option"),n=document.createElement("option"),t.value=d,t.textContent=d,n.value=d,n.textContent=d,p.appendChild(t),h.appendChild(n);else{for(o=0;o<u;o+=2)d=l[o],a=document.createElement("option"),r=document.createElement("option"),a.value=d,a.textContent=d,r.value=d,r.textContent=d,p.appendChild(a),h.appendChild(r);"threehour"===e&&p.removeChild(p.lastChild),"onehour"===e&&(s=document.createElement("option"),i=document.createElement("option"),s.value=c.lastEl,s.textContent=c.lastEl,i.value=c.lastEl,i.textContent=c.lastEl,p.appendChild(s),h.appendChild(i))}O("newhrsone").appendChild(p),O("newhrstwo").appendChild(h)}function Ut(e){var t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span");k(O("catcontain"+e)),k(O("catref"+e)),k(O("courselist"+e)),n.id="catedt"+e,n.className="catedt btn-xs btn-warning pull-left nodisplay",n.textContent="Edit",n.style.display="none",a.id="bldr"+e,a.className="autobuilder pull-right icon-flash nodisplay",a.style.display="none",r.id="recycle"+e,r.className="pull-right recycler icon-recycle",r.style.display="none",t.appendChild(n),t.appendChild(a),t.appendChild(r),O("catref"+e).appendChild(t),O("list"+e).style.display="none",O("catcontain"+e).style.display="none",O("catref"+e).style.display="none",O("courselist"+e).style.display="none"}function Yt(e,t){var n,a,r=R(0),s=S.monToSatEn.slice(),i="p16c",d=document.createDocumentFragment(),o=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),u=document.createElement("div"),p=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div"),g=document.createElement("span"),v=document.createElement("span"),y=document.createElement("span"),x=document.createElement("span"),w=document.createElement("span"),b=document.createElement("select"),D=document.createElement("option");for("Sat"!==t&&(r.pop(),s.pop(),i="p20c"),o.id=""+e,o.className="col-lg-3 col-md-3 col-sm-3 col-xs-3 bordered",c.className="row text-center",c.style.paddingLeft="43px",c.textContent=I[e].display,g.id="del"+e,g.className="btn btn-xs btn-danger pull-right",g.textContent="✖",v.id="reset"+e,v.className="btn btn-xs icon-recycle pull-right",l.className="row text-center",u.id="tchrsee"+e,u.className="tchrsee nodisplay",y.id="tchrclr"+e,y.className="btn-xs btn-warning pull-left",y.textContent="Clear",x.id="tchrset"+e,x.className="btn-xs btn-whiteBlue tchrset",x.textContent="unassigned",p.id="tchrchg"+e,p.className="tchrchg nodisplay",w.id="tchrsve"+e,w.className="btn btn-xs btn-primary pull-left",w.textContent="Save",b.id="tchredt"+e,b.className="select-styles tchredt",D.value="",D.textContent="select teacher",h.id="catlist"+e,h.className="row text-center cat-list",m.className="row text-center dayofweek "+i,f.className="row text-center "+i,c.appendChild(g),c.appendChild(v),u.appendChild(y),u.appendChild(x),b.appendChild(D),p.appendChild(w),p.appendChild(b),l.appendChild(u),l.appendChild(p),n=0;n<s.length;n++){var C=document.createElement("div");C.textContent=s[n],m.appendChild(C)}for(o.appendChild(c),o.appendChild(l),o.appendChild(h),o.appendChild(m),n=0;n<r[0].length;n++){var N=document.createElement("div");for(N.className="row text-center "+i,a=0;a<r.length;a++){var k=document.createElement("div");k.id=e+"c0d"+[a]+"t"+[n],k.textContent="0",N.appendChild(k)}o.appendChild(N)}for(n=0;n<s.length;n++){var E=document.createElement("div");E.id="off"+[n]+e,E.className="dayoff",E.textContent="▲",f.appendChild(E)}o.appendChild(f),d.appendChild(o),O("schedule-instances").appendChild(d),O("tchredt"+e).options[0].disabled=!0,L.indexData.schedules.length&&O(L.indexData.schedules[0]).classList.contains("show-teacher")&&(cn("tchrsee"+e),ln(e),ot(e))}function Zt(e){var t=document.createDocumentFragment(),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),s=document.createElement("div"),i=document.createElement("span"),d=document.createElement("span"),o=document.createElement("span"),c=document.createElement("span"),l=document.createElement("span"),u=document.createElement("input"),p=L.catData[e-1][0],h=document.createTextNode(p);n.id="list"+e,n.className=$n(p,!0)+"courselist",a.id="catcontain"+e,a.className="nodisplay",r.id="catref"+e,s.id="courselist"+e,s.className="hide",i.id="catsve"+e,i.className="btn btn-xs btn-primary pull-left",i.textContent="Rename",u.type="text",u.id="catchg"+e,u.className="inputstyle btn-xs","CLINIC"===p&&(u.className+=" disabled",i.textContent="Delete only"),u.value=p,d.id="catdel"+e,d.className="btn btn-xs btn-danger pull-right",d.textContent="✖",o.id="catedt"+e,o.className="catedt btn-xs btn-warning pull-left nodisplay",o.textContent="Edit",c.id="bldr"+e,c.className="autobuilder pull-right icon-flash nodisplay",l.id="recycle"+e,l.className="pull-right recycler icon-recycle",a.appendChild(i),a.appendChild(u),a.appendChild(d),r.appendChild(o),r.appendChild(h),r.appendChild(c),r.appendChild(l),n.appendChild(a),n.appendChild(r),t.appendChild(n),t.appendChild(s),O("references").appendChild(t)}function Xt(){var e,t,n,a=document.createDocumentFragment(),r=document.createElement("option");for(k(O("newcoursecat")),r.value="",r.textContent="select",a.appendChild(r),n=0;n<L.catData.length;n++)"CLINIC"!==(t=L.catData[n][0])&&"$deleted"!==t.substring(0,8)&&((e=document.createElement("option")).value=""+t,e.textContent=t,a.appendChild(e));O("newcoursecat").appendChild(a),O("newcoursecat").options[0].disabled=!0,O("newcoursecat").options[0].selected=!0}function Qt(){var e,t,n=document.createDocumentFragment(),a=document.createElement("option");for(k(O("newcoursedept")),a.value="",a.textContent="select",n.appendChild(a),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("option")).value=""+L.indexData.depts[t].shortcode,e.textContent=e.value,n.appendChild(e);O("newcoursedept").appendChild(n),O("newcoursedept").options[0].disabled=!0,O("newcoursedept").options[0].selected=!0}function en(){var e,t,n=document.createDocumentFragment();for(k(O("alldepartments")),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("span")).id="opt"+[t+1],e.dataset.deptname=""+L.indexData.depts[t].shortcode,e.className="btn btn-xs btn-dept",e.textContent=L.indexData.depts[t].shortcode,n.appendChild(e);O("alldepartments").appendChild(n)}function tn(){var e,t,n=O("klinic-section").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("select"),o=document.createElement("input"),c=document.createElement("span"),l=document.createElement("option");for(c.id="kldel_"+n,c.className="btn btn-xs btn-danger deletex pull-right",c.textContent="✖",r.id="kl_"+n,s.id="klnm_"+n,s.type="text",s.className="btn-xs",s.style.width="90px",s.style.verticalAlign="middle",s.style.padding="2px",s.value="",s.maxLength=8,s.placeholder="nickname",i.id="klfn_"+n,i.type="text",i.className="inputStyle",i.style.width="160px",i.style.verticalAlign="middle",i.style.padding="2px",i.value="",i.maxLength=32,i.placeholder="full .pdf name",d.id="kldp_"+n,d.className="select-styles",d.style.marginRight="1px",o.id="klrm_"+n,o.type="text",o.className="inputStyle",o.style.width="80px",o.style.verticalAlign="middle",o.style.padding="2px",o.value="",o.maxLength=8,o.placeholder="room",l.value="",l.textContent="dept",d.appendChild(l),t=0;t<L.indexData.depts.length;t++)(e=document.createElement("option")).value=""+L.indexData.depts[t].shortcode,e.textContent=e.value,d.appendChild(e);r.appendChild(s),r.appendChild(i),r.appendChild(d),r.appendChild(o),r.appendChild(c),a.appendChild(r),O("klinic-section").appendChild(a),O("kldp_"+n).options[0].disabled=!0}function nn(){var e,t,n,a;if(k(O("klinicscontainer")),L.tempKlinic.kbtn="",L.indexData.klinics.length){for(e=document.createDocumentFragment(),function(){var e,t=L.catData.length;if(t)for(e=0;e<t;e++)if("CLINIC"===L.catData[e][0])return;L.catData.push(["CLINIC",0,R(0)]),Zt(t=L.catData.length),O("courselist"+t).setAttribute("class","show")}(),a=0;a<L.indexData.klinics.length;a++)t=document.createElement("span"),n=L.indexData.klinics[a].name,t.id="kbtn_"+n,t.className="btn btn-xs btn-whiteBlue",t.textContent=n,t.style.marginRight="5px",e.appendChild(t);O("klinicscontainer").appendChild(e),cn("klinicHolder"),cn("klinicscontainer")}else on("klinicHolder")}function an(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("allgroups")),a=0;a<L.settings.deptGrps.length;a++){for(e=document.createElement("div"),(t=document.createElement("span")).id="remove"+a,t.className="btn btn-xs btn-danger",t.textContent="delete",e.textContent="(",n=L.settings.deptGrps[a],r=0;r<n.length-1;r++)e.textContent+=n[r]+", ";e.textContent+=n[n.length-1]+") ",e.appendChild(t),s.appendChild(e)}O("allgroups").appendChild(s)}function rn(e,t){var n=O("deptEDIT").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("span");r.id="dpts"+n,s.type="text",s.id="deptnm"+n,s.className="inputstylenarrow",s.value=e,s.maxLength=8,s.placeholder="shortcode",i.type="text",i.id="ddesc"+n,i.className="inputstyle",i.value=t,i.maxLength=32,i.placeholder="description",d.id="deptdel"+n,d.className="btn btn-xs btn-danger deletex",d.textContent="✖",r.appendChild(s),r.appendChild(i),r.appendChild(d),a.appendChild(r),O("deptEDIT").appendChild(a)}function sn(e,t){var n=O("alltchrs").childNodes.length,a=document.createDocumentFragment(),r=document.createElement("div"),s=document.createElement("input"),i=document.createElement("input"),d=document.createElement("span");r.id="prsn"+n,s.type="text",s.id="prsnnm"+n,s.className="inputstyle",s.value=e,s.maxLength=32,s.placeholder="new teacher",i.type="text",i.id="prsnKR"+n,i.className="inputstyle",i.value=t,i.maxLength=32,i.placeholder="csv name",d.id="prsndel"+n,d.className="btn btn-xs btn-danger deletex",d.textContent="✖",r.appendChild(s),r.appendChild(i),r.appendChild(d),a.appendChild(r),O("alltchrs").appendChild(a)}function dn(e){var t,n=N[e],a=document.createDocumentFragment(),r=document.createElement("span"),s=n.name+" - "+n.dept+n.rm.a,i="ref"+e;n.rm.hasOwnProperty("b")&&(s+="/"+n.dept+n.rm.b),s+=" - "+n.times,k(O(i)),"ninety"===n.duration&&(s+=" - (90분)"),r.id="sSgn"+e,r.className="sSgnd",t=document.createTextNode(s),a.appendChild(t),a.appendChild(r),O(i).appendChild(a)}function on(e){O(e).classList.contains("nodisplay")||(O(e).className+=" nodisplay")}function cn(e){O(e).className=O(e).className.replace(/(?:^|\s)nodisplay(?!\S)/g,"")}function ln(e){O(e).classList.contains("show-teacher")||(O(e).className+=" show-teacher")}function un(e){var t=O("courselist"+e.substring(6));"hide"!==t.getAttribute("class")?t.setAttribute("class","hide"):t.setAttribute("class","show")}function pn(e){var t=O(e),n=t.classList.contains("btn-warning");!0===t.classList.contains("btn-primary")?da(!1,e):!0===n&&da(!0,e)}function hn(){pn("updateHdrsA")}function mn(){pn("updateHdrsB")}function fn(){var e,t;O("deptEDIT").removeEventListener("click",aa,{capture:!1,passive:!0}),O("deptEDIT-file").removeEventListener("change",We,{capture:!1,passive:!0}),O("deptopenR").removeEventListener("click",ya,{capture:!1,passive:!0}),O("save-deptEDIT").removeEventListener("click",xt,{capture:!1,passive:!0}),O("deptEDITadd").removeEventListener("click",vt,{capture:!1,passive:!0}),O("exit-deptEDIT").removeEventListener("click",xa,{capture:!1,passive:!0}),O("jsonSettings-file").removeEventListener("change",Ve,{capture:!1,passive:!0}),O("alldepartments").removeEventListener("click",sa,{capture:!1,passive:!0}),O("newgroupid").removeEventListener("click",ra,{capture:!1,passive:!0}),O("allgroups").removeEventListener("click",Dt,{capture:!1,passive:!0}),O("seqHrsTwo").removeEventListener("click",r,{capture:!1,passive:!0}),O("seqHrsThree").removeEventListener("click",i,{capture:!1,passive:!0}),O("hrsPerSchedule").removeEventListener("input",oa,{capture:!1,passive:!0}),O("hrsPerDay").removeEventListener("input",ca,{capture:!1,passive:!0}),O("save-settings").removeEventListener("click",fn,{capture:!1,passive:!0}),e=Number(O("hrsPerSchedule").value),t=Number(O("hrsPerDay").value),1<=e&&e<=5*S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHours=e),1<=t&&t<=S.uiScheduleNumOfHrsPerDay&&(L.settings.maxHrsPerDay=t),we(),ta(),on("setting-section"),cn("displayOverrides"),cn("left"),cn("right")}function gn(){cn("information"),on("parsing")}function vn(){on("information"),cn("parsing")}function yn(){cn("information"),on("displayOverrides"),on("left"),on("right")}function xn(){on("information"),cn("displayOverrides"),cn("left"),cn("right")}function wn(){O("exit-stats").removeEventListener("click",wn,{capture:!1,passive:!0}),on("statistics"),cn("displayOverrides"),cn("left"),cn("right")}function bn(){on("displayOverrides"),O("left").style.visibility="hidden",O("right").style.visibility="hidden",O("deptEDIT").addEventListener("click",aa,{capture:!1,passive:!0}),O("deptEDIT-file").addEventListener("change",We,{capture:!1,passive:!0}),O("csv-freshfile").addEventListener("change",Me,{capture:!1,passive:!0}),O("deptopenL").addEventListener("click",ya,{capture:!1,passive:!0}),O("save-deptEDIT").addEventListener("click",xt,{capture:!1,passive:!0}),O("deptEDITadd").addEventListener("click",vt,{capture:!1,passive:!0}),O("exit-deptEDIT").addEventListener("click",xa,{capture:!1,passive:!0}),O("newcourseform").addEventListener("click",qn,{capture:!1,passive:!0}),O("newcoursename").addEventListener("input",la,{capture:!1,passive:!0}),O("newcourseroom").addEventListener("input",ua,{capture:!1,passive:!0}),O("durationone").addEventListener("click",Nn,{capture:!1,passive:!0}),O("durationninety").addEventListener("click",kn,{capture:!1,passive:!0}),O("durationtwo").addEventListener("click",En,{capture:!1,passive:!0}),O("durationthree").addEventListener("click",Sn,{capture:!1,passive:!0}),cn("newcoursemodal")}function Dn(e,t){if(!0===L.settings.overrides[e])return L.settings.overrides[e]=!1,void(O(t).className=E(O(t).className,"bypass"));L.settings.overrides[e]=!0,O(t).className+=" bypass"}function Cn(e){O("select-styleF").style.visibility=e,O("select-styleG").style.visibility=e,O("newcourseroomB").style.visibility=e}function Nn(){zt("onehour"),Cn("visible")}function kn(){zt("ninety"),Cn("visible")}function En(){zt("twohour"),Cn("hidden")}function Sn(){zt("threehour"),Cn("hidden")}function Ln(){cn("chooseexistingcats"),on("choosenewcat")}function In(e){cn("catref"+e),on("catcontain"+e)}function On(e){var t=e.split(/[scdt]/).map(Number);return t.shift(),t}function Pn(e,t){var n,a,r,s=t.substring(3);if(""!==(a=N[""+t.substring(3)].assgn)&&(O(a).scrollIntoView({behavior:"smooth",block:"center"}),O(a).className+=" highlight",n=window.setTimeout(function(){O(a).className=E(O(a).className,"highlight"),window.clearTimeout(n)},3e3)),_n(e)){if("CLINIC"===N[s].cat)return void ne(s);if(!Jn(e))return void(""!==N[r=s].assgn&&le(N[r].assgn,r));L.tempCparam=""+s,O(t).style.backgroundColor="#2c3e50",O(t).style.color="#ffffff"}}function Hn(e){var t,n=e.substring(0,8),a=e.substring(8);if("edrinit-"!==n){if("edrsave-"!==n)return"edrdel-"===e.substring(0,7)&&(t=e.substring(7),void window.mscConfirm({title:"Delete course?",subtitle:"Are you sure you want to delete this course?\nThis action cannot be undone!",onOk:function(){ne(t)},onCancel:function(){}}));Wt(a)}else!function(e){var t,n,a,r,s,i,d,o,c,l,u,p,h,m,f,g,v,y,x,w,b,D,C;if("CLINIC"!==N[e].cat){for(n=(t=Vt()).arr,a=S.monToSatKr.slice(),r=document.createDocumentFragment(),s=document.createElement("input"),i=document.createElement("input"),o=document.createElement("select"),c=document.createElement("select"),l=document.createElement("select"),u=document.createElement("select"),p=document.createElement("select"),h=document.createElement("span"),k(O("edredit-"+e)),s.id="edrname-"+e,s.type="number",s.className="btn-xs",s.style.width="60px",s.style.verticalAlign="middle",s.style.padding="2px",s.value=N[e].name,s.maxLength=S.courseNameNumLength,s.minLength=S.courseNameNumLength,s.min=Math.pow(10,S.courseNameNumLength-1).toString().split("").reverse().join(""),s.max=""+(Math.pow(10,S.courseNameNumLength)-1),o.id="edrdept-"+e,o.className="select-styles",o.style.marginRight="1px",i.id="edrrm-"+e,i.type="text",i.className="inputStyle",i.style.width="80px",i.style.verticalAlign="middle",i.style.padding="2px",i.value=N[e].rm.a,"onehour"!==N[e].duration&&"ninety"!==N[e].duration||((d=document.createElement("input")).id="edrrmB-"+e,d.type="text",d.className="inputStyle",d.style.width="80px",d.style.verticalAlign="middle",d.style.padding="2px",d.value=N[e].rm.b||N[e].rm.a),c.id="edrday1-"+e,c.className="select-styles",l.id="edrday2-"+e,l.className="select-styles",u.id="edrstart1-"+e,u.className="select-styles",p.id="edrstart2-"+e,p.className="select-styles",h.id="edrduration-"+e,"ninety"===N[e].duration&&(h.textContent=" 90분(2)"),"twohour"===N[e].duration&&(h.textContent=" 2시간(1)"),"threehour"===N[e].duration&&(h.textContent=" 3시간(1)"),"onehour"===N[e].duration&&(h.textContent=" 1시간(2)"),C=0;C<L.indexData.depts.length;C++)(m=document.createElement("option")).value=L.indexData.depts[C].shortcode,m.textContent=m.value,o.appendChild(m);for(C=0;C<a.length;C++)f=document.createElement("option"),g=document.createElement("option"),f.value=a[C],f.textContent=f.value,g.value=f.value,g.textContent=f.value,c.appendChild(f),l.appendChild(g);if("ninety"===N[e].duration)for(C=0;C<n.length;C++)v=document.createElement("option"),y=document.createElement("option"),v.value=n[C],v.textContent=v.value,y.value=v.value,y.textContent=y.value,u.appendChild(v),p.appendChild(y);else{for(C=0;C<n.length;C+=2)x=document.createElement("option"),w=document.createElement("option"),x.value=n[C],x.textContent=x.value,w.value=x.value,w.textContent=x.value,u.appendChild(x),p.appendChild(w);"threehour"===N[e].duration&&u.removeChild(u.lastChild),"onehour"===N[e].duration&&(b=document.createElement("option"),D=document.createElement("option"),b.value=t.lastEl,b.textContent=t.lastEl,D.value=t.lastEl,D.textContent=t.lastEl,u.appendChild(b),p.appendChild(D))}r.appendChild(s),r.appendChild(o),r.appendChild(i),"onehour"!==N[e].duration&&"ninety"!==N[e].duration||r.appendChild(d),r.appendChild(c),r.appendChild(u),r.appendChild(l),r.appendChild(p),r.appendChild(h),O("edredit-"+e).appendChild(r),ve(e)}}(a)}function Tn(e){var t,n=e.substring(0,6),a=e.substring(6);switch(n){case"catedt":on("catref"+(t=a)),cn("catcontain"+t);break;case"catsve":!function(e){var t,n,a,r,s,i,d,o=Number(e)-1,c=P(g(O("catchg"+e).value)),l=L.indexData.courses.length;if(""!==c){if(null!=L.catData[o]&&!Number.isNaN(Number(o)))if(L.catData[o][0]!==c){for(d=0;d<L.catData.length;d++)if(L.catData[d][0]===c&&o!==d)return"clinic"===c.toLowerCase()?re(1):window.mscConfirm({title:"Merge!",subtitle:'This action will move courses from: "'+L.catData[o][0]+'" and place them under: "'+L.catData[d][0]+'".\nThe category "'+L.catData[o][0]+'" will be deleted.\nThis action cannot be undone. Proceed?',onOk:function(){ae(L.catData[d][0],L.catData[o][0])},onCancel:function(){}});for(d=0;d<l;d++)(i=N[L.indexData.courses[d]]).cat===L.catData[o][0]&&(i.cat=""+c);L.catData[o][0]=""+c,k(O("catref"+e)),t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("span"),r=document.createElement("span"),s=document.createTextNode(L.catData[o][0]),n.id="catedt"+e,n.className="catedt btn-xs btn-warning pull-left nodisplay",n.textContent="Edit",a.id="bldr"+e,a.className="autobuilder pull-right icon-flash nodisplay",r.id="recycle"+e,r.className="pull-right recycler icon-recycle",t.appendChild(n),t.appendChild(s),t.appendChild(a),t.appendChild(r),O("catref"+e).appendChild(t),6<Number(L.catData[o][1])&&cn("bldr"+e),O("catchg"+e).value=c,In(e),se(c)}else In(e)}else re(0)}(a);break;case"catdel":ie(a);break;case"catref":un(e);break;default:return}}function An(e){var t;if(""!==L.tempCparam&&(O("ref"+L.tempCparam).style.backgroundColor="",O("ref"+L.tempCparam).style.color=""),St("off"),""!==L.tempKlinic.kbtn&&(Rn(null,"off"),L.tempKlinic.kbtn=""),e.target!==e.currentTarget)switch((t=e.target.id).substring(0,3)){case"rec":!function(e){var t,n,a=Number(e.substring(7))-1,r=L.catData[a][0];if(!0===Re(r)){for(t=[],O("courselist"+e.substring(7)).setAttribute("class","hide"),n=L.indexData.courses.length-1;0<=n;n--)N[L.indexData.courses[n]].cat===r&&""!==N[L.indexData.courses[n]].assgn&&(t.push(N[L.indexData.courses[n]].assgn),"CLINIC"===r?ne(L.indexData.courses[n]):le(N[L.indexData.courses[n]].assgn,L.indexData.courses[n]));if(t.length)for(t=y(t),n=0;n<t.length;n++)0===I[t[n]].cRef.length&&fe("reset"+t[n])}}(t);break;case"bld":Be(t);break;case"ref":Pn(e,t);break;case"cat":Tn(t);break;case"edr":Hn(t);break;default:return}e.stopPropagation()}function Rn(e,t){var n,a,r=O("klinicscontainer");if(r.hasChildNodes())for(n=r.childNodes,a=0;a<n.length;a++)n[a].className=E(n[a].className,"active");"on"===t&&(O("kbtn_"+e).className+=" active")}function Fn(e,t){var n,a,r,s,i,d=On(t);if(4===d.length)if(n="c0",0!==d[1]&&(n="c"+d[1]),0===d[1]){if(""!==L.tempKlinic.kbtn)return a=""+L.tempKlinic.kbtn,Lt(e.target.id,a),void(!1===L.tempKlinic.isHeld&&(L.tempKlinic.kbtn=""));_n(e)&&Jn(e)&&""!==L.tempCparam?"CLINIC"!==N[L.tempCparam].cat&&(ue(d[0],L.tempCparam),L.tempCparam=""):Mn(e.target.id,d)}else"CLINIC"!==N[n].cat?_n(e)?(i="s"+(r=d)[0],0!==r[1]&&(s="c"+r[1],-1!==I[i].cRef.indexOf(s)&&le(i,s))):Mn(e.target.id,d):(Rn(null,"off"),L.tempKlinic.kbtn="",ne(n))}function Gn(e){var t,n,a,r,s,i,d;""!==L.tempCparam&&(O("ref"+L.tempCparam).style.backgroundColor="",O("ref"+L.tempCparam).style.color=""),""!==L.tempKlinic.kbtn&&!1===L.tempKlinic.isHeld&&Rn(null,"off"),""===L.tempKlinic.kbtn&&!1!==L.tempKlinic.isHeld&&(St("off"),Rn(null,"off")),e.target!==e.currentTarget&&("s"===(t=e.target.id).substring(0,1)?Fn(e,t):"del"===(n=t.substring(0,3))?(d=t.substring(3),window.mscConfirm({title:"Delete schedule?",subtitle:"Are you sure you want to delete this schedule?\nThis action cannot be undone!",onOk:function(){he(d)},onCancel:function(){}})):"off"===n?_n(e)?(s=(r=t).substring(4),(i=Number(r.substring(3,4)))===I[s].dayOff&&(O("off"+i+s).style.color="",I[s].dayOff=6)):oe(t):"tchr"===(a=t.substring(0,4))?function(e){var t=e.substring(4,7),n=e.substring(7);switch(t){case"set":it(n);break;case"clr":dt(n);break;case"sve":!function(e){var t,n,a;if(L.teachers.length){var r=O("tchredt"+e).options[O("tchredt"+e).selectedIndex].value;if(""!==r){for(n=L.indexData.schedules.length,a=0;a<n;a++)if(t=L.indexData.schedules[a],I[t].hasOwnProperty("tchr")){if(t===e)continue;if(I[t].tchr===r)return window.mscAlert({title:"",subtitle:r+" has already been assigned to schedule "+t}),dt(e),on("tchrchg"+e),cn("tchrsee"+e)}O("tchrset"+e).textContent=r}else O("tchrset"+e).textContent="unassigned";I[e].tchr=r}on("tchrchg"+e),ot(e),cn("tchrsee"+e)}(n);break;default:;}}(t):"rese"===a&&fe(t),e.stopPropagation())}function Bn(e){if(e.target!==e.currentTarget){var t=e.target.id;if("kbtn_"===t.substring(0,5))!function(e,t){if(_n(e))return L.tempKlinic.kbtn="",Rn(null,"off");L.tempKlinic.kbtn=t.substring(5),Rn(L.tempKlinic.kbtn,"on")}(e,t);else switch(t){case"addnewcourse":bn();break;case"renamer":!function(){var e,t,n=L.indexData.courses.length;for(on("renamer"),t=0;t<n;t++)e=L.indexData.courses[t],"CLINIC"!==N[e].cat&&(O("edredit-"+e).hasChildNodes&&k(O("edredit-"+e)),O("edrinit-"+e).style.display="none",O("edrsave-"+e).style.display="none",O("edrdel-"+e).style.display="none",O("ref"+e).style.display="none",O("edredit-"+e).style.display="inline-block",function(e){var t=document.createDocumentFragment(),n=document.createElement("span"),a=document.createElement("input"),r=document.createTextNode(" -> ");n.textContent=N[e].name,n.style.paddingLeft="60px",a.id="newName-"+e,a.type="number",a.className="btn-xs",a.style.width="60px",a.style.verticalAlign="middle",a.style.padding="2px",a.value="",a.maxLength=S.courseNameNumLength,a.minLength=S.courseNameNumLength,a.min=Math.pow(10,S.courseNameNumLength-1).toString().split("").reverse().join(""),a.max=""+(Math.pow(10,S.courseNameNumLength)-1),t.appendChild(n),t.appendChild(r),t.appendChild(a),O("edredit-"+e).appendChild(t)}(e));for(t=0;t<L.catData.length;t++)un("catref"+[t+1]),on("catedt"+[t+1]);cn("newCNames"),on("purger"),on("addnewcourse"),on("openklinics")}();break;case"purger":de();break;case"openklinics":Ct();break;case"coursefinder":pa();break;case"savenewCNames":Ce();break;case"exitnewCNames":ia();break;default:return}}e.stopPropagation()}function Kn(e){if(e.target!==e.currentTarget){var t=e.target.id;switch(t){case"deptgrpsbyps":Dn("deptGrps","deptgrpsbyps");break;case"dayhrsbyps":case"dayhrsset":Dn("maxHrsPerDay","dayhrsbyps");break;case"downloadjson":!function(){var e,t="Schedules_"+T((new Date).toDateString()),n=0,a=JSON.parse(JSON.stringify(L)),r=JSON.parse(JSON.stringify(I)),s=[];if(a.catData.length)for(e=a.catData.length-1;0<=e;e--)"$deleted"===a.catData[e][0].substring(0,8)&&a.catData.splice(e,1);for(a.indexData.schedules.length>a.indexData.courses.length/(a.settings.maxHours/2)&&(n=a.indexData.schedules.length-Math.round(a.indexData.courses.length/(a.settings.maxHours/2))),e=a.indexData.schedules.length-1;0<=e;e--)if(!r[a.indexData.schedules[e]].cRef.length&&6===r[a.indexData.schedules[e]].dayOff){if(--n<=0)break;delete r[a.indexData.schedules[e]],a.indexData.schedules.splice(e,1)}s.push(a),s.push(N),s.push(r),s.push(l),Tt(t,"json",JSON.stringify(s))}();break;case"downloadcsv":!function(){for(var e,t,n={fields:[l.courseCat,l.courseNum,l.courseTchr,"대상학과",l.courseTime,l.courseRm],data:[]},a=["월","화","수","목","금","토"],r=L.indexData.courses.length,s={},i=[],d=0;d<r;d++)t=N[L.indexData.courses[d]],s.tmeStr="",s.rmStr="",s.numStr="00",i=[t.cat,t.name,"","","",""],s.krDay0=a[t.dayhr[0][0]],s.krDay1=a[t.dayhr[1][0]],s.dyhr01=t.dayhr[0][1],s.dyhr11=t.dayhr[1][1],s.sRef=I[t.assgn],""!==t.assgn&&s.sRef.hasOwnProperty("tchr")&&(-1!==(e=L.teachers.map(function(e){return e.en}).indexOf(s.sRef.tchr))&&""!==L.teachers[e].kor?i[2]=L.teachers[e].kor:i[2]=s.sRef.tchr),"onehour"===t.duration&&(s.numStr=Rt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼"+s.numStr+":50) ",s.numStr=Rt(s.dyhr11,0),s.tmeStr+=s.krDay1+"("+s.numStr+":00∼"+s.numStr+":50)"),"twohour"!==t.duration&&"threehour"!==t.duration||(s.numStr=Rt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼","twohour"===t.duration&&(s.numStr=Rt(s.dyhr01,1)),"threehour"===t.duration&&(s.numStr=Rt(s.dyhr01,2)),s.tmeStr+=s.numStr+":50)"),"ninety"===t.duration&&(s.numStr=Rt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr,s.numStr=Rt(s.dyhr01,1),!0===t.allowFollow[0]&&(s.tmeStr+=":00∼"+s.numStr+":15) "),!1===t.allowFollow[0]&&(s.tmeStr+=":30∼"+s.numStr+":45) "),s.numStr=Rt(s.dyhr11,0),s.tmeStr+=s.krDay1+"("+s.numStr,s.numStr=Rt(s.dyhr11,1),!0===t.allowFollow[1]&&(s.tmeStr+=":00∼"+s.numStr+":15)"),!1===t.allowFollow[1]&&(s.tmeStr+=":30∼"+s.numStr+":45)")),"klinichour"===t.duration&&(s.numStr=Rt(s.dyhr01,0),s.tmeStr+=s.krDay0+"("+s.numStr+":00∼"+s.numStr+":50)"),i[4]=s.tmeStr,s.rmStr=t.dept+t.rm.a,t.rm.hasOwnProperty("b")&&t.rm.a!==t.rm.b&&(s.rmStr+=" "+t.dept+t.rm.b),i[5]=s.rmStr,n.data.push(i);Tt("AllCourseData_","csv",n)}();break;case"downloadpdf":case"dlklinicpdf":_e(t);break;case"newmontofri":me("MtoF"),O("pagebottom").scrollIntoView({behavior:"smooth"});break;case"newmontosat":me("Sat"),O("pagebottom").scrollIntoView({behavior:"smooth"});break;case"schedhrsbyps":case"schedhrsset":Dn("maxHours","schedhrsbyps");break;case"seqhrsbyps":case"seqhrsset":Dn("maxSeqHrs","seqhrsbyps");break;case"open-settings":be();break;case"updatenames":pt();break;default:return}}e.stopPropagation()}function qn(e){if(e.target!==e.currentTarget)switch(e.target.id){case"newcoursecatmake":on("chooseexistingcats"),cn("choosenewcat");break;case"savenewcat":Q(!0,O("definenewcat").value);break;case"savecoursechanges":!function(){var e,t,n,a=L.catData.length;if(a){if("nada"!==(t=Bt())){for(O("newcoursename").value="",O("newcourseroom").value="",O("newcourseroomB").value="",O("newcoursecat").selectedIndex=0,O("newcoursedept").selectedIndex=0,O("newdayone").selectedIndex=0,O("newhrsone").selectedIndex=0,O("newdaytwo").selectedIndex=0,n=O("newhrstwo").selectedIndex=0;n<a;n++)if(L.catData[n][0]===N[t].cat){e=n+1;break}Mt(t,e),window.mscConfirm({title:"Success!",subtitle:"Course: "+N[t].name+" has been created.\nCreate another?",cancelText:"Exit",onOk:function(){},onCancel:function(){na(),Un(t)}})}}else window.mscAlert({title:"",subtitle:"At least one category must be defined before a course can be created."})}();break;case"exitchoosenewcat":Ln();break;case"exitcoursechanges":na();break;default:return}e.stopPropagation()}function _n(e){return!!e.shiftKey}function Jn(e){return!!e.altKey}function Mn(e,t){var n,a,r,s,i="s"+t[0],d=[t[2],t[3]];0===t[1]&&("nada"!==(n=function(e,t){var n,a,r,s;for(jn(),n="nada",a=L.indexData.courses.length,s=0;s<a;s++)if(K(r=L.indexData.courses[s])&&!0===ce(r,t)&&!0===Y(e,r)&&(z(e,r),!J(e,r)))return n=r;return n}(i,d))?(Vn(i,n,"on"),Wn(i)):(O(e).textContent="X",a=window.setTimeout(function(){O(e).textContent="0",window.clearTimeout(a)},800))),0!==t[1]&&("nada"!==(s=function(e,t,n){var a,r;for(jn(),a="nada",r=L.indexData.courses.indexOf(n);r<L.indexData.courses.length;r++)if(L.indexData.courses[r]!==n&&K(L.indexData.courses[r])&&!0===ce(L.indexData.courses[r],t)&&!0===Y(e,L.indexData.courses[r])){if(le(e,n),z(e,L.indexData.courses[r]),J(e,L.indexData.courses[r])){z(e,n),Vn(e,n,"on");continue}return a=L.indexData.courses[r]}return a}(i,d,r="c"+t[1]))?(Vn(i,s,"on"),Wn(i)):le(i,r)),ge(i)}function jn(){L.indexData.klinics.length||(St("off"),Rn(null,"off"),L.tempKlinic.kbtn="")}function Wn(e){O("catlist"+e).textContent=pe(e)}function $n(e,t){for(var n=S.alphabet,a="",r=!0===t?e:N[e].cat,s=L.catData.length,i=0;i<s;i++)if(L.catData[i][0]===r){if(i>=n.length){a=n[i-n.length];break}a=n[i];break}return a}function Vn(e,t,n){var a,r,s,i,d,o,c=N[t];"off"===n?(a=""+e+t+"d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],r=""+e+t+"d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],d=e+"c0d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],o=e+"c0d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],"threehour"===c.duration&&(s=""+e+t+"d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1),i=e+"c0d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1)),O(a).setAttribute("id",d),O(d).className="",O(d).textContent="0","klinichour"!==c.duration&&(O(r).setAttribute("id",o),O(o).className="",O(o).textContent="0"),"threehour"===c.duration&&(O(s).setAttribute("id",i),O(i).className="",O(i).textContent="0")):(a=e+"c0d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],r=e+"c0d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],d=""+e+t+"d"+c.dayhr[0][0]+"t"+c.dayhr[0][1],o=""+e+t+"d"+c.dayhr[1][0]+"t"+c.dayhr[1][1],"threehour"===c.duration&&(s=e+"c0d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1),i=""+e+t+"d"+c.dayhr[0][0]+"t"+(c.dayhr[0][1]+1)),O(a).setAttribute("id",d),O(d).className="selected"+$n(t,!1),O(d).textContent=c.name+"("+c.dept+")","klinichour"!==c.duration&&(O(r).setAttribute("id",o),O(o).className="selected"+$n(t,!1),O(o).textContent=c.name+"("+c.dept+")"),"threehour"===c.duration&&(O(s).setAttribute("id",i),O(i).className="selected"+$n(t,!1),O(i).textContent=c.name+"("+c.dept+")")),"init"!==n&&Un(t),Yn(t)}function zn(e){var t;e.target!==e.currentTarget&&"prsndel"==e.target.id.substring(0,7)&&(O("prsnnm"+(t=e.target.id.substring(7))).value="",O("prsn"+t).style.display="none"),e.stopPropagation()}function Un(e){"c0"!==e&&O("contain"+e).scrollIntoView({behavior:"smooth",block:"center"})}function Yn(e){var t,n=O("ref"+e),a=O("sSgn"+e);if(""===N[e].assgn)return n.setAttribute("class","whitecircle"),void(a.textContent="");t="activecircle"+$n(e,!1),n.setAttribute("class",t),a.textContent=" "+N[e].assgn}function Zn(){for(var e,t,n=[],a=L.catData.length,r=L.indexData.courses.length,s=0;s<a;s++)t=L.catData[s][0],Zt(s+1),n.push(t),"$deleted"===t.substring(0,8)&&Ut(s+1);for(s=0;s<r;s++)Mt(e=L.indexData.courses[s],n.indexOf(N[e].cat)+1);Xn()}function Xn(){for(var e=0;e<L.catData.length;e++)"CLINIC"!==L.catData[e][0]&&Number(L.catData[e][1])>Number(L.settings.maxHours)/2&&cn("bldr"+[e+1])}function Qn(e,t){var n="none",a="inline-block",r=N[e];"CLINIC"!==r.cat&&(t||(a="none",n="inline-block"),O("ref"+e).style.display=n,O("edrinit-"+e).style.display=n,"twohour"!==r.duration&&"threehour"!==r.duration||(O("edrday2-"+e).style.display="none",O("edrstart2-"+e).style.display="none"),O("edrsave-"+e).style.display=a,O("edredit-"+e).style.display=a,O("edrdel-"+e).style.display=a)}function ea(){var e;if(O("deptgroupsset").textContent="",!L.settings.deptGrps.length)return on("deptgrpcontrol"),void cn("nodeptgrps");for(e=0;e<L.settings.deptGrps.length-1;e++)O("deptgroupsset").textContent+=" "+L.settings.deptGrps[e]+" -";O("deptgroupsset").textContent+=" "+L.settings.deptGrps[L.settings.deptGrps.length-1],cn("deptgrpcontrol"),on("nodeptgrps")}function ta(){O("schedhrsset").textContent=L.settings.maxHours,O("dayhrsset").textContent=L.settings.maxHrsPerDay,2===L.settings.maxSeqHrs?O("seqhrsset").textContent="2-2-3(3)":O("seqhrsset").textContent="3-4-3(6)",fa(L.settings.overrides.deptGrps,"deptgrpsbyps"),ea(),cn("displayOverrides")}function na(){on("newcoursemodal"),O("deptEDIT").removeEventListener("click",aa,{capture:!1,passive:!0}),O("deptEDIT-file").removeEventListener("change",We,{capture:!1,passive:!0}),O("csv-freshfile").removeEventListener("change",Me,{capture:!1,passive:!0}),O("deptopenL").removeEventListener("click",ya,{capture:!1,passive:!0}),O("save-deptEDIT").removeEventListener("click",xt,{capture:!1,passive:!0}),O("deptEDITadd").removeEventListener("click",vt,{capture:!1,passive:!0}),O("exit-deptEDIT").removeEventListener("click",xa,{capture:!1,passive:!0}),O("newcourseform").removeEventListener("click",qn,{capture:!1,passive:!0}),O("newcoursename").removeEventListener("input",la,{capture:!1,passive:!0}),O("newcourseroom").removeEventListener("input",ua,{capture:!1,passive:!0}),O("durationone").removeEventListener("click",Nn,{capture:!1,passive:!0}),O("durationninety").removeEventListener("click",kn,{capture:!1,passive:!0}),O("durationtwo").removeEventListener("click",En,{capture:!1,passive:!0}),O("durationthree").removeEventListener("click",Sn,{capture:!1,passive:!0}),Ae(),O("left").style.visibility="visible",O("right").style.visibility="visible",cn("displayOverrides")}function aa(e){var t,n,a,r;e.target!==e.currentTarget&&"deptdel"==e.target.id.substring(0,7)&&(t=e.target.id.substring(7),!0===(a=!0,""!==(r=x(O(n="deptnm"+t).value))&&!0===gt(r)&&!0!==yt(r)&&(a=!1,window.mscAlert({title:"",subtitle:"The department: "+r+" is currently assigned to one or more courses and cannot be deleted."})),a)&&(O(n).value="",O("dpts"+t).style.display="none")),e.stopPropagation()}function ra(e){e.target!==e.currentTarget&&"makegroup"===e.target.id&&function(){var e,t,n,a,r=Number(O("newgroupid").dataset.grpindex),s=L.settings.deptGrps[r],i=O("alldepartments").childNodes;if(s&&s.length){for(e=document.createDocumentFragment(),t=document.createElement("div"),(n=document.createElement("span")).id="remove"+r,n.className="btn btn-xs btn-danger",n.textContent="delete",t.textContent="(",a=0;a<s.length-1;a++)t.textContent+=s[a]+", ";t.textContent+=s[s.length-1]+") ",t.appendChild(n),e.appendChild(t),O("allgroups").appendChild(e),O("newgroupid").dataset.grpindex=L.settings.deptGrps.length}for(a=0;a<i.length;a++)1==i[a].nodeType&&(i[a].style.backgroundColor="",i[a].style.color="",i[a].style.borderColor="")}(),e.stopPropagation()}function sa(e){e.target!==e.currentTarget&&"opt"==e.target.id.substring(0,3)&&(e.shiftKey?bt(e.target.id,!1):bt(e.target.id,!0)),e.stopPropagation()}function ia(){var e,t,n=L.indexData.courses.length;for(on("newCNames"),t=0;t<n;t++)O("edredit-"+(e=L.indexData.courses[t])).style.display="none",O("edredit-"+e).hasChildNodes&&k(O("edredit-"+e)),O("ref"+e).style.display="inline-block","CLINIC"!==N[e].cat&&(O("edrinit-"+e).style.display="inline-block");for(t=0;t<L.catData.length;t++)un("catref"+[t+1]),cn("catedt"+[t+1]);cn("renamer"),cn("purger"),cn("addnewcourse"),cn("openklinics")}function da(e,t){for(var n,a,r,s=[],s="updateHdrsA"===t?["strHdr1","strHdr2","strHdr3","strHdr4"]:["strHdr5","strHdr6"],i=0;i<s.length;i++)n=s[i],r=a=void 0,a=P(g(O(n).value)),void 0!==(r={strHdr1:"courseCat",strHdr2:"courseRm",strHdr3:"courseTime",strHdr4:"courseNum",strHdr5:"oldNum",strHdr6:"newNum"}[n])&&a.length?l[r]=a:l[r]=d(r),O(n).placeholder=l[r],O(n).value=l[r],O(s[i]).disabled=!e;if(!1===e)return O(t).className=E(O(t).className,"btn-primary"),O(t).className+=" btn-warning",O(t).textContent="edit headers",void window.mscAlert({title:"",subtitle:"The csv headers have been updated."});O(t).className=E(O(t).className,"btn-warning"),O(t).className+=" btn-primary",O(t).textContent="update headers"}function oa(){var e=Number(O("hrsPerSchedule").value),t="";5*S.uiScheduleNumOfHrsPerDay<e&&(t="#d62c1a"),O("hrsPerSchedule").style.color=t}function ca(){var e=Number(O("hrsPerDay").value),t="";S.uiScheduleNumOfHrsPerDay<e&&(t="#d62c1a"),O("hrsPerDay").style.color=t}function la(){var e=O("newcoursename"),t="^([0-9]{"+S.courseNameNumLength+"})$";e.style.color=A(e.value,t)}function ua(){var e=O("newcourseroom");e.style.color=A(e.value,"^([a-zA-Z0-9\\-\\u3130-\\u318F\\uAC00-\\uD7AF])")}function pa(){var e,t,n=O("searchcourses");return new RegExp("^([0-9]{"+S.courseNameNumLength+"})$","g").test(n.value)?(n.style.color="",null==(e=p(n.value))?(ha(),void(n.style.color="#d62c1a")):(t=e,ha(),O("contain"+t).className+=" arrow-pointer",L.lastSearchItem=t,void Un(e))):(ha(),void(n.style.color="#d62c1a"))}function ha(){var e=L.lastSearchItem,t="contain"+e;""!==e&&void 0!==N[e]&&(O(t).className=E(O(t).className,"arrow-pointer"),L.lastSearchItem="")}function ma(e){for(var t,n=L.indexData.schedules.length,a=0;a<n;a++)t=L.indexData.schedules[a],I[t].display="s"+(L.indexData.schedules.indexOf(t)+1);if(!0===e)for(a=0;a<n;a++)t=L.indexData.schedules[a],document.getElementById(t).childNodes[0].childNodes[0].textContent=I[t].display}function fa(e,t){!0!==e?O(t).className=E(O(t).className,"bypass"):O(t).className+=" bypass"}function ga(){fa(L.settings.overrides.deptGrps,"deptgrpsbyps"),fa(L.settings.overrides.maxHours,"schedhrsbyps"),fa(L.settings.overrides.maxHrsPerDay,"dayhrsbyps"),fa(L.settings.overrides.maxSeqHrs,"seqhrsbyps"),"week"===L.settings.deptGrpsSetBy?O("deptGrpsWeekly").checked=!0:O("deptGrpsDaily").checked=!0,!0===L.settings.overrides.multiCats?O("mlticatsyes").checked=!0:O("mlticatsno").checked=!0}function va(){O("hrsPerSchedule").value=L.settings.maxHours,O("hrsPerDay").value=L.settings.maxHrsPerDay,2===L.settings.maxSeqHrs?O("seqHrsTwo").checked=!0:O("seqHrsThree").checked=!0}function ya(){!function(){var e,t,n,a,r,s=document.createDocumentFragment();for(k(O("deptEDIT")),r=0;r<L.indexData.depts.length;r++)e=document.createElement("div"),t=document.createElement("input"),n=document.createElement("input"),a=document.createElement("span"),e.id="dpts"+[r],t.type="text",t.id="deptnm"+[r],t.className="inputstylenarrow disabled",t.value=L.indexData.depts[r].shortcode,t.maxLength=8,t.placeholder="shortcode",n.type="text",n.id="ddesc"+[r],n.className="inputstyle",n.value=L.indexData.depts[r].description,n.maxLength=32,n.placeholder="description",a.id="deptdel"+[r],a.className="btn btn-xs btn-danger deletex pull-right",a.textContent="✖",e.appendChild(t),e.appendChild(n),e.appendChild(a),s.appendChild(e);O("deptEDIT").appendChild(s)}(),O("setting-section").className+=" disabled",O("newcourseform").className+=" disabled",on("hiddendeptopenL"),on("hiddendeptopenR"),cn("departments")}function xa(){on("departments"),cn("hiddendeptopenR"),cn("hiddendeptopenL"),O("setting-section").className=E(O("setting-section").className,"disabled"),O("newcourseform").className=E(O("newcourseform").className,"disabled"),k(O("deptEDIT"))}function wa(){var e,t,n,a=O("configStartHr"),r=O("configNumOfHrsPerDay"),s=Number(a.options[a.selectedIndex].value),i=document.createDocumentFragment();for(k(r),n=s;n<23;n++)(e=document.createElement("OPTION")).value=n+1,e.textContent=("0"+e.value).slice(-2)+":00",i.appendChild(e);r.appendChild(i),(t=r.options.length)<S.uiScheduleNumOfHrsPerDay?r.options[t-1].selected=!0:r.options[S.uiScheduleNumOfHrsPerDay-1].selected=!0}function ba(){var e=Number(O("configStartHr").value),t=Number(O("configNumOfHrsPerDay").value);S.uiTimeInputStartHr=+e,S.uiScheduleNumOfHrsPerDay=t-e,9!==S.uiTimeInputStartHr&&(S.pdfBlankHr=""),O("configStartHr").disabled=!0,O("configNumOfHrsPerDay").disabled=!0}Array.prototype.identical=function(e){var t;if(this.length!==e.length)return!1;for(t=0;t<e.length;t++)if(this[t].identical){if(!this[t].identical(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0},"serviceWorker"in navigator&&navigator.serviceWorker.register("/schedules/serviceWorker.js"),"onpagehide"in window?window.addEventListener("pagehide",Pt,!1):window.addEventListener("beforeunload",Pt,!1),e=65+S.scheduleRowPixelHeight*(S.uiScheduleNumOfHrsPerDay+1),t=65+S.scheduleRowPixelHeight*(S.uiScheduleNumOfHrsPerDay+1)+25,n="#schedule-instances>div{min-height:"+e+"px;height:"+e+"px;max-height:"+e+"px;} #schedule-instances>div.show-teacher{min-height:"+t+"px;height:"+t+"px;max-height:"+t+"px;}",(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n)),document.getElementsByTagName("head")[0].appendChild(a),O("hrsPerSchedule").value=""+S.maxHours,O("hrsPerSchedule").max=""+5*S.uiScheduleNumOfHrsPerDay,O("hrsPerDay").value=""+S.maxHrsPerDay,O("hrsPerDay").max=""+S.uiScheduleNumOfHrsPerDay,O("updateHdrsA").addEventListener("click",hn,{capture:!1,passive:!0}),O("updateHdrsB").addEventListener("click",mn,{capture:!1,passive:!0}),O("csv-file").addEventListener("change",Je,{capture:!1,passive:!0}),O("json-file").addEventListener("change",Ye,{capture:!1,passive:!0}),O("configStartHr").addEventListener("change",wa,{capture:!1,passive:!0}),O("savedsession").addEventListener("click",Ot,{capture:!1,passive:!0}),O("newsession").addEventListener("click",G,{capture:!1,passive:!0}),O("helpfileA").addEventListener("click",gn,{capture:!1,passive:!0}),O("helpfile1").addEventListener("click",vn,{capture:!1,passive:!0})}()});